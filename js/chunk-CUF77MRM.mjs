import{g as u,h as f}from"chunk-5QQ5KTFK.mjs";import{j as m}from"chunk-AHQIRSXG.mjs";var d=class extends Error{constructor(e){let t="Failed to upload";e?.error?.message&&(t=e.error.message);super(t);m(this,"code");m(this,"data");typeof e?.code=="number"&&(this.code=e.code),typeof e?.data=="object"&&e.data&&(this.data=e.data)}};async function b(a,i=200,e="image/png",t){let s=Math.min(i/a.naturalWidth,i/a.naturalHeight);if(s>=1)return null;let o=document.createElement("canvas");o.width=Math.floor(a.naturalWidth*s),o.height=Math.floor(a.naturalHeight*s);let r=o.getContext("2d");if(!r)throw Error("Failed to create context");return r.drawImage(a,0,0,o.width,o.height),new Promise((c,l)=>{o.toBlob(n=>{if(!n){l(Error("Failed to create Blob"));return}c(n)},e,t)})}function w(a){let i=URL.createObjectURL(a),e=new Image;return new Promise((t,s)=>{e.onerror=o=>{URL.revokeObjectURL(i),s(o)},e.onload=()=>{URL.revokeObjectURL(i),t(e)},e.src=i})}function R(a,i,e){let t=new XMLHttpRequest;return t.withCredentials=!0,e&&(t.upload.onprogress=s=>e(s.loaded/s.total)),new Promise((s,o)=>{t.onload=()=>{let r;try{r=JSON.parse(t.responseText)}catch{}if(t.status<200||t.status>299||r?.error){o(new d(r));return}s(r)},t.onerror=()=>{o(new d)},t.open("POST",a),u.withAuthorizationHeader({headers:f}).then(({headers:r})=>{if(r){let l=typeof r.entries=="function"?r.entries():Object.entries(r);for(let[n,g]of l)t.setRequestHeader(n,g)}let c=new FormData;for(let[l,n]of Object.entries(i))Array.isArray(n)?c.set(l,...n):n instanceof File?c.set(l,n,n.name):c.set(l,n);t.send(c)})})}export{d as a,b,w as c,R as d};
//# sourceMappingURL=chunk-CUF77MRM.mjs.map
