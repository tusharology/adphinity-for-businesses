import{sn as D}from"chunk-G5CI4O4F.mjs";import{L as g}from"chunk-LIUGL3AW.mjs";import{ha as A}from"chunk-RT6MD2HE.mjs";import{j as I}from"chunk-CMAEAGWD.mjs";import{da as v}from"chunk-EEV263O3.mjs";import{a as R}from"chunk-YOOGIIWU.mjs";import{a as O}from"chunk-HMF7T2NG.mjs";import{j as y}from"chunk-AHQIRSXG.mjs";var S=v("initializeAssetResolver"),h,b;function E(t){if(h)throw new Error("initializeAssetResolver() should only be called once");return S.debug("initializeAssetResolver",{assetMap:t}),h=A(O().userContent,t),b=t,h}function U(){if(h===void 0)throw new Error("getAssetResolver() should not be called before initializeAssetResolver()");return h}function W(){if(b===void 0)throw new Error("getCurrentAssetMapHash() should not be called before initializeAssetResolver()");let t=U(),e=b.hash;return{assetResolver:t,assetMapHash:e}}var V=v("layout-measuring/projection");function w(t){return{x:t.x/t.w,y:t.y/t.w}}function X(t,e){let n=0,s=0;for(let d=1;d<e.length;d++){let i=e[d];i.x<e[n].x&&(n=d),i.y<e[s].y&&(s=d)}let r=t[n],o=t[s];return R(!I(r)&&!I(o),"minX, minY points must be defined",n,s,t),{minX:new DOMPoint(r.x,r.y),minY:new DOMPoint(o.x,o.y)}}function N(t,e,n,s){let r=t.multiply(e),o=s.map(c=>w(r.transformPoint(c))),{x:d,y:i}=P(t,e,n,X(s,o)),f=t.translate(d,i).multiplySelf(e),a=s.map(c=>w(f.transformPoint(c)));if(!g.anyPointsOutsideRect(n,a))return{x:d,y:i,matrix:f};let l=P(t,e,n,X(s,a));return{x:l.x,y:l.y,matrix:t.translate(l.x,l.y).multiplySelf(e)}}function k(t,e,n){let s=new DOMPoint(e.x,e.y);return P(t,D.identity(),n,{minX:s,minY:s})}function P(t,e,n,{minX:s,minY:r}){let o=t,d=e,i=n,{a:f,b:a,c:l}=Y(o,d,s,i.x,1),{a:c,b:m,c:u}=Y(o,d,r,i.y,2),x=(a*u-m*l)/(c*a-f*m),M=(f*u-c*l)/(f*m-c*a);return c*a===f*m?(V.error("Unsolvable coordinates:",{parentMatrix:t,matrix:e,target2dPoint:n,minxp:s,minyp:r}),{x:0,y:0}):{x,y:M}}function Y(t,e,n,s,r){let o=t[`m1${r}`],d=e.m14*o*n.x+e.m24*o*n.y+e.m44*o,i=t[`m2${r}`],f=e.m14*i*n.x+e.m24*i*n.y+e.m44*i,a=t[`m3${r}`],l=t[`m4${r}`],c=(e.m11*o+e.m12*i+e.m13*a+e.m14*l)*n.x+(e.m21*o+e.m22*i+e.m23*a+e.m24*l)*n.y+e.m41*o+e.m42*i+e.m43*a+e.m44*l,m=e.m14*t.m14*n.x+e.m24*t.m14*n.y+e.m44*t.m14,u=e.m14*t.m24*n.x+e.m24*t.m24*n.y+e.m44*t.m24,x=(e.m11*t.m14+e.m12*t.m24+e.m13*t.m34+e.m14*t.m44)*n.x+(e.m21*t.m14+e.m22*t.m24+e.m23*t.m34+e.m24*t.m44)*n.y+e.m41*t.m14+e.m42*t.m24+e.m43*t.m34+e.m44*t.m44,M=d-s*m,C=f-s*u,H=s*x-c;return{a:M,b:C,c:H}}var z=class{constructor(e){this.environment=e;y(this,"visibleRenderIds",new Set);y(this,"addedRenderIds",new Set);y(this,"removedRenderIds",new Set)}setVisible(e,n){R(this.environment==="sandbox","Setting data is only allowed in the sandbox.");let s=this.getVisible(e);n!==s&&(n?(this.visibleRenderIds.add(e),this.addedRenderIds.add(e),this.removedRenderIds.delete(e)):(this.visibleRenderIds.delete(e),this.removedRenderIds.add(e),this.addedRenderIds.delete(e)))}import(e){R(this.environment==="editor","Importing data is only allowed in the editor.");let n=new Set;for(let s of e.addedRenderIds)this.visibleRenderIds.add(s),n.add(s);for(let s of e.removedRenderIds)this.visibleRenderIds.delete(s),n.add(s);return n}getVisible(e){return this.visibleRenderIds.has(e)}export(){if(R(this.environment==="sandbox","No need to collect and send updates from within the editor."),this.addedRenderIds.size===0&&this.removedRenderIds.size===0)return;let e=Array.from(this.addedRenderIds),n=Array.from(this.removedRenderIds);return this.addedRenderIds.clear(),this.removedRenderIds.clear(),{addedRenderIds:e,removedRenderIds:n}}};export{N as a,k as b,z as c,E as d,U as e,W as f};
//# sourceMappingURL=chunk-ZOR27MRK.mjs.map
