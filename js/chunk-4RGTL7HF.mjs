import{$b as _i,Bc as wi,Dc as qi,Fe as ja,Ge as ea,He as ta,Jc as Ni,Kc as Ki,Mc as Li,Pa as fi,Qa as Gi,Uc as Ji,Vd as Xi,Wd as Nr,Xd as Vj,Yd as ut,Zd as hj,_b as gi,_d as zi,eb as Ri,fb as Fi,gb as Ii,h as qo,ic as yi,jc as Si,kc as Mi,la as mi,oe as Wi,se as Yi,te as Zi,ze as Aa}from"chunk-CWPFLL4N.mjs";import{A as Ie,Da as vi,G as Oi,Wa as Di,ca as Pi,o as hi}from"chunk-VHQJLQ3M.mjs";import{m as Vi}from"chunk-C47ZRU5U.mjs";import{h as ge}from"chunk-MPXS4Q54.mjs";import{d as $t}from"chunk-XNPXGCKA.mjs";import{g as na}from"chunk-3THWI3N2.mjs";import{a as Ui}from"chunk-67PXYNDJ.mjs";import{a as ra}from"chunk-V3C5CSFI.mjs";import{b as BA}from"chunk-YQXRHNKK.mjs";import{u as pi}from"chunk-VHBQVA4D.mjs";import{d as Et}from"chunk-RAZ5STN2.mjs";import{Ld as ci,N as ue,Te as di,Ue as $i,Ya as si,Za as li,ba as Ko,bb as ki,cg as Ei,fi as Bi,li as ui}from"chunk-Y4KFFISW.mjs";import{f as PA}from"chunk-KYQ6X7UF.mjs";import{a as Qi}from"chunk-YEI67D6W.mjs";import{Ue as qr}from"chunk-BMVMSSVG.mjs";import{An as oi,Bn as ii,F as Hj,Fn as Ij,Gn as kt,Hb as Mo,Hn as Dr,J as So,Jd as xr,Jn as wr,Ld as wo,Mj as Jo,Qf as Be,Wd as at,b as vr,jc as Oo,l as ho,m as go,n as bo,no as ai,o as _o,p as nt,q as ot,r as yo,uc as Po,wh as Qj,xh as pe,yh as Lo,zl as ni,zn as Fe}from"chunk-ZXJMCM2S.mjs";import{f as Io}from"chunk-KYPY4QS7.mjs";import{a as bi}from"chunk-R32HLP7P.mjs";import{b as vo}from"chunk-GZI43NW3.mjs";import{a as Kr,c as MA}from"chunk-OIGMOVXH.mjs";import{a as kA,b as Bt}from"chunk-66D7QHCS.mjs";import{b as xi,c as Ci,e as Ti}from"chunk-HUSV4OLE.mjs";import{a as he,b as ct,c as dt,d as Hi}from"chunk-QQUXYWGZ.mjs";import{Ad as Gj,Ae as Pr,As as Qo,Bc as ao,Cc as ce,Es as Uo,Fs as UA,Gs as lj,Hj as uo,Hm as mo,Hs as me,Is as Vo,Jj,Js as Xo,Ks as zo,L as lA,Ls as fe,Ms as Cr,Ns as Wo,Os as Rj,Ps as Ge,Qs as Re,Rs as Yo,Sm as fo,Sr as xo,Ss as Zo,Tc as so,Tn as Go,Tr as it,Ts as st,Ur as Co,Us as Ai,Vc as lo,Vr as To,Wr as Do,Ws as ji,Ys as ei,Zs as ti,_c as wA,at as Fj,bt as Tr,c as Sr,ct as X,dt as lt,ed as de,fd as HA,ft as Uj,gd as $e,gs as No,gt as ri,hd as Ee,ik as po,jb as Or,jp as Ro,kd as ko,ld as Kj,md as co,me as $o,nb as oo,ne as QA,od as SA,pp as Fo,vd as fA,xj as Eo,xs as Ho,yj as Bo,zc as io,zd as Lj}from"chunk-SF5446RK.mjs";import{a as Mr}from"chunk-B7SOVHNX.mjs";import{p as hA}from"chunk-OBUCKN56.mjs";import{b as GA,e as ej,g as jo,h as eo,j as ke,k as to,m as ro,r as no}from"chunk-CMAEAGWD.mjs";import{b as Zn}from"chunk-AUNF3KWQ.mjs";import{b as Ao}from"chunk-JB2N3EQZ.mjs";import{g as Yn}from"chunk-4X7KIAE7.mjs";import{c as _r,k as yr}from"chunk-6E4TUQ3S.mjs";import{Aa as gr,Ba as Vn,Ca as br,Da as Xn,Ea as jj,Fa as zn,Ga as Wn,Ra as le,W as EA,Y as Jn,a as Ln,da as LA,ka as Hn,la as Aj,ma as yA,na as JA,pa as sj,qa as tt,ra as hr,sa as rt,ta as Qn,ua as AA,wa as Un,za as Nj}from"chunk-EEV263O3.mjs";import{a as I,b as fj}from"chunk-YOOGIIWU.mjs";import{a as Ir}from"chunk-HMF7T2NG.mjs";import{c as dk,d as Kn,e as Rr,j as T,k as nA,l as KA,m as et,o as Fr}from"chunk-AHQIRSXG.mjs";var jk=dk((q8,Ak)=>{"use strict";var pr=Object.prototype.hasOwnProperty,Zl=Object.prototype.toString,Ul=Object.defineProperty,Vl=Object.getOwnPropertyDescriptor,Xl=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Zl.call(e)==="[object Array]"},zl=function(e){if(!e||Zl.call(e)!=="[object Object]")return!1;var j=pr.call(e,"constructor"),t=e.constructor&&e.constructor.prototype&&pr.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!j&&!t)return!1;var r;for(r in e);return typeof r>"u"||pr.call(e,r)},Wl=function(e,j){Ul&&j.name==="__proto__"?Ul(e,j.name,{enumerable:!0,configurable:!0,value:j.newValue,writable:!0}):e[j.name]=j.newValue},Yl=function(e,j){if(j==="__proto__")if(pr.call(e,j)){if(Vl)return Vl(e,j).value}else return;return e[j]};Ak.exports=function A(){var e,j,t,r,o,n,i=arguments[0],a=1,s=arguments.length,l=!1;for(typeof i=="boolean"&&(l=i,i=arguments[1]||{},a=2),(i==null||typeof i!="object"&&typeof i!="function")&&(i={});a<s;++a)if(e=arguments[a],e!=null)for(j in e)t=Yl(i,j),r=Yl(e,j),i!==r&&(l&&r&&(zl(r)||(o=Xl(r)))?(o?(o=!1,n=t&&Xl(t)?t:[]):n=t&&zl(t)?t:{},Wl(i,{name:j,newValue:A(l,n,r)})):typeof r<"u"&&Wl(i,{name:j,newValue:r}));return i}});var tj=Rr(Ao(),1),oa="dismissedInstantNPMToast",ia="showedInstantNPMToast",aa="instant-npm-toast",ru=()=>window.localStorage.getItem(ia)==="true",sa=()=>window.localStorage.getItem(oa)==="true";function $k(){return(0,tj.jsxs)(tj.Fragment,{children:[(0,tj.jsx)(qr,{children:"Installed NPM library."}),(0,tj.jsxs)("a",{href:"https://www.framer.com/developers/#faq",target:"_blank",children:[" ",(0,tj.jsx)(qr,{children:"Learn more."})]})]})}function la(){window.localStorage.setItem(ia,"true"),BA({type:"add",variant:"info",text:(0,tj.jsx)($k,{}),key:aa,duration:1/0,showCloseButton:"never",action:{title:"Dismiss",onClick:()=>window.localStorage.setItem(oa,"true")}})}function nu(){BA({type:"remove",key:aa})}var ka="https://app.framerstatic.com/framer_compiler_bg-UGK2KYHD.wasm";var Bk={track:!0};function ca(A){let e={...A,event:"external_component_insert"};Zn(e,Bk)}var rj=LA("compiler");async function Ru(){await ye()}function da(A){return{code:`const err = new Error(${JSON.stringify(String(A))}); err.name = "CompilationError"; throw err;`,sourceMap:void 0,annotations:{},exportedNames:[],reExportedModules:[],imports:{absolute:[],relative:[],bare:[]}}}function $a(A,e,j){let t={...e.exports};j&&(t.__FramerMetadata__={type:"variable"},A=A.concat(`
export const __FramerMetadata__ = `,JSON.stringify({exports:t})));let r=Object.entries(t).filter(([,n])=>n.type!=="tsType").map(([n])=>n),o={};for(let[n,i]of Object.entries(e.exports))i.annotations&&(o[n]=i.annotations);return{moduleCode:A,annotations:o,exportedNames:r}}async function Ea({localId:A,name:e,source:j,includeSourceMap:t=!0}){let r=await ye();try{let{code:o,metadata:n,map:i}=await r.transformSync(j,{fileName:MA(e).source,framerContractVersion:1,mediaType:"tsx",minify:!1,compress:!1,mangle:!1,sourceMap:t,useReactRefresh:!0}),a=`
if (!window.$RefreshReg$) throw new Error("React refresh preamble was not loaded. Something is wrong.");
const prevRefreshReg = window.$RefreshReg$;
const prevRefreshSig = window.$RefreshSig$;
window.$RefreshReg$ = window.reactRefreshRuntime.getRefreshReg("${A}");
window.$RefreshSig$ = window.reactRefreshRuntime.createSignatureFunctionForTransform;

${o}

window.$RefreshReg$ = prevRefreshReg;
window.$RefreshSig$ = prevRefreshSig;`,{moduleCode:s,annotations:l,exportedNames:k}=$a(a,n,!0);return{code:s,sourceMap:i??void 0,imports:n.requestedModules,annotations:l,exportedNames:k,reExportedModules:n.reExportedModules}}catch(o){let n=`Failed to compile development module ${e}: ${o}`;return rj.debug(n,"(enable trace logging to see full source)"),rj.trace(j),A.startsWith("codeFile/")||(rj.reportCriticalError(new Error(n,{cause:o}),{moduleName:e,moduleSource:j}),PA("application_error",{message:n,area:"compiler"})),da(o)}}async function Fu(A,e){await(await ye()).transformSync(e,{fileName:MA(A).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:!1,mangle:!1,sourceMap:!1,useReactRefresh:!1})}async function Ba({name:A,source:e,type:j,includeSourceMap:t=!0,addFramerMetadata:r=!0,telemetrySession:o}){let n=Ie(10),i=`compile-${A}-${n}`,a=`\u{1F4DD} Compile ${A}`;rj.debug("Compiling module",A,"; with source map:",t),he(i);let s=await ye(),l=o?.start("transform"),k=j==="collection";try{let{code:c,map:d,metadata:$}=await s.transformSync(e,{fileName:MA(A).source,framerContractVersion:1,mediaType:"tsx",minify:!0,compress:k,mangle:k,sourceMap:t,useReactRefresh:!1}),{moduleCode:B,annotations:u,exportedNames:E}=$a(c,$,r);return{code:B,sourceMap:d??void 0,imports:$.requestedModules,annotations:u,exportedNames:E,reExportedModules:$.reExportedModules}}catch(c){let d=`Failed to compile module ${A}: ${c}`;return rj.debug(d,"(enable trace logging to see full source)"),rj.trace(e),A.startsWith("codeFile/")||(rj.reportCriticalError(new Error(d,{cause:c}),{moduleName:A,moduleSource:e}),PA("application_error",{message:d,area:"compiler"})),da(c)}finally{l?.end(),pa(a,i)}}async function ua(A){let j=`analyze-imports-${Ie(10)}`,t="\u{1F575}\u{1F3FB} Analyze Imports";he(j);try{return{ok:!0,value:await(await ye()).analyzeImports(A)}}catch(r){return rj.warn("Failed to analyze imports:",r),r instanceof Error?{ok:!1,error:r}:{ok:!1,error:new Error(`${r}`,{cause:r})}}finally{pa(t,j)}}var pt;async function ye(){if(!pt){let A=new Worker(Uo("./modulesCompilerWorker.js")),e=Ho(A);pt=e.initWithPathToWasm(ka).then(()=>({transformSync:e.transformSync,analyzeImports:e.analyzeImports})),pt.catch(()=>{if(bi()||!Jn.isProduction)throw new Error(`\u274C Your dev setup is struggling to run the compiler\u2019s WASM binary.
To fix it, run "make clean" followed by "make dev".`)})}return pt}function pa(A,e){ct(A,e),performance.getEntriesByName(A,"measure").forEach(({name:j,duration:t})=>{rj.debug(j,"took",t.toFixed(2),"ms"),Hi(j)}),dt(e)}function ma(A,e,j){if(!fA(e))return;let t=e.getSupportedLayout(A),r=e.getCurrentVariantSize(A);Sr(t.width)&&r?.widthType!==0&&(j.widthType=2,j.left!==null&&j.right!==null&&(j.right=null)),Sr(t.height)&&r?.heightType!==0&&(j.heightType=2,j.top!==null&&j.bottom!==null&&(j.bottom=null))}var nj=class{constructor(e,j,t){this.normal=j,this.property=e,t&&(this.space=t)}};nj.prototype.normal={};nj.prototype.property={};nj.prototype.space=void 0;function Lr(A,e){let j={},t={};for(let r of A)Object.assign(j,r.property),Object.assign(t,r.normal);return new nj(j,t,e)}function Se(A){return A.toLowerCase()}var uA=class{constructor(e,j){this.attribute=j,this.property=e}};uA.prototype.attribute="";uA.prototype.booleanish=!1;uA.prototype.boolean=!1;uA.prototype.commaOrSpaceSeparated=!1;uA.prototype.commaSeparated=!1;uA.prototype.defined=!1;uA.prototype.mustUseProperty=!1;uA.prototype.number=!1;uA.prototype.overloadedBoolean=!1;uA.prototype.property="";uA.prototype.spaceSeparated=!1;uA.prototype.space=void 0;var Me={};Kn(Me,{boolean:()=>J,booleanish:()=>oA,commaOrSpaceSeparated:()=>gA,commaSeparated:()=>kj,number:()=>_,overloadedBoolean:()=>mt,spaceSeparated:()=>z});var pk=0,J=gj(),oA=gj(),mt=gj(),_=gj(),z=gj(),kj=gj(),gA=gj();function gj(){return 2**++pk}var Jr=Object.keys(Me),bj=class extends uA{constructor(e,j,t,r){let o=-1;if(super(e,j),fa(this,"space",r),typeof t=="number")for(;++o<Jr.length;){let n=Jr[o];fa(this,Jr[o],(t&Me[n])===Me[n])}}};bj.prototype.defined=!0;function fa(A,e,j){j&&(A[e]=j)}function vA(A){let e={},j={};for(let[t,r]of Object.entries(A.properties)){let o=new bj(t,A.transform(A.attributes||{},t),r,A.space);A.mustUseProperty&&A.mustUseProperty.includes(t)&&(o.mustUseProperty=!0),e[t]=o,j[Se(t)]=t,j[Se(o.attribute)]=t}return new nj(e,j,A.space)}var Hr=vA({properties:{ariaActiveDescendant:null,ariaAtomic:oA,ariaAutoComplete:null,ariaBusy:oA,ariaChecked:oA,ariaColCount:_,ariaColIndex:_,ariaColSpan:_,ariaControls:z,ariaCurrent:null,ariaDescribedBy:z,ariaDetails:null,ariaDisabled:oA,ariaDropEffect:z,ariaErrorMessage:null,ariaExpanded:oA,ariaFlowTo:z,ariaGrabbed:oA,ariaHasPopup:null,ariaHidden:oA,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:z,ariaLevel:_,ariaLive:null,ariaModal:oA,ariaMultiLine:oA,ariaMultiSelectable:oA,ariaOrientation:null,ariaOwns:z,ariaPlaceholder:null,ariaPosInSet:_,ariaPressed:oA,ariaReadOnly:oA,ariaRelevant:null,ariaRequired:oA,ariaRoleDescription:z,ariaRowCount:_,ariaRowIndex:_,ariaRowSpan:_,ariaSelected:oA,ariaSetSize:_,ariaSort:null,ariaValueMax:_,ariaValueMin:_,ariaValueNow:_,ariaValueText:null,role:null},transform(A,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function ft(A,e){return e in A?A[e]:e}function Gt(A,e){return ft(A,e.toLowerCase())}var Ga=vA({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:kj,acceptCharset:z,accessKey:z,action:null,allow:null,allowFullScreen:J,allowPaymentRequest:J,allowUserMedia:J,alt:null,as:null,async:J,autoCapitalize:null,autoComplete:z,autoFocus:J,autoPlay:J,blocking:z,capture:null,charSet:null,checked:J,cite:null,className:z,cols:_,colSpan:null,content:null,contentEditable:oA,controls:J,controlsList:z,coords:_|kj,crossOrigin:null,data:null,dateTime:null,decoding:null,default:J,defer:J,dir:null,dirName:null,disabled:J,download:mt,draggable:oA,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:J,formTarget:null,headers:z,height:_,hidden:mt,high:_,href:null,hrefLang:null,htmlFor:z,httpEquiv:z,id:null,imageSizes:null,imageSrcSet:null,inert:J,inputMode:null,integrity:null,is:null,isMap:J,itemId:null,itemProp:z,itemRef:z,itemScope:J,itemType:z,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:J,low:_,manifest:null,max:null,maxLength:_,media:null,method:null,min:null,minLength:_,multiple:J,muted:J,name:null,nonce:null,noModule:J,noValidate:J,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:J,optimum:_,pattern:null,ping:z,placeholder:null,playsInline:J,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:J,referrerPolicy:null,rel:z,required:J,reversed:J,rows:_,rowSpan:_,sandbox:z,scope:null,scoped:J,seamless:J,selected:J,shadowRootClonable:J,shadowRootDelegatesFocus:J,shadowRootMode:null,shape:null,size:_,sizes:null,slot:null,span:_,spellCheck:oA,src:null,srcDoc:null,srcLang:null,srcSet:null,start:_,step:null,style:null,tabIndex:_,target:null,title:null,translate:null,type:null,typeMustMatch:J,useMap:null,value:oA,width:_,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:z,axis:null,background:null,bgColor:null,border:_,borderColor:null,bottomMargin:_,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:J,declare:J,event:null,face:null,frame:null,frameBorder:null,hSpace:_,leftMargin:_,link:null,longDesc:null,lowSrc:null,marginHeight:_,marginWidth:_,noResize:J,noHref:J,noShade:J,noWrap:J,object:null,profile:null,prompt:null,rev:null,rightMargin:_,rules:null,scheme:null,scrolling:oA,standby:null,summary:null,text:null,topMargin:_,valueType:null,version:null,vAlign:null,vLink:null,vSpace:_,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:J,disableRemotePlayback:J,prefix:null,property:null,results:_,security:null,unselectable:null},space:"html",transform:Gt});var Ra=vA({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:gA,accentHeight:_,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:_,amplitude:_,arabicForm:null,ascent:_,attributeName:null,attributeType:null,azimuth:_,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:_,by:null,calcMode:null,capHeight:_,className:z,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:_,diffuseConstant:_,direction:null,display:null,dur:null,divisor:_,dominantBaseline:null,download:J,dx:null,dy:null,edgeMode:null,editable:null,elevation:_,enableBackground:null,end:null,event:null,exponent:_,externalResourcesRequired:null,fill:null,fillOpacity:_,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:kj,g2:kj,glyphName:kj,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:_,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:_,horizOriginX:_,horizOriginY:_,id:null,ideographic:_,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:_,k:_,k1:_,k2:_,k3:_,k4:_,kernelMatrix:gA,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:_,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:_,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:_,overlineThickness:_,paintOrder:null,panose1:null,path:null,pathLength:_,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:z,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:_,pointsAtY:_,pointsAtZ:_,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:gA,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:gA,rev:gA,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:gA,requiredFeatures:gA,requiredFonts:gA,requiredFormats:gA,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:_,specularExponent:_,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:_,strikethroughThickness:_,string:null,stroke:null,strokeDashArray:gA,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:_,strokeOpacity:_,strokeWidth:null,style:null,surfaceScale:_,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:gA,tabIndex:_,tableValues:null,target:null,targetX:_,targetY:_,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:gA,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:_,underlineThickness:_,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:_,values:null,vAlphabetic:_,vMathematical:_,vectorEffect:null,vHanging:_,vIdeographic:_,version:null,vertAdvY:_,vertOriginX:_,vertOriginY:_,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:_,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:ft});var Qr=vA({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(A,e){return"xlink:"+e.slice(5).toLowerCase()}});var Ur=vA({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:Gt});var Vr=vA({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(A,e){return"xml:"+e.slice(3).toLowerCase()}});var mk=/[A-Z]/g,Fa=/-[a-z]/g,fk=/^data[-\w.:]+$/i;function Xr(A,e){let j=Se(e),t=e,r=uA;if(j in A.normal)return A.property[A.normal[j]];if(j.length>4&&j.slice(0,4)==="data"&&fk.test(e)){if(e.charAt(4)==="-"){let o=e.slice(5).replace(Fa,Rk);t="data"+o.charAt(0).toUpperCase()+o.slice(1)}else{let o=e.slice(4);if(!Fa.test(o)){let n=o.replace(mk,Gk);n.charAt(0)!=="-"&&(n="-"+n),e="data"+n}}r=bj}return new r(t,e)}function Gk(A){return"-"+A.toLowerCase()}function Rk(A){return A.charAt(1).toUpperCase()}var Ia=Lr([Hr,Ga,Qr,Ur,Vr],"html"),Rt=Lr([Hr,Ra,Qr,Ur,Vr],"svg");function ha(A,e){let j=e||{};return(A[A.length-1]===""?[...A,""]:A).join((j.padRight?" ":"")+","+(j.padLeft===!1?"":" ")).trim()}function ga(A){return A.join(" ").trim()}function cj(A){return!A||typeof A!="object"?"":"position"in A||"type"in A?ba(A.position):"start"in A||"end"in A?ba(A):"line"in A||"column"in A?zr(A):""}function zr(A){return _a(A&&A.line)+":"+_a(A&&A.column)}function ba(A){return zr(A&&A.start)+"-"+zr(A&&A.end)}function _a(A){return A&&typeof A=="number"?A:1}var pA=class extends Error{constructor(e,j,t){super(),typeof j=="string"&&(t=j,j=void 0);let r="",o={},n=!1;if(j&&("line"in j&&"column"in j?o={place:j}:"start"in j&&"end"in j?o={place:j}:"type"in j?o={ancestors:[j],place:j.position}:o={...j}),typeof e=="string"?r=e:!o.cause&&e&&(n=!0,r=e.message,o.cause=e),!o.ruleId&&!o.source&&typeof t=="string"){let a=t.indexOf(":");a===-1?o.ruleId=t:(o.source=t.slice(0,a),o.ruleId=t.slice(a+1))}if(!o.place&&o.ancestors&&o.ancestors){let a=o.ancestors[o.ancestors.length-1];a&&(o.place=a.position)}let i=o.place&&"start"in o.place?o.place.start:o.place;this.ancestors=o.ancestors||void 0,this.cause=o.cause||void 0,this.column=i?i.column:void 0,this.fatal=void 0,this.file,this.message=r,this.line=i?i.line:void 0,this.name=cj(o.place)||"1:1",this.place=o.place||void 0,this.reason=this.message,this.ruleId=o.ruleId||void 0,this.source=o.source||void 0,this.stack=n&&o.cause&&typeof o.cause.stack=="string"?o.cause.stack:"",this.actual,this.expected,this.note,this.url}};pA.prototype.file="";pA.prototype.name="";pA.prototype.reason="";pA.prototype.message="";pA.prototype.stack="";pA.prototype.column=void 0;pA.prototype.line=void 0;pA.prototype.ancestors=void 0;pA.prototype.cause=void 0;pA.prototype.fatal=void 0;pA.prototype.place=void 0;pA.prototype.ruleId=void 0;pA.prototype.source=void 0;var qA={basename:Fk,dirname:Ik,extname:hk,join:gk,sep:"/"};function Fk(A,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');Oe(A);let j=0,t=-1,r=A.length,o;if(e===void 0||e.length===0||e.length>A.length){for(;r--;)if(A.codePointAt(r)===47){if(o){j=r+1;break}}else t<0&&(o=!0,t=r+1);return t<0?"":A.slice(j,t)}if(e===A)return"";let n=-1,i=e.length-1;for(;r--;)if(A.codePointAt(r)===47){if(o){j=r+1;break}}else n<0&&(o=!0,n=r+1),i>-1&&(A.codePointAt(r)===e.codePointAt(i--)?i<0&&(t=r):(i=-1,t=n));return j===t?t=n:t<0&&(t=A.length),A.slice(j,t)}function Ik(A){if(Oe(A),A.length===0)return".";let e=-1,j=A.length,t;for(;--j;)if(A.codePointAt(j)===47){if(t){e=j;break}}else t||(t=!0);return e<0?A.codePointAt(0)===47?"/":".":e===1&&A.codePointAt(0)===47?"//":A.slice(0,e)}function hk(A){Oe(A);let e=A.length,j=-1,t=0,r=-1,o=0,n;for(;e--;){let i=A.codePointAt(e);if(i===47){if(n){t=e+1;break}continue}j<0&&(n=!0,j=e+1),i===46?r<0?r=e:o!==1&&(o=1):r>-1&&(o=-1)}return r<0||j<0||o===0||o===1&&r===j-1&&r===t+1?"":A.slice(r,j)}function gk(...A){let e=-1,j;for(;++e<A.length;)Oe(A[e]),A[e]&&(j=j===void 0?A[e]:j+"/"+A[e]);return j===void 0?".":bk(j)}function bk(A){Oe(A);let e=A.codePointAt(0)===47,j=_k(A,!e);return j.length===0&&!e&&(j="."),j.length>0&&A.codePointAt(A.length-1)===47&&(j+="/"),e?"/"+j:j}function _k(A,e){let j="",t=0,r=-1,o=0,n=-1,i,a;for(;++n<=A.length;){if(n<A.length)i=A.codePointAt(n);else{if(i===47)break;i=47}if(i===47){if(!(r===n-1||o===1))if(r!==n-1&&o===2){if(j.length<2||t!==2||j.codePointAt(j.length-1)!==46||j.codePointAt(j.length-2)!==46){if(j.length>2){if(a=j.lastIndexOf("/"),a!==j.length-1){a<0?(j="",t=0):(j=j.slice(0,a),t=j.length-1-j.lastIndexOf("/")),r=n,o=0;continue}}else if(j.length>0){j="",t=0,r=n,o=0;continue}}e&&(j=j.length>0?j+"/..":"..",t=2)}else j.length>0?j+="/"+A.slice(r+1,n):j=A.slice(r+1,n),t=n-r-1;r=n,o=0}else i===46&&o>-1?o++:o=-1}return j}function Oe(A){if(typeof A!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(A))}var ya={cwd:yk};function yk(){return"/"}function Xj(A){return!!(A!==null&&typeof A=="object"&&"href"in A&&A.href&&"protocol"in A&&A.protocol&&A.auth===void 0)}function Sa(A){if(typeof A=="string")A=new URL(A);else if(!Xj(A)){let e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+A+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(A.protocol!=="file:"){let e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Sk(A)}function Sk(A){if(A.hostname!==""){let t=new TypeError('File URL host must be "localhost" or empty on darwin');throw t.code="ERR_INVALID_FILE_URL_HOST",t}let e=A.pathname,j=-1;for(;++j<e.length;)if(e.codePointAt(j)===37&&e.codePointAt(j+1)===50){let t=e.codePointAt(j+2);if(t===70||t===102){let r=new TypeError("File URL path must not include encoded / characters");throw r.code="ERR_INVALID_FILE_URL_PATH",r}}return decodeURIComponent(e)}var Wr=["history","path","basename","stem","extname","dirname"],Pe=class{constructor(e){let j;e?Xj(e)?j={path:e}:typeof e=="string"||Mk(e)?j={value:e}:j=e:j={},this.cwd="cwd"in j?"":ya.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let t=-1;for(;++t<Wr.length;){let o=Wr[t];o in j&&j[o]!==void 0&&j[o]!==null&&(this[o]=o==="history"?[...j[o]]:j[o])}let r;for(r in j)Wr.includes(r)||(this[r]=j[r])}get basename(){return typeof this.path=="string"?qA.basename(this.path):void 0}set basename(e){Zr(e,"basename"),Yr(e,"basename"),this.path=qA.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?qA.dirname(this.path):void 0}set dirname(e){Ma(this.basename,"dirname"),this.path=qA.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?qA.extname(this.path):void 0}set extname(e){if(Yr(e,"extname"),Ma(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=qA.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){Xj(e)&&(e=Sa(e)),Zr(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?qA.basename(this.path,this.extname):void 0}set stem(e){Zr(e,"stem"),Yr(e,"stem"),this.path=qA.join(this.dirname||"",e+(this.extname||""))}fail(e,j,t){let r=this.message(e,j,t);throw r.fatal=!0,r}info(e,j,t){let r=this.message(e,j,t);return r.fatal=void 0,r}message(e,j,t){let r=new pA(e,j,t);return this.path&&(r.name=this.path+":"+r.name,r.file=this.path),r.fatal=!1,this.messages.push(r),r}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}};function Yr(A,e){if(A&&A.includes(qA.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+qA.sep+"`")}function Zr(A,e){if(!A)throw new Error("`"+e+"` cannot be empty")}function Ma(A,e){if(!A)throw new Error("Setting `"+e+"` requires `path` to be set too")}function Mk(A){return!!(A&&typeof A=="object"&&"byteLength"in A&&"byteOffset"in A)}function Oa(A,e,j,t){let r=yi(A,e,j,"duplicate",{enterIsolation:!1,preferredName:t,insertionIndex:A.tree.root.children.findIndex(o=>o.id===e.id)+1});A.stores.persistedUserDefaults.newContentAsDraft&&r.set({isDraft:!0,duplicatedFrom:Oo(r.duplicatedFrom,e.id)}),A.stores.scopeStore.select(r.id,{keepHistory:!1})}async function Wp(A,e){let j=new Map,t=new Set(A.stores.scopeStore.getDesignPageNodes().map(a=>a.resolveValue("name")).filter(GA)),r=ci(e.resolveValue("name")??"Design",t),o=e.isLoaded()?e:await e.load();if(!o)return;let n=o.clone({name:r,children:[]});j.set(o.id,n.id);let i=[];for(let a of o.children){let s=_i(a,new Map,new Map,j,!1);i.push(s),j.set(a.id,s.id),n.addChild(s)}A.tree.insertNode(n,void 0,A.tree.root.children.findIndex(a=>a.id===e.id)+1);for(let a of i)gi(A.tree,A.componentLoader,a,j,!1);return PA("design_page_create",{pageId:n.id,source:"duplicate"}),n}function Pa(A,e){let[j,...t]=e.stores.selectionStore.ids;if(!j||t.length)return null;let r=e.tree,o=r.getNode(j),n=!1;for(;!n&&o&&(n=ue(r,o,A,e.stores.scopeStore.active.id,e.componentLoader),!n);)o=r.getParent(o.id);return o}var zj,ve,Wj=class{constructor(e){this.limit=e;KA(this,zj,0);KA(this,ve,[])}async run(e,j){if(nA(this,zj)===this.limit){let t=new Promise(r=>{nA(this,ve).push(r)});j&&(t=Promise.race([t,Ok(j)])),await t}xa(j),Fr(this,zj)._++;try{return await e()}finally{Fr(this,zj)._--,nA(this,ve).shift()?.()}}};zj=new WeakMap,ve=new WeakMap;var va=new WeakMap;function Ok(A){let e=va.get(A);return e||(xa(A),e=new Promise((j,t)=>{A.addEventListener("abort",()=>{t(A.reason)},{once:!0})}),va.set(A,e)),e}function xa(A){if(A?.aborted)throw A.reason}function xe(A){let e=new Set;if(!A)return e;if(SA(A)&&Fo(A)){let j=Ca(A.layoutTemplateIdentifier);j&&e.add(j)}for(let{node:j,skipChildren:t}of A.walkWithSkipChildren()){if(!fA(j))continue;if(wA(j)){t();continue}let r=Ca(j.codeComponentIdentifier);r&&e.add(r)}return e}function Ca(A){let e=AA(A);if(!(!e||!yA(e)))return X({type:e.type,name:e.localIdName})}var Ta;(function(A){A[A.Static=1]="Static",A[A.Dynamic=2]="Dynamic",A[A.ImportMeta=3]="ImportMeta",A[A.StaticSourcePhase=4]="StaticSourcePhase",A[A.DynamicSourcePhase=5]="DynamicSourcePhase"})(Ta||(Ta={}));var Pk=new Uint8Array(new Uint16Array([1]).buffer)[0]===1;function j6(A,e="@"){if(!W)return e6.then(()=>j6(A));let j=A.length+1,t=(W.__heap_base.value||W.__heap_base)+4*j-W.memory.buffer.byteLength;t>0&&W.memory.grow(Math.ceil(t/65536));let r=W.sa(j-1);if((Pk?xk:vk)(A,new Uint16Array(W.memory.buffer,r,j)),!W.parse())throw Object.assign(new Error(`Parse error ${e}:${A.slice(0,W.e()).split(`
`).length}:${W.e()-A.lastIndexOf(`
`,W.e()-1)}`),{idx:W.e()});let o=[],n=[];for(;W.ri();){let a=W.is(),s=W.ie(),l=W.it(),k=W.ai(),c=W.id(),d=W.ss(),$=W.se(),B;W.ip()&&(B=i(A.slice(c===-1?a-1:a,c===-1?s+1:s))),o.push({n:B,t:l,s:a,e:s,ss:d,se:$,d:c,a:k})}for(;W.re();){let a=W.es(),s=W.ee(),l=W.els(),k=W.ele(),c=A.slice(a,s),d=c[0],$=l<0?void 0:A.slice(l,k),B=$?$[0]:"";n.push({s:a,e:s,ls:l,le:k,n:d==='"'||d==="'"?i(c):c,ln:B==='"'||B==="'"?i($):$})}function i(a){try{return(0,eval)(a)}catch{}}return[o,n,!!W.f(),!!W.ms()]}function vk(A,e){let j=A.length,t=0;for(;t<j;){let r=A.charCodeAt(t);e[t++]=(255&r)<<8|r>>>8}}function xk(A,e){let j=A.length,t=0;for(;t<j;)e[t]=A.charCodeAt(t++)}var W,e6=WebAssembly.compile((A6="AGFzbQEAAAABKwhgAX8Bf2AEf39/fwBgAAF/YAAAYAF/AGADf39/AX9gAn9/AX9gA39/fwADMTAAAQECAgICAgICAgICAgICAgICAgIAAwMDBAQAAAUAAAAAAAMDAwAGAAAABwAGAgUEBQFwAQEBBQMBAAEGDwJ/AUHA8gALfwBBwPIACwd6FQZtZW1vcnkCAAJzYQAAAWUAAwJpcwAEAmllAAUCc3MABgJzZQAHAml0AAgCYWkACQJpZAAKAmlwAAsCZXMADAJlZQANA2VscwAOA2VsZQAPAnJpABACcmUAEQFmABICbXMAEwVwYXJzZQAUC19faGVhcF9iYXNlAwEKm0EwaAEBf0EAIAA2AoAKQQAoAtwJIgEgAEEBdGoiAEEAOwEAQQAgAEECaiIANgKECkEAIAA2AogKQQBBADYC4AlBAEEANgLwCUEAQQA2AugJQQBBADYC5AlBAEEANgL4CUEAQQA2AuwJIAEL0wEBA39BACgC8AkhBEEAQQAoAogKIgU2AvAJQQAgBDYC9AlBACAFQSRqNgKICiAEQSBqQeAJIAQbIAU2AgBBACgC1AkhBEEAKALQCSEGIAUgATYCACAFIAA2AgggBSACIAJBAmpBACAGIANGIgAbIAQgA0YiBBs2AgwgBSADNgIUIAVBADYCECAFIAI2AgQgBUEANgIgIAVBA0EBQQIgABsgBBs2AhwgBUEAKALQCSADRiICOgAYAkACQCACDQBBACgC1AkgA0cNAQtBAEEBOgCMCgsLXgEBf0EAKAL4CSIEQRBqQeQJIAQbQQAoAogKIgQ2AgBBACAENgL4CUEAIARBFGo2AogKQQBBAToAjAogBEEANgIQIAQgAzYCDCAEIAI2AgggBCABNgIEIAQgADYCAAsIAEEAKAKQCgsVAEEAKALoCSgCAEEAKALcCWtBAXULHgEBf0EAKALoCSgCBCIAQQAoAtwJa0EBdUF/IAAbCxUAQQAoAugJKAIIQQAoAtwJa0EBdQseAQF/QQAoAugJKAIMIgBBACgC3AlrQQF1QX8gABsLCwBBACgC6AkoAhwLHgEBf0EAKALoCSgCECIAQQAoAtwJa0EBdUF/IAAbCzsBAX8CQEEAKALoCSgCFCIAQQAoAtAJRw0AQX8PCwJAIABBACgC1AlHDQBBfg8LIABBACgC3AlrQQF1CwsAQQAoAugJLQAYCxUAQQAoAuwJKAIAQQAoAtwJa0EBdQsVAEEAKALsCSgCBEEAKALcCWtBAXULHgEBf0EAKALsCSgCCCIAQQAoAtwJa0EBdUF/IAAbCx4BAX9BACgC7AkoAgwiAEEAKALcCWtBAXVBfyAAGwslAQF/QQBBACgC6AkiAEEgakHgCSAAGygCACIANgLoCSAAQQBHCyUBAX9BAEEAKALsCSIAQRBqQeQJIAAbKAIAIgA2AuwJIABBAEcLCABBAC0AlAoLCABBAC0AjAoL3Q0BBX8jAEGA0ABrIgAkAEEAQQE6AJQKQQBBACgC2Ak2ApwKQQBBACgC3AlBfmoiATYCsApBACABQQAoAoAKQQF0aiICNgK0CkEAQQA6AIwKQQBBADsBlgpBAEEAOwGYCkEAQQA6AKAKQQBBADYCkApBAEEAOgD8CUEAIABBgBBqNgKkCkEAIAA2AqgKQQBBADoArAoCQAJAAkACQANAQQAgAUECaiIDNgKwCiABIAJPDQECQCADLwEAIgJBd2pBBUkNAAJAAkACQAJAAkAgAkGbf2oOBQEICAgCAAsgAkEgRg0EIAJBL0YNAyACQTtGDQIMBwtBAC8BmAoNASADEBVFDQEgAUEEakGCCEEKEC8NARAWQQAtAJQKDQFBAEEAKAKwCiIBNgKcCgwHCyADEBVFDQAgAUEEakGMCEEKEC8NABAXC0EAQQAoArAKNgKcCgwBCwJAIAEvAQQiA0EqRg0AIANBL0cNBBAYDAELQQEQGQtBACgCtAohAkEAKAKwCiEBDAALC0EAIQIgAyEBQQAtAPwJDQIMAQtBACABNgKwCkEAQQA6AJQKCwNAQQAgAUECaiIDNgKwCgJAAkACQAJAAkACQAJAIAFBACgCtApPDQAgAy8BACICQXdqQQVJDQYCQAJAAkACQAJAAkACQAJAAkACQCACQWBqDgoQDwYPDw8PBQECAAsCQAJAAkACQCACQaB/ag4KCxISAxIBEhISAgALIAJBhX9qDgMFEQYJC0EALwGYCg0QIAMQFUUNECABQQRqQYIIQQoQLw0QEBYMEAsgAxAVRQ0PIAFBBGpBjAhBChAvDQ8QFwwPCyADEBVFDQ4gASkABELsgISDsI7AOVINDiABLwEMIgNBd2oiAUEXSw0MQQEgAXRBn4CABHFFDQwMDQtBAEEALwGYCiIBQQFqOwGYCkEAKAKkCiABQQN0aiIBQQE2AgAgAUEAKAKcCjYCBAwNC0EALwGYCiIDRQ0JQQAgA0F/aiIDOwGYCkEALwGWCiICRQ0MQQAoAqQKIANB//8DcUEDdGooAgBBBUcNDAJAIAJBAnRBACgCqApqQXxqKAIAIgMoAgQNACADQQAoApwKQQJqNgIEC0EAIAJBf2o7AZYKIAMgAUEEajYCDAwMCwJAQQAoApwKIgEvAQBBKUcNAEEAKALwCSIDRQ0AIAMoAgQgAUcNAEEAQQAoAvQJIgM2AvAJAkAgA0UNACADQQA2AiAMAQtBAEEANgLgCQtBAEEALwGYCiIDQQFqOwGYCkEAKAKkCiADQQN0aiIDQQZBAkEALQCsChs2AgAgAyABNgIEQQBBADoArAoMCwtBAC8BmAoiAUUNB0EAIAFBf2oiATsBmApBACgCpAogAUH//wNxQQN0aigCAEEERg0EDAoLQScQGgwJC0EiEBoMCAsgAkEvRw0HAkACQCABLwEEIgFBKkYNACABQS9HDQEQGAwKC0EBEBkMCQsCQAJAAkACQEEAKAKcCiIBLwEAIgMQG0UNAAJAAkAgA0FVag4EAAkBAwkLIAFBfmovAQBBK0YNAwwICyABQX5qLwEAQS1GDQIMBwsgA0EpRw0BQQAoAqQKQQAvAZgKIgJBA3RqKAIEEBxFDQIMBgsgAUF+ai8BAEFQakH//wNxQQpPDQULQQAvAZgKIQILAkACQCACQf//A3EiAkUNACADQeYARw0AQQAoAqQKIAJBf2pBA3RqIgQoAgBBAUcNACABQX5qLwEAQe8ARw0BIAQoAgRBlghBAxAdRQ0BDAULIANB/QBHDQBBACgCpAogAkEDdGoiAigCBBAeDQQgAigCAEEGRg0ECyABEB8NAyADRQ0DIANBL0ZBAC0AoApBAEdxDQMCQEEAKAL4CSICRQ0AIAEgAigCAEkNACABIAIoAgRNDQQLIAFBfmohAUEAKALcCSECAkADQCABQQJqIgQgAk0NAUEAIAE2ApwKIAEvAQAhAyABQX5qIgQhASADECBFDQALIARBAmohBAsCQCADQf//A3EQIUUNACAEQX5qIQECQANAIAFBAmoiAyACTQ0BQQAgATYCnAogAS8BACEDIAFBfmoiBCEBIAMQIQ0ACyAEQQJqIQMLIAMQIg0EC0EAQQE6AKAKDAcLQQAoAqQKQQAvAZgKIgFBA3QiA2pBACgCnAo2AgRBACABQQFqOwGYCkEAKAKkCiADakEDNgIACxAjDAULQQAtAPwJQQAvAZYKQQAvAZgKcnJFIQIMBwsQJEEAQQA6AKAKDAMLECVBACECDAULIANBoAFHDQELQQBBAToArAoLQQBBACgCsAo2ApwKC0EAKAKwCiEBDAALCyAAQYDQAGokACACCxoAAkBBACgC3AkgAEcNAEEBDwsgAEF+ahAmC/4KAQZ/QQBBACgCsAoiAEEMaiIBNgKwCkEAKAL4CSECQQEQKSEDAkACQAJAAkACQAJAAkACQAJAQQAoArAKIgQgAUcNACADEChFDQELAkACQAJAAkACQAJAAkAgA0EqRg0AIANB+wBHDQFBACAEQQJqNgKwCkEBECkhA0EAKAKwCiEEA0ACQAJAIANB//8DcSIDQSJGDQAgA0EnRg0AIAMQLBpBACgCsAohAwwBCyADEBpBAEEAKAKwCkECaiIDNgKwCgtBARApGgJAIAQgAxAtIgNBLEcNAEEAQQAoArAKQQJqNgKwCkEBECkhAwsgA0H9AEYNA0EAKAKwCiIFIARGDQ8gBSEEIAVBACgCtApNDQAMDwsLQQAgBEECajYCsApBARApGkEAKAKwCiIDIAMQLRoMAgtBAEEAOgCUCgJAAkACQAJAAkACQCADQZ9/ag4MAgsEAQsDCwsLCwsFAAsgA0H2AEYNBAwKC0EAIARBDmoiAzYCsAoCQAJAAkBBARApQZ9/ag4GABICEhIBEgtBACgCsAoiBSkAAkLzgOSD4I3AMVINESAFLwEKECFFDRFBACAFQQpqNgKwCkEAECkaC0EAKAKwCiIFQQJqQbIIQQ4QLw0QIAUvARAiAkF3aiIBQRdLDQ1BASABdEGfgIAEcUUNDQwOC0EAKAKwCiIFKQACQuyAhIOwjsA5Ug0PIAUvAQoiAkF3aiIBQRdNDQYMCgtBACAEQQpqNgKwCkEAECkaQQAoArAKIQQLQQAgBEEQajYCsAoCQEEBECkiBEEqRw0AQQBBACgCsApBAmo2ArAKQQEQKSEEC0EAKAKwCiEDIAQQLBogA0EAKAKwCiIEIAMgBBACQQBBACgCsApBfmo2ArAKDwsCQCAEKQACQuyAhIOwjsA5Ug0AIAQvAQoQIEUNAEEAIARBCmo2ArAKQQEQKSEEQQAoArAKIQMgBBAsGiADQQAoArAKIgQgAyAEEAJBAEEAKAKwCkF+ajYCsAoPC0EAIARBBGoiBDYCsAoLQQAgBEEGajYCsApBAEEAOgCUCkEBECkhBEEAKAKwCiEDIAQQLCEEQQAoArAKIQIgBEHf/wNxIgFB2wBHDQNBACACQQJqNgKwCkEBECkhBUEAKAKwCiEDQQAhBAwEC0EAQQE6AIwKQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0AQQAgA0EIajYCsAogAEEBEClBABArIAJBEGpB5AkgAhshAwNAIAMoAgAiA0UNBSADQgA3AgggA0EQaiEDDAALC0EAIANBfmo2ArAKDAMLQQEgAXRBn4CABHFFDQMMBAtBASEECwNAAkACQCAEDgIAAQELIAVB//8DcRAsGkEBIQQMAQsCQAJAQQAoArAKIgQgA0YNACADIAQgAyAEEAJBARApIQQCQCABQdsARw0AIARBIHJB/QBGDQQLQQAoArAKIQMCQCAEQSxHDQBBACADQQJqNgKwCkEBECkhBUEAKAKwCiEDIAVBIHJB+wBHDQILQQAgA0F+ajYCsAoLIAFB2wBHDQJBACACQX5qNgKwCg8LQQAhBAwACwsPCyACQaABRg0AIAJB+wBHDQQLQQAgBUEKajYCsApBARApIgVB+wBGDQMMAgsCQCACQVhqDgMBAwEACyACQaABRw0CC0EAIAVBEGo2ArAKAkBBARApIgVBKkcNAEEAQQAoArAKQQJqNgKwCkEBECkhBQsgBUEoRg0BC0EAKAKwCiEBIAUQLBpBACgCsAoiBSABTQ0AIAQgAyABIAUQAkEAQQAoArAKQX5qNgKwCg8LIAQgA0EAQQAQAkEAIARBDGo2ArAKDwsQJQvcCAEGf0EAIQBBAEEAKAKwCiIBQQxqIgI2ArAKQQEQKSEDQQAoArAKIQQCQAJAAkACQAJAAkACQAJAIANBLkcNAEEAIARBAmo2ArAKAkBBARApIgNB8wBGDQAgA0HtAEcNB0EAKAKwCiIDQQJqQZwIQQYQLw0HAkBBACgCnAoiBBAqDQAgBC8BAEEuRg0ICyABIAEgA0EIakEAKALUCRABDwtBACgCsAoiA0ECakGiCEEKEC8NBgJAQQAoApwKIgQQKg0AIAQvAQBBLkYNBwsgA0EMaiEDDAELIANB8wBHDQEgBCACTQ0BQQYhAEEAIQIgBEECakGiCEEKEC8NAiAEQQxqIQMCQCAELwEMIgVBd2oiBEEXSw0AQQEgBHRBn4CABHENAQsgBUGgAUcNAgtBACADNgKwCkEBIQBBARApIQMLAkACQAJAAkAgA0H7AEYNACADQShHDQFBACgCpApBAC8BmAoiA0EDdGoiBEEAKAKwCjYCBEEAIANBAWo7AZgKIARBBTYCAEEAKAKcCi8BAEEuRg0HQQBBACgCsAoiBEECajYCsApBARApIQMgAUEAKAKwCkEAIAQQAQJAAkAgAA0AQQAoAvAJIQQMAQtBACgC8AkiBEEFNgIcC0EAQQAvAZYKIgBBAWo7AZYKQQAoAqgKIABBAnRqIAQ2AgACQCADQSJGDQAgA0EnRg0AQQBBACgCsApBfmo2ArAKDwsgAxAaQQBBACgCsApBAmoiAzYCsAoCQAJAAkBBARApQVdqDgQBAgIAAgtBAEEAKAKwCkECajYCsApBARApGkEAKALwCSIEIAM2AgQgBEEBOgAYIARBACgCsAoiAzYCEEEAIANBfmo2ArAKDwtBACgC8AkiBCADNgIEIARBAToAGEEAQQAvAZgKQX9qOwGYCiAEQQAoArAKQQJqNgIMQQBBAC8BlgpBf2o7AZYKDwtBAEEAKAKwCkF+ajYCsAoPCyAADQJBACgCsAohA0EALwGYCg0BA0ACQAJAAkAgA0EAKAK0Ck8NAEEBECkiA0EiRg0BIANBJ0YNASADQf0ARw0CQQBBACgCsApBAmo2ArAKC0EBECkhBEEAKAKwCiEDAkAgBEHmAEcNACADQQJqQawIQQYQLw0JC0EAIANBCGo2ArAKAkBBARApIgNBIkYNACADQSdHDQkLIAEgA0EAECsPCyADEBoLQQBBACgCsApBAmoiAzYCsAoMAAsLIAANAUEGIQBBACECAkAgA0FZag4EBAMDBAALIANBIkYNAwwCC0EAIANBfmo2ArAKDwtBDCEAQQEhAgtBACgCsAoiAyABIABBAXRqRw0AQQAgA0F+ajYCsAoPC0EALwGYCg0CQQAoArAKIQNBACgCtAohAANAIAMgAE8NAQJAAkAgAy8BACIEQSdGDQAgBEEiRw0BCyABIAQgAhArDwtBACADQQJqIgM2ArAKDAALCxAlCw8LQQBBACgCsApBfmo2ArAKC0cBA39BACgCsApBAmohAEEAKAK0CiEBAkADQCAAIgJBfmogAU8NASACQQJqIQAgAi8BAEF2ag4EAQAAAQALC0EAIAI2ArAKC5gBAQN/QQBBACgCsAoiAUECajYCsAogAUEGaiEBQQAoArQKIQIDQAJAAkACQCABQXxqIAJPDQAgAUF+ai8BACEDAkACQCAADQAgA0EqRg0BIANBdmoOBAIEBAIECyADQSpHDQMLIAEvAQBBL0cNAkEAIAFBfmo2ArAKDAELIAFBfmohAQtBACABNgKwCg8LIAFBAmohAQwACwuIAQEEf0EAKAKwCiEBQQAoArQKIQICQAJAA0AgASIDQQJqIQEgAyACTw0BIAEvAQAiBCAARg0CAkAgBEHcAEYNACAEQXZqDgQCAQECAQsgA0EEaiEBIAMvAQRBDUcNACADQQZqIAEgAy8BBkEKRhshAQwACwtBACABNgKwChAlDwtBACABNgKwCgtsAQF/AkACQCAAQV9qIgFBBUsNAEEBIAF0QTFxDQELIABBRmpB//8DcUEGSQ0AIABBKUcgAEFYakH//wNxQQdJcQ0AAkAgAEGlf2oOBAEAAAEACyAAQf0ARyAAQYV/akH//wNxQQRJcQ8LQQELLgEBf0EBIQECQCAAQaYJQQUQHQ0AIABBlghBAxAdDQAgAEGwCUECEB0hAQsgAQtGAQN/QQAhAwJAIAAgAkEBdCICayIEQQJqIgBBACgC3AkiBUkNACAAIAEgAhAvDQACQCAAIAVHDQBBAQ8LIAQQJiEDCyADC4MBAQJ/QQEhAQJAAkACQAJAAkACQCAALwEAIgJBRWoOBAUEBAEACwJAIAJBm39qDgQDBAQCAAsgAkEpRg0EIAJB+QBHDQMgAEF+akG8CUEGEB0PCyAAQX5qLwEAQT1GDwsgAEF+akG0CUEEEB0PCyAAQX5qQcgJQQMQHQ8LQQAhAQsgAQu0AwECf0EAIQECQAJAAkACQAJAAkACQAJAAkACQCAALwEAQZx/ag4UAAECCQkJCQMJCQQFCQkGCQcJCQgJCwJAAkAgAEF+ai8BAEGXf2oOBAAKCgEKCyAAQXxqQcoIQQIQHQ8LIABBfGpBzghBAxAdDwsCQAJAAkAgAEF+ai8BAEGNf2oOAwABAgoLAkAgAEF8ai8BACICQeEARg0AIAJB7ABHDQogAEF6akHlABAnDwsgAEF6akHjABAnDwsgAEF8akHUCEEEEB0PCyAAQXxqQdwIQQYQHQ8LIABBfmovAQBB7wBHDQYgAEF8ai8BAEHlAEcNBgJAIABBemovAQAiAkHwAEYNACACQeMARw0HIABBeGpB6AhBBhAdDwsgAEF4akH0CEECEB0PCyAAQX5qQfgIQQQQHQ8LQQEhASAAQX5qIgBB6QAQJw0EIABBgAlBBRAdDwsgAEF+akHkABAnDwsgAEF+akGKCUEHEB0PCyAAQX5qQZgJQQQQHQ8LAkAgAEF+ai8BACICQe8ARg0AIAJB5QBHDQEgAEF8akHuABAnDwsgAEF8akGgCUEDEB0hAQsgAQs0AQF/QQEhAQJAIABBd2pB//8DcUEFSQ0AIABBgAFyQaABRg0AIABBLkcgABAocSEBCyABCzABAX8CQAJAIABBd2oiAUEXSw0AQQEgAXRBjYCABHENAQsgAEGgAUYNAEEADwtBAQtOAQJ/QQAhAQJAAkAgAC8BACICQeUARg0AIAJB6wBHDQEgAEF+akH4CEEEEB0PCyAAQX5qLwEAQfUARw0AIABBfGpB3AhBBhAdIQELIAEL3gEBBH9BACgCsAohAEEAKAK0CiEBAkACQAJAA0AgACICQQJqIQAgAiABTw0BAkACQAJAIAAvAQAiA0Gkf2oOBQIDAwMBAAsgA0EkRw0CIAIvAQRB+wBHDQJBACACQQRqIgA2ArAKQQBBAC8BmAoiAkEBajsBmApBACgCpAogAkEDdGoiAkEENgIAIAIgADYCBA8LQQAgADYCsApBAEEALwGYCkF/aiIAOwGYCkEAKAKkCiAAQf//A3FBA3RqKAIAQQNHDQMMBAsgAkEEaiEADAALC0EAIAA2ArAKCxAlCwtwAQJ/AkACQANAQQBBACgCsAoiAEECaiIBNgKwCiAAQQAoArQKTw0BAkACQAJAIAEvAQAiAUGlf2oOAgECAAsCQCABQXZqDgQEAwMEAAsgAUEvRw0CDAQLEC4aDAELQQAgAEEEajYCsAoMAAsLECULCzUBAX9BAEEBOgD8CUEAKAKwCiEAQQBBACgCtApBAmo2ArAKQQAgAEEAKALcCWtBAXU2ApAKC0MBAn9BASEBAkAgAC8BACICQXdqQf//A3FBBUkNACACQYABckGgAUYNAEEAIQEgAhAoRQ0AIAJBLkcgABAqcg8LIAELPQECf0EAIQICQEEAKALcCSIDIABLDQAgAC8BACABRw0AAkAgAyAARw0AQQEPCyAAQX5qLwEAECAhAgsgAgtoAQJ/QQEhAQJAAkAgAEFfaiICQQVLDQBBASACdEExcQ0BCyAAQfj/A3FBKEYNACAAQUZqQf//A3FBBkkNAAJAIABBpX9qIgJBA0sNACACQQFHDQELIABBhX9qQf//A3FBBEkhAQsgAQucAQEDf0EAKAKwCiEBAkADQAJAAkAgAS8BACICQS9HDQACQCABLwECIgFBKkYNACABQS9HDQQQGAwCCyAAEBkMAQsCQAJAIABFDQAgAkF3aiIBQRdLDQFBASABdEGfgIAEcUUNAQwCCyACECFFDQMMAQsgAkGgAUcNAgtBAEEAKAKwCiIDQQJqIgE2ArAKIANBACgCtApJDQALCyACCzEBAX9BACEBAkAgAC8BAEEuRw0AIABBfmovAQBBLkcNACAAQXxqLwEAQS5GIQELIAELnAQBAX8CQCABQSJGDQAgAUEnRg0AECUPC0EAKAKwCiEDIAEQGiAAIANBAmpBACgCsApBACgC0AkQAQJAIAJFDQBBACgC8AlBBDYCHAtBAEEAKAKwCkECajYCsAoCQAJAAkACQEEAECkiAUHhAEYNACABQfcARg0BQQAoArAKIQEMAgtBACgCsAoiAUECakHACEEKEC8NAUEGIQAMAgtBACgCsAoiAS8BAkHpAEcNACABLwEEQfQARw0AQQQhACABLwEGQegARg0BC0EAIAFBfmo2ArAKDwtBACABIABBAXRqNgKwCgJAQQEQKUH7AEYNAEEAIAE2ArAKDwtBACgCsAoiAiEAA0BBACAAQQJqNgKwCgJAAkACQEEBECkiAEEiRg0AIABBJ0cNAUEnEBpBAEEAKAKwCkECajYCsApBARApIQAMAgtBIhAaQQBBACgCsApBAmo2ArAKQQEQKSEADAELIAAQLCEACwJAIABBOkYNAEEAIAE2ArAKDwtBAEEAKAKwCkECajYCsAoCQEEBECkiAEEiRg0AIABBJ0YNAEEAIAE2ArAKDwsgABAaQQBBACgCsApBAmo2ArAKAkACQEEBECkiAEEsRg0AIABB/QBGDQFBACABNgKwCg8LQQBBACgCsApBAmo2ArAKQQEQKUH9AEYNAEEAKAKwCiEADAELC0EAKALwCSIBIAI2AhAgAUEAKAKwCkECajYCDAttAQJ/AkACQANAAkAgAEH//wNxIgFBd2oiAkEXSw0AQQEgAnRBn4CABHENAgsgAUGgAUYNASAAIQIgARAoDQJBACECQQBBACgCsAoiAEECajYCsAogAC8BAiIADQAMAgsLIAAhAgsgAkH//wNxC6sBAQR/AkACQEEAKAKwCiICLwEAIgNB4QBGDQAgASEEIAAhBQwBC0EAIAJBBGo2ArAKQQEQKSECQQAoArAKIQUCQAJAIAJBIkYNACACQSdGDQAgAhAsGkEAKAKwCiEEDAELIAIQGkEAQQAoArAKQQJqIgQ2ArAKC0EBECkhA0EAKAKwCiECCwJAIAIgBUYNACAFIARBACAAIAAgAUYiAhtBACABIAIbEAILIAMLcgEEf0EAKAKwCiEAQQAoArQKIQECQAJAA0AgAEECaiECIAAgAU8NAQJAAkAgAi8BACIDQaR/ag4CAQQACyACIQAgA0F2ag4EAgEBAgELIABBBGohAAwACwtBACACNgKwChAlQQAPC0EAIAI2ArAKQd0AC0kBA39BACEDAkAgAkUNAAJAA0AgAC0AACIEIAEtAAAiBUcNASABQQFqIQEgAEEBaiEAIAJBf2oiAg0ADAILCyAEIAVrIQMLIAMLC+wBAgBBgAgLzgEAAHgAcABvAHIAdABtAHAAbwByAHQAZgBvAHIAZQB0AGEAbwB1AHIAYwBlAHIAbwBtAHUAbgBjAHQAaQBvAG4AcwBzAGUAcgB0AHYAbwB5AGkAZQBkAGUAbABlAGMAbwBuAHQAaQBuAGkAbgBzAHQAYQBuAHQAeQBiAHIAZQBhAHIAZQB0AHUAcgBkAGUAYgB1AGcAZwBlAGEAdwBhAGkAdABoAHIAdwBoAGkAbABlAGkAZgBjAGEAdABjAGYAaQBuAGEAbABsAGUAbABzAABB0AkLEAEAAAACAAAAAAQAAEA5AAA=",typeof Buffer<"u"?Buffer.from(A6,"base64"):Uint8Array.from(atob(A6),A=>A.charCodeAt(0)))).then(WebAssembly.instantiate).then(({exports:A})=>{W=A}),A6;var Ck=/^\s*(['"](\..*)['"])\s*$/mu,Ce=class extends Error{constructor(j){super();this.persistedMissingRelativeImports=j;this.name="RewriteRelativeImportsError"}};function Ft(A){return A instanceof Ce}async function It(A,e){await e6;let[j]=j6(A),t=A,r=new Set,o=[...j].reverse();for(let{s:n,e:i,d:a}of o){if(a===-2)continue;if(a===-1){let u=A.substring(n,i);if(!u.startsWith("."))continue;let E=e[u];E===void 0&&(r.add(u),E=wa(u)),t=Da(t,E,n,i);continue}let s=A.substring(n,i),k=s.replace(/\/\*[\s\S]*?\*\/|([^\\:]|^)\/\/.*$/gm,"$1").trim().match(Ck);if(!k)continue;let c=k[1],d=k[2];if(c===void 0||d===void 0)continue;let $=e[d];$===void 0&&(r.add(d),$=wa(d));let B=s.replace(new RegExp(t6(c),"g"),JSON.stringify($));t=Da(t,B,n,i)}return r.size>0?ea({partiallyProcessedCode:t,unresolvedRelativeImports:r,parsedImports:j}):ja(t)}function Da(A,e,j,t){return A.slice(0,j)+e+A.slice(t)}function t6(A){return A.replace(/[.*+\-?^${}()|[\]\\]/gu,"\\$&")}function wa(A){return`!missing/${A}`}var x=LA("modules-storage"),Tk="kit",Na=Object.freeze({}),Ka=Object.freeze({});function Z0(A){return A&&(A.type==="codeFile"||A.type==="shader")?(I(GA(A.sourceContent),`${A.type} module entry is missing source content`),!0):!1}function r6(A){return A.name===br&&A.type===Xn}function Dk(A){return A.id===jj}function La(A,e){return!!A&&A.saveId===e.saveId&&A.id===e.moduleId}var ht=class extends Error{constructor(){super("A circular dependency was detected."),this.name="CircularDependencyError"}},Te="update-modules-storage",wk=0;async function jA(A){let e=performance.now(),j=`acquire-modules-storage-lock-${wk++}`;return he(j),Kr.request(Te,()=>{let t=performance.now()-e;return ct(`\u{1F513} Acquire ${Te} lock`,j),dt(j),x.debug("\u{1F513} Acquired the",Te,"lock in",t.toFixed(2),"ms"),t>1e3&&x.warn("\u2757 Long wait: it took",t.toFixed(0),"ms to acquire the",Te,"lock."),A()})}var gt=class{constructor(e,j,t,r){this.storage=e;this.localId=j;this.type=t;this.debugModuleStoreAndComponentLoaderRevisionsMatch=r}get id(){let e=this.storage.getPersistedModuleByLocalId(this.localId);if(e)return e.id;let j=this.storage.getModuleTreeData(this.localId);return I(j,"Module must exist"),j.moduleId}get saveId(){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e)return e.saveId;let j=this.storage.getPersistedModuleByLocalId(this.localId);return I(j,"Module must exist"),j.saveId}get transientSVGIcon(){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e)return e.svgIcon}get lastPublish(){return this.storage.getPersistedModuleByLocalId(this.localId)?.lastPublish??null}externalModuleIdentifier(e="default"){let j=this.storage.getTransientSaveByLocalId(this.localId);if(j){let r=MA(j.name);return sj(this.id,j.saveId,r.module,e)}let t=this.storage.getPersistedModuleByLocalId(this.localId);return I(t?.files.module,"ModulesStorage: Expected module typed file in persisted module."),sj(this.id,t.saveId,t.files.module,e)}delete(){return this.storage.delete(this.localId)}publish(e,j,t){return this.storage.publish(this.localId,{namespace:e,name:j,version:t})}sourceRevision(){let e=this.storage.getTransientSaveByLocalId(this.localId);if(e)return e.sourceRevision;let j=this.storage.getPersistedModuleByLocalId(this.localId);if(j)return k6(j)}annotations(e,j){let t=this.storage.getTransientSaveByLocalId(this.localId),r=t?.annotations?Uj(t.annotations):this.storage.getModuleTreeData(this.localId)?.annotations;return e&&this.debugModuleStoreAndComponentLoaderRevisionsMatch()&&qk(r,e),j?r?.[j]:r}},o6=class extends gt{constructor(j,t,r,o,n){super(j,t,r,o);this.name=n}currentSourceEquals(j,t){let r=this.storage.getPersistedModuleByLocalId(this.localId);return!r||r.submodules.length||t.submodules?.size?!1:r.sourceContent===j}updateSource(j,t={}){return this.storage.updateSources([{localId:this.localId,source:j,options:{...t,stableName:!0}}])}persist(j){return this.storage.upsert(this.localId,{...j,type:this.type,name:this.name})}getKitSectionsStructure(){let j=this.storage.getTransientSaveByLocalId(this.localId);return j?j.kitSectionsStructure:this.storage.getKitSectionsStructure(this.name)}};function qk(A,e){if(!A)return;let j=AA(e.identifier);I(yA(j)&&JA(j),"Entity must have an identifier."),e.annotations&&j.exportSpecifier in A&&!Mr(A[j.exportSpecifier],Uj({default:e.annotations}).default,!0)&&x.reportError("Static annotations are not synchronized with runtime annotations.",{identifier:e.identifier})}function k6(A){let e=A?.metadata.sourceRevision;return ej(e)?e:void 0}var i6=class extends gt{updateSource(e,j){return this.storage.updateSources([{localId:this.localId,source:e,options:j??{}}])}persist(e){return this.storage.update(this.localId,e)}rename(e){return this.storage.rename(this.localId,e)}},bt=class{constructor(e,j,t=()=>!0){this.storage=e;this.type=j;this.moduleStoreAndComponentLoaderRevisionsMatch=t}async create(e){return this.storage.create({...e,type:this.type})}getByStableName(e){return new o6(this.storage,hr(this.type,e),this.type,this.moduleStoreAndComponentLoaderRevisionsMatch,e)}getByLocalId(e){return new i6(this.storage,e,this.type,this.moduleStoreAndComponentLoaderRevisionsMatch)}getUniqueName(e){return this.storage.getUniqueNameForType(this.type,e)}},_t=class{constructor(e,j,t,r,o,n,i,a){this.getModulesService=e;this.compile=j;this.process=t;this.processWhenReady=r;this.runWhenIdle=o;this.treeStore=n;this.getActiveScope=i;this.makeDocumentReadOnly=a;T(this,"useTreeAsLocalModuleList",!1);T(this,"writeLocalModulesToTree",!1);T(this,"detached",!1);T(this,"dependenciesModule");T(this,"persistedModules",new Map);T(this,"persistedLocalIdsByTypeSlashNameCache",new WeakMap);T(this,"transientSaves",new Map);T(this,"lastSnapshot",{dependenciesModule:void 0,modules:new Map,depsGraph:{},initialized:!1});T(this,"modulesService");T(this,"lazyServerModulesForTransientSaves",new Map);T(this,"backgroundJob",null);T(this,"backgroundAbortController",null);T(this,"initialized",!1);T(this,"initializationStarted",!1);T(this,"readOnlyTree",!1);T(this,"resolveInitialization",()=>{throw new Error("initializationPromise has not executed yet")});T(this,"rejectInitialization",()=>{throw new Error("initializationPromise has not executed yet")});T(this,"initializationPromise",new Promise((e,j)=>{this.resolveInitialization=e,this.rejectInitialization=j}));T(this,"didSetupModuleEventStream",!1);T(this,"transientInfo",null);T(this,"previousLocalModuleNodes",[]);T(this,"treeNodesToUpdate",new Map);T(this,"treeNodesToDelete",[]);T(this,"goingToStartUsingLocalModulesInTree",!1);T(this,"listeners",new Set);T(this,"transientSaveRetries",new Map);T(this,"transientSaveRelativeImportRetries",new Set);T(this,"downloadQueue",new Wj(1200))}hasPendingServerModules(){return this.lazyServerModulesForTransientSaves.size>0}processOnePendingServerModule(){return this.lazyServerModulesForTransientSaves.size===0?Promise.resolve(!1):jA(async()=>{for(let[,e]of this.lazyServerModulesForTransientSaves)for(let j of e){let t=this.persistedModules.get(j)?.localId;if(!t)continue;let r=this.persistedModules.get(t);if(r?.kind!=="server")continue;x.debug("\u{1F343} Process one server \u2192 local module",j);let o=await this.createLocalModuleFromModule(r),n=kA(this.persistedModules,i=>{i.set(r.localId,o)});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1,transientSaves:this.transientSaves}),!0}return!1})}async changeScope(e){if(!this.hasPendingServerModules())return;let j=xe(e);!j||j.size===0||(await jA(async()=>{let t=new Set,r=this.lastSnapshot.depsGraph;for(let[a,s]of this.lazyServerModulesForTransientSaves)hj(r,a,s,j,t);let o=[];for(let a of t){let s=this.getModuleWithTypeSlashName(a);s?.kind==="server"&&o.push(this.createLocalModuleFromModule(s))}if(x.debug("\u{1F343} Prioritizing making visible modules local after changing scope:",e.id,"/ Visible:",j,"/ Visible Dependencies:",t,"/ Server modules:",o.length),o.length===0)return;let n=await Promise.all(o),i=kA(this.persistedModules,a=>{for(let s of n)a.set(s.localId,s)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:i,depsGraph:r,didRemoteChange:!1,transientSaves:this.transientSaves})}),this.makeLazyServerModulesLocalWhenIdle().catch(EA))}async makeVisibleDependentServerModulesLocal(e){if(!hA.isOn("prioritizedModuleEvaluation"))return;let j=this.getActiveScope(),t=new Set,r=xe(j),o=new Set;for(let a of e){let s=this.typeAndNameFromLocalId(a.localId,a.options.stableName),l=X(s),k=this.lastSnapshot.depsGraph;hj(k,l,o,r,t),this.lazyServerModulesForTransientSaves.set(l,o),t.delete(l)}let n=[];for(let a of t){let s=this.getModuleWithTypeSlashName(a);s?.kind==="server"&&n.push(this.createLocalModuleFromModule(s))}x.debug("\u{1F343} Prioritizing dependent server modules after updating:",e.map(a=>a.localId),"/ Visible:",t,"/ Lazy:",o,"/ Server modules:",n.length);let i=this.persistedModules;if(n.length>0){let a=await Promise.all(n);i=kA(i,s=>{for(let l of a)s.set(l.localId,l)})}this.persistedModules=i}async makeLazyServerModulesLocalWhenIdle(){this.cancelBackgroundJob(),this.backgroundAbortController=new AbortController;let{signal:e}=this.backgroundAbortController;return this.backgroundJob=(async()=>{try{for(;this.hasPendingServerModules()&&!e.aborted;){let j=new le;if(this.runWhenIdle(()=>{if(e.aborted){j.resolve(!1);return}this.processOnePendingServerModule().then(j.resolve,j.reject)}),!await j)break}}finally{this.backgroundJob=null,this.backgroundAbortController=null}})(),this.backgroundJob}cancelBackgroundJob(){this.backgroundAbortController&&this.backgroundAbortController.abort()}getTransientSave(e){return this.transientSaves.get(e)}resetModuleStateAndPermissions(e){this.readOnlyTree=e==="readonly",this.useTreeAsLocalModuleList=e==="readonly"||e==="readwrite-detached",this.detached=e==="readwrite-detached",!this.useTreeAsLocalModuleList&&this.modulesService&&this.setupModuleEventStreamIfNeeded(),this.treeNodesToUpdate.clear(),this.treeNodesToDelete=[],this.transientSaves.size>0&&(x.reportErrorOncePerMinute(new Error("Discarding transient saves"),{count:this.transientSaves.size}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:new Map,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}))}async waitForModulesToSave(){let e=Array.from(this.transientSaves.keys());for(let t of e)this.transientSaves.has(t)&&await this.update(t,{});let j=this.transientSaves.size;j>0&&x.warn("waitForModulesToSave: transientSaves seems to be growing, ignoring rest:",j)}async initialize(){return this.initializationStarted?this.initializationPromise:(this.initializationStarted=!0,this.initializeInternal().then(this.resolveInitialization,e=>{x.reportError(e,{context:"Failed to initialize ModulesStorage: "}),this.rejectInitialization(e)}),this.initializationPromise)}setupModuleEventStreamIfNeeded(){this.didSetupModuleEventStream||(this.didSetupModuleEventStream=!0,I(this.modulesService,"ModulesStorage.useModuleEventStream: expected modules service to be initialized"),this.modulesService.moduleEventsStream().read(async({events:e})=>{let j=e.filter(Lk);this.handleRemoteModuleSaveEvents(j).catch(x.reportError);let t=e.filter(Jk);this.handleRemoteModuleDeleteEvents(t).catch(x.reportError)}).catch(e=>{x.reportError(e,{context:"Failed to read ModulesAPI event stream: "})}))}async initializeInternal(){if(this.modulesService=await this.getModulesService(),!this.modulesService)return;let e=kt.getModuleNodes(this.treeStore.tree);this.writeLocalModulesToTree=!!e,this.useTreeAsLocalModuleList||this.setupModuleEventStreamIfNeeded();let j,t=performance.now();if($t("modulesStorageStart"),this.useTreeAsLocalModuleList&&e){x.info("init from tree data"),this.previousLocalModuleNodes=e;let s=e.map(l=>({moduleId:l.save.moduleId,saveId:l.save.saveId}));j=await this.modulesService.lookUpModules({queries:s})}else x.info("init from module list"),j=await this.modulesService.list({});$t("modulesStorageInit"),x.debug("listing modules took:",performance.now()-t,"millis");let r=j.data.find(r6);r&&await this.updateDependenciesModule(r);let o=new Map,n=0,i=new Set;await Promise.all(j.data.map(async s=>{if(X(s)===jj)return;let l=await this.createServerModuleFromData(s);x.trace("init - create module",l.localId,l.id,l.saveId,l.savedAt),o.set(l.localId,l),Qk(e,s)&&(n+=1),i.add(l.localId)}));let a=this.createDependencyGraph(o);this.initialized=!0,this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:o,transientSaves:this.transientSaves,depsGraph:a,didRemoteChange:!0}),$t("modulesStorageFirstPublish"),this.processTreeUpdates(),n>0&&x.reportError("Data loss detected based on modules saves and modules in tree.",{dataLossCount:n})}createDependencyGraph(e){let j=[];for(let t of e.values()){let r=X(t),o=t.imports.relative;j.push([r,o])}return Nr(j)}hasPendingTreeData(){return this.treeNodesToUpdate.size>0||this.treeNodesToDelete.length>0}processTreeUpdates(){if(this.initialized){if(this.readOnlyTree)if(this.useTreeAsLocalModuleList){if(!this.treeStore.tree.has(Ij)){x.info("detected removal of local modules list node, stopping to use tree as local module list"),this.useTreeAsLocalModuleList=!1,this.setupModuleEventStreamIfNeeded();return}}else{if(!this.treeStore.tree.has(Ij))return;x.info("detected insertion of a local modules list node, starting to use tree as local module list"),this.useTreeAsLocalModuleList=!0}this.syncLocalModules(),this.tryWriteTreeData()}}async syncLocalModules(){if(!this.useTreeAsLocalModuleList)return;let e=kt.get(this.treeStore.tree)?.children;if(!e||this.previousLocalModuleNodes===e)return;let j=[],t=Ln(this.previousLocalModuleNodes,r=>[r.id,r]);this.previousLocalModuleNodes=e;for(let r of e){let o=t.get(r.id);if(t.delete(r.id),o===r)continue;let n=r.save,i=this.persistedModules.get(r.id);La(i,n)||Dk(r)&&La(this.dependenciesModule,n)||(j.push({moduleId:n.moduleId,saveId:n.saveId}),x.debug("syncLocalModules to update:",r.id))}if(t.size>0&&(x.debug("syncLocalModules removing:",t.keys()),this.handleRemoteModuleDeletes(Array.from(t.values()).map(r=>r.save.moduleId))),j.length>0){x.debug("syncLocalModules updating:",j),I(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let r=performance.now(),o=await this.modulesService.lookUpModules({queries:j});x.debug("lookupModules took:",performance.now()-r,"millis"),await this.handleRemoteModuleSaves(o.data)}}canWriteTree(){return!this.treeStore.tree.isViewOnly}tryWriteTreeData(){this.canWriteTree()&&this.hasPendingTreeData()&&this.processWhenReady(()=>{this.writeTreeData()},"nonUserEvent")}writeTreeData(){if(!this.hasPendingTreeData())return;if(!this.canWriteTree())throw new Error("Cannot write tree data");let e=this.treeStore.tree;e.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(e);for(let j of this.treeNodesToDelete)this.persistedModules.get(j)||(x.debug("tryWriteTreeData, remove:",j),e.remove(j));this.treeNodesToDelete=[];for(let[j,{treeVersion:t,errors:r,persistedModule:o}]of this.treeNodesToUpdate.entries())this.persistedModules.get(j)?.saveId===o.saveId&&(x.debug("tryWriteTreeData, write:",j,t,o.id,o.saveId,r),this.updateNode(e,j,t,o,r));this.treeNodesToUpdate.clear()}updateTreeNodeWithOwnTreeVersion(e,j){!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()||this.process(()=>{this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree);let r=this.treeStore.tree.get(e)?.save.treeVersion??this.treeStore.remoteTreeVersion;x.debug("updateTreeNodeWithCurrentTreeVersion:",e,r,j.id,j.saveId),this.updateNode(this.treeStore.tree,e,r,j)},"nonUserEvent")}updateTreeNode(e,j,t,r,o){return!this.writeLocalModulesToTree&&!this.maybeUpgradeDocument()?!0:this.canWriteTree()?(this.process(()=>{this.treeStore.tree.lineage.setEditReason("localmodules"),this.createLocalModulesListNodeIfNeeded(this.treeStore.tree),x.debug("updateTreeNode:",e,j,t.id,t.saveId),this.updateNode(this.treeStore.tree,e,j,t,r,o)},"nonUserEvent"),!0):(x.debug("updateTreeNode - readonly, buffering change"),this.treeNodesToUpdate.set(e,{treeVersion:j,persistedModule:t,errors:r,kitSectionsStructure:o}),!0)}removeTreeNode(e){this.writeLocalModulesToTree&&(this.canWriteTree()?this.process(()=>{x.debug("removeTreeNode:",e),this.treeStore.tree.remove(e)}):this.treeNodesToDelete.push(e))}updateNode(e,j,t,r,o,n){I(this.writeLocalModulesToTree,"not using tree for local modules");let i=e.get(j)?.asDraft()??new Dr({id:j});I(i instanceof Dr);let a=r.metadata.pluginId,s=r.annotations?Uj(r.annotations):i.save.annotations,l=Di(s?.default?.framerTrackingIds);l&&(s.default.framerTrackingIds=l);let k={treeVersion:t,moduleId:r.id,saveId:r.saveId,imports:r.imports?.relative,title:r.title,name:r.name,type:r.type,sourceRevision:r.sourceRevision,annotations:s,pluginId:GA(a)?a:i.save.pluginId};i.set({save:k}),i.tree()||e.insertNode(i,Ij);let c=Aa(r);if(!e.has(c)||(this.updateNodeKitSectionsStructure(e,c,n),!o))return;let d=e.get(si);if(x.debug("Writing serialization errors from artifacts to tree for",c),d?.children?.forEach(B=>{let u=B.sourceNodeId??B.scopeId,E=ke(B.sourceNodeModuleType)||r.type===B.sourceNodeModuleType;!u||u!==c||!E||!ki(B.type)||e.remove(B.id)}),o.length===0)return;let $=li.ensure(e);o.forEach(B=>e.insertNode(B,$.id))}updateNodeKitSectionsStructure(e,j,t){if(!jo(t))return;let r=e.get(j);SA(r)&&(Mr(r.kitSectionsStructure,t)||t.length===0&&ke(r.kitSectionsStructure)||r.set({kitSectionsStructure:t}))}getModuleTreeData(e){return this.treeStore.tree.getNodeWithTrait(e,wr)?.save}getKitSectionsStructure(e){return this.treeStore.tree.getNodeWithTrait(e,SA)?.kitSectionsStructure}createLocalModulesListNodeIfNeeded(e){if(I(this.writeLocalModulesToTree,"not using tree for local modules"),e.has(Ij)||!this.canWriteTree())return;x.debug("ensureAllModulesExistInTree:",this.persistedModules.size),e.insertNode(new kt);let j=this.treeStore.remoteTreeVersion;this.persistedModules.forEach(t=>{this.updateNode(e,t.localId,j,t)}),this.dependenciesModule&&this.updateNode(e,jj,j,this.dependenciesModule)}usingLocalModulesInTree(){return this.treeStore.tree.has(Ij)||this.goingToStartUsingLocalModulesInTree}async startUsingLocalModulesInTree(){if(!this.canWriteTree())throw Error("Project is read only.");this.goingToStartUsingLocalModulesInTree=!0,this.process(()=>{if(this.startUsingLocalModulesInTree){if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("startUsingLocalModulesInTree"),this.goingToStartUsingLocalModulesInTree=!1,this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)}})}stopUsingLocalModulesInTree(){this.goingToStartUsingLocalModulesInTree=!1,this.process(()=>{if(!this.canWriteTree())throw Error("Project is read only.");this.treeStore.tree.lineage.setEditReason("stopUsingLocalModulesInTree"),this.treeStore.tree.remove(Ij),this.writeLocalModulesToTree=!1,this.setupModuleEventStreamIfNeeded()})}maybeUpgradeDocument(){return this.process(()=>{if(!this.canWriteTree()){x.warn("cannot upgrade document if we cannot write, but should not be saving modules either");return}x.info("upgrading document to use local modules list node"),this.treeStore.tree.lineage.setEditReason("maybeUpgradeDocument"),this.writeLocalModulesToTree=!0,this.createLocalModulesListNodeIfNeeded(this.treeStore.tree)},"nonUserEvent"),this.writeLocalModulesToTree}getModuleWithTypeSlashName(e){let j=this.findPersistedModuleLocalIdByTypeSlashName(this.persistedModules,e);if(j)return this.persistedModules.get(j)}async updateDependenciesModule(e){I(r6(e),"updateDependenciesModule called with non dependencies module data");let j=await this.getDependenciesFiles(e),t=j?.dependenciesMapContent;if(!t){let r=JSON.parse(j.importMapContent),o=Re(r);t=JSON.stringify(o),this.readOnlyTree?x.reportError(new Error("modules storage is read only"),{context:"modules storage is read only while calling updateDependenciesModule"}):(await this.updateDependenciesLocked(r,o),x.info("The missing dependencies file has now been created."))}this.dependenciesModule={kind:"dependencies",...e,id:e.id,localId:e.localId,type:"config",name:e.name,importMapContent:j.importMapContent,dependenciesMapContent:t}}async createServerModuleFromData(e){let j={kind:"server",...e,id:e.id,localId:e.localId,moduleURL:e.baseURL+(e.type==="kit"?e.files.source:e.files.module),update:performance.now()};if((j.type==="codeFile"||j.type==="shader"||j.type==="webPageMetadata")&&(j.sourceContent=await this.fetchSourceContentFromData(e)),Zi(j)&&Yi(j)===0){j.sourceContent=await this.fetchSourceContentFromData(e);let t=j.sourceContent.includes("useQueryData")?1:0;j.metadata={...j.metadata,compatibleCmsVersion:t}}return j}async fetchSourceContentFromData(e){return this.downloadQueue.run(async()=>{let j=e.baseURL+e.files.source;return(await fetch(j)).text()})}async refresh(){if(this.initialized&&!this.useTreeAsLocalModuleList)return x.debug("refresh: acquiring lock"),jA(()=>this.refreshLocked())}async refreshLocked(){x.debug("refresh: start"),I(this.modulesService,"ModulesStorage.refresh: expected modules service to be initialized");let{data:e}=await this.modulesService.list({});x.debug("refresh: there's",e.length,"modules to process");let j=new Map,t=new Set;await Promise.all(e.map(async o=>{let n=o.localId;if(r6(o)){this.dependenciesModule?.saveId!==o.saveId&&await this.updateDependenciesModule(o);return}let i=this.persistedModules.get(n);if(i?.saveId===o.saveId)j.set(n,i);else{let a=await this.createServerModuleFromData(o);x.debug("refresh - updating module",a.localId,a.id,a.saveId,a.savedAt),j.set(n,a)}t.add(n)}));let r=this.createDependencyGraph(j);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:j,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0}),x.debug("refresh: finish")}whenInitialized(){return this.initializationPromise}async whenIdle(){await Promise.all([this.whenInitialized(),jA(()=>{})])}isProcessing(){return!!(!this.initialized||this.transientSaves.size>0||Kr.isLocked(Te))}hasLocalChanges(){return this.transientSaves.size>0}hasLocalCodeFileChanges(){if(this.transientSaves.size===0)return!1;for(let e of this.transientSaves.values())if(e.type==="codeFile"||e.type==="shader"||e.type==="config")return!0;return!1}addListener(e){this.listeners.add(e)}removeListener(e){this.listeners.delete(e)}notifyListeners(e){this.listeners.forEach(j=>{try{j(e)}catch(t){x.reportError(t)}})}subscribe(e){return this.addListener(e),e(Ja(this.dependenciesModule,void 0,this.persistedModules,this.transientSaves,this.lastSnapshot.depsGraph,new Map,this.initialized,!1,!1)),()=>this.removeListener(e)}getDependentsOfModule(e){return this.lastSnapshot.depsGraph[e]?.dependents}getUniqueNameForType(e,j){let t=new Set;for(let r of this.persistedModules.values())r.type===e&&t.add(r.name);return Wi(t,j)}async updateSources(e){return jA(async()=>{let j=!1;for(let{localId:t,source:r,options:o}of e){let n=Date.now();try{await this.updateSourceLocked(t,{...o,source:r}),j=!0}catch(i){i instanceof ht&&BA({type:"add",variant:"error",primaryText:"Self-nested components",secondaryText:"won\u2019t update.",key:"component-circular-dependency",icon:"error",duration:Number.POSITIVE_INFINITY}),x.reportError(i)}finally{let i=Date.now()-n;x.debug("\u23F1 update source",t,"in",i,"ms")}}return await this.makeVisibleDependentServerModulesLocal(e),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!1}),this.makeLazyServerModulesLocalWhenIdle().catch(EA),j})}async updateDependenciesSource(e,j){return jA(async()=>{I(this.dependenciesModule,"Dependency files must already exist to be updated.");let t=e===zn?j:this.dependenciesModule.importMapContent,r=e===Wn?j:this.dependenciesModule.dependenciesMapContent;return this.updateDependenciesLocked(JSON.parse(t),JSON.parse(r))})}async compileSubmodules(e,j){let t={};return await Promise.all([...j].map(async([r,o])=>{let n=await this.compile({name:r,source:o,type:e,includeSourceMap:!1,addFramerMetadata:!1});for(let a of n.imports.relative){let s=Ti(a);if(!(s&&j.has(s)))throw new Error("Submodules only support relative imports of other submodules")}let i=xi(r);t[i]=n.code})),t}typeAndNameFromLocalId(e,j=!1){if(j)return rt(e);for(let t of this.lastSnapshot.modules.values())if(t?.localId===e)return t;throw new Error(`Module entry for local id ${e} missing in internal snapshot`)}async updateSourceLocked(e,{source:j,submodules:t,binaryAssets:r=Ka,stableName:o=!1,assets:n,preventCircularImports:i,telemetrySession:a,treeVersion:s,sourceRevision:l,svgIcon:k,kitSectionsStructure:c}){await this.whenInitialized();let d=this.typeAndNameFromLocalId(e,o),$=X(d),B=await this.compile({localId:e,name:$,source:j,type:d.type,includeSourceMap:n6(d.type),telemetrySession:a}),u=Na;t&&(u=await this.compileSubmodules(d.type,t));let E=Vj(this.lastSnapshot.depsGraph,$,B.imports.relative);if(i&&zi(E,$))throw new ht;let f=Hk(d.type,B.annotations),F=kA(this.transientSaves,g=>{let b=g.get(e),G,v=f?.framerIntrinsicWidth;v&&(G={...G,intrinsicWidth:Number.parseInt(v,10)});let N=f?.framerIntrinsicHeight;if(N&&(G={...G,intrinsicHeight:Number.parseInt(N,10)}),G={...G,compilerContractVersion:1,treeAnnotations:!0,localModuleImportMapEntries:this.moduleUsesLocalImportMapSpecifiers($)},b)b.saveId=dj(),b.moduleContent=B.code,b.sourceContent=j,b.sourceMapContent=B.sourceMap,b.submoduleContents=u,b.binaryAssetContents=r,b.imports=B.imports,b.exports=B.exportedNames,b.reExportedModules=B.reExportedModules,b.treeVersion=s??this.treeStore.remoteTreeVersion,b.sourceRevision=l??b.sourceRevision,b.annotations=B.annotations,b.svgIcon=k??b.svgIcon,b.kitSectionsStructure=c??b.kitSectionsStructure,b.update=performance.now(),n&&(b.assets=Array.from(n)),G&&(b.metadata={...b.metadata,...G});else{let C={localId:e,type:d.type,name:d.name,saveId:dj(),moduleContent:B.code,sourceContent:j,sourceMapContent:B.sourceMap,submoduleContents:u,binaryAssetContents:r,imports:B.imports,exports:B.exportedNames,reExportedModules:B.reExportedModules,treeVersion:s,sourceRevision:l,svgIcon:k,kitSectionsStructure:c,annotations:B.annotations,update:performance.now()};n&&(C.assets=Array.from(n)),G&&(C.metadata=G),g.set(e,C)}});this.transientInfo||=new Set,this.transientInfo.add(e),this.transientSaves=F,this.lastSnapshot={...this.lastSnapshot,depsGraph:E}}async create(e){return jA(()=>this.createLocked(e))}async createLocked(e){await this.whenInitialized();let{type:j,name:t,source:r,...o}=e,n=X({type:j,name:t}),i=await this.compile({name:n,source:r,type:j,includeSourceMap:n6(j)}),a={localId:void 0,type:j,name:t,saveId:dj(),moduleContent:i.code,sourceContent:r,sourceMapContent:i.sourceMap,submoduleContents:Na,binaryAssetContents:Ka,imports:i.imports,exports:i.exportedNames,reExportedModules:i.reExportedModules,treeVersion:e.treeVersion||this.treeStore.remoteTreeVersion,sourceRevision:e.sourceRevision,svgIcon:e.svgIcon,kitSectionsStructure:e.kitSectionsStructure,annotations:i.annotations,update:performance.now()},s=await this.createBatchSaveForUpdatedModule("$new",a,this.persistedModules,new Map,new Map,{type:j,name:t,...o});I(!this.readOnlyTree,"modules storage is read only"),I(this.modulesService);let{data:l}=await this.modulesService.saveBatch({batch:[s]}),{updatedModuleLocalId:k,nextPersistedModules:c}=this.processTransientSaveData({nextPersistedModules:this.persistedModules,transientSave:a,data:l}),d=Vj(this.lastSnapshot.depsGraph,n,i.imports.relative);return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:c,transientSaves:this.transientSaves,depsGraph:d,didRemoteChange:!0}),k}async update(e,j){let t=this.persistedModules.get(e);return I(t,"Trying to update an unknown module with localId:",e),jA(async()=>{let r=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[e]:{...j,name:t.name,type:t.type}})}finally{let o=Date.now()-r;x.debug("\u23F1 update",e,"in",o,"ms")}})}async rename(e,j){return jA(()=>this.renameLocked(e,j))}async renameLocked(e,j){await this.whenInitialized();let t=this.persistedModules,r=this.lastSnapshot.depsGraph,o=t.get(e);I(o,"Trying to rename an unknown module with localId:",e);let n=this.treeStore.remoteTreeVersion,i=X(o);I(!this.readOnlyTree,"modules storage is read only"),I(!this.detached,"renaming modules is not supported in detached mode"),I(this.modulesService);let a=await this.modulesService.update({moduleId:o.id,name:j});I(a,"invalid update reply");let s=r[i]?.dependents,l=[],k={},c=X(a);if(i!==c&&(r=ut(r,i),r=Vj(r,c,o.imports.relative)),s){let d=[],$=[];for(let E of t.values()){let f=X(E);s.has(f)&&(E.kind==="local"?d.push(E):$.push(E))}if($.length>0){let E=await Promise.all($.map(f=>this.createLocalModuleFromModule(f)));t=kA(t,f=>{for(let F of E)f.set(F.localId,F),d.push(F)})}let B=[];for(let E of d){let f=X(E),F=Tr(f,`${o.type}/${j}`);I(F,"Failed to create relative path to",o.type,"/",j);let g=Tr(f,i);I(g);let b=E.imports.relative.indexOf(g);if(b===-1){x.warn(E.localId,"doesn't import",g);continue}let G=[...E.imports.relative];G[b]=F;let v={absolute:E.imports.absolute,bare:E.imports.bare,relative:G},N=Ua(E.sourceContent,g,F),C=Ua(E.moduleContent,g,F);k[E.localId]={sourceContent:N,moduleContent:C,imports:v},I(E.files.source);let R={type:E.type,moduleId:E.id,name:E.name,saveId:dj(),patchSaveId:E.saveId,files:[{name:E.files.source,type:"source",content:N}],imports:v,detached:this.detached};B.push(R)}I(!this.readOnlyTree,"modules storage is read only");let{data:u}=await this.modulesService.saveBatch({batch:B});l=u}t=kA(t,d=>{if(this.updateTreeNode(e,n,a)){o.kind==="server"?d.set(e,{...a,kind:"server",localId:a.localId,id:a.id,moduleURL:a.baseURL+a.files.module,sourceContent:o.sourceContent,update:performance.now()}):d.set(e,{...a,kind:"local",localId:a.localId,id:a.id,moduleURL:a.baseURL+a.files.module,sourceContent:o.sourceContent,moduleContent:o.moduleContent,sourceMapContent:o.sourceMapContent,submoduleContents:o.submoduleContents,binaryAssetContents:o.binaryAssetContents,update:performance.now()});for(let B of l){let u=B.localId,E=d.get(u);I(E?.kind==="local","dependent module must be local:",u);let f=k[u];I(f,"dependent module update must exist:",u),this.updateTreeNode(u,n,B)&&(d.set(u,{...B,kind:"local",localId:u,id:B.id,moduleURL:B.baseURL+B.files.module,moduleContent:f.moduleContent,sourceContent:f.sourceContent,sourceMapContent:E.sourceMapContent,submoduleContents:E.submoduleContents,binaryAssetContents:E.binaryAssetContents,imports:f.imports,exports:B.exports,reExportedModules:B.reExportedModules,submodules:B.submodules,binaryAssets:B.binaryAssets,sourceRevision:E.sourceRevision,update:E.update}),r=Vj(r,X(B),f.imports.relative))}}}),this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:t,transientSaves:this.transientSaves,depsGraph:r,didRemoteChange:!0})}async upsert(e,j){return jA(async()=>{let t=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked({[e]:j})}finally{let r=Date.now()-t;x.debug("\u23F1 upsert",e,"in",r,"ms")}})}async upsertBatch(e){return jA(async()=>{let j=Date.now();try{return await this.whenInitialized(),await this.upsertBatchLocked(e)}finally{let t=Date.now()-j;x.debug("\u23F1 upsert batch in",t,"ms")}})}async delete(e){return jA(()=>this.deleteLocked(e))}async deleteLocked(e){let j=Array.isArray(e)?e:[e];if(!j.length)return;await this.whenInitialized();let t=j.map(k=>{let c=this.persistedModules.get(k);return I(c,"Trying to delete an unknown module",k,"It was never persisted."),c}),{modulesService:r}=this;I(r);let o=await Promise.allSettled(t.map(k=>r.delete({moduleId:k.id}))),n=new Set,i=new Set;for(let k of o){if(k.status==="rejected"){x.warn(String(k.reason));continue}n.add(k.value.localId),i.add(k.value.id)}j=j.filter(k=>n.has(k)),t=t.filter(k=>i.has(k.id)),I(j.length>0,"Failed to delete module(s)");let a=this.lastSnapshot.depsGraph;for(let k of t){let c=X(k);a=ut(a,c)}let s=kA(this.persistedModules,k=>{for(let c of j)k.delete(c),this.removeTreeNode(c)}),l=kA(this.transientSaves,k=>{for(let c of j)k.delete(c)});this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:s,transientSaves:l,depsGraph:a,didRemoteChange:!0})}async publish(e,j){return jA(()=>this.publishLocked(e,j))}async publishLocked(e,{namespace:j,name:t,version:r}){await this.whenInitialized();let o=this.persistedModules.get(e);I(o,"Trying to publish an unknown module",e,"It was never persisted."),I(!this.readOnlyTree,"modules storage is read only"),I(this.modulesService);let n=await this.modulesService.publish({moduleId:o.id,saveId:o.saveId,namespace:j,name:t,version:r}),i=kA(this.persistedModules,a=>{let s=a.get(e);s&&a.set(e,{...s,lastPublish:{namespaceId:n.namespaceId,name:n.name,version:n.version,importURL:n.importURL}})});return this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:i,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),n}async addNpmDependencies(e){return jA(async()=>{await this.whenInitialized();let j;this.dependenciesModule?.importMapContent?j=JSON.parse(this.dependenciesModule?.importMapContent):j={imports:{}};let t;this.dependenciesModule?.dependenciesMapContent?t=JSON.parse(this.dependenciesModule?.dependenciesMapContent):t={dependencies:{}};let r=new Set(Object.keys(j.imports).filter(l=>l.endsWith("/"))),o=l=>{let k=l.indexOf("/");for(;k!==-1;){let c=l.slice(0,k+1);if(r.has(c))return!0;k=l.indexOf("/",k+1)}return!1},n=Array.isArray(e)?e:[e];if(n=n.filter(l=>{if(UA.has(l.target)||fe(l.target))return!1;let k=me(l);return!(j.imports?.[k]||o(k))}),n.length===0)return{dependenciesMap:t};n=n.map(l=>{if(t.dependencies[l.target]){let c=j.imports[l.target]??Object.entries(j?.imports).find(([$])=>$.startsWith(l.target))?.[1];if(hA.isOn("importMapPruning")&&!c)return l;I(c,"Import map must contain all dependencies from dependencies map");let d=Ai(c)?.version;return d?{...l,target:`${l.target}@${d}`}:l}let k=lj[l.target];return k?{...l,target:`${l.target}@${k}`}:l});let{importMap:i,resolvedDependencies:a}=await Vo(j,n,UA,lj),s=await this.extendCurrentDependenciesMap(a);return a.forEach(({name:l,version:k})=>PA("npm_dependency_add",{name:l,semver:k})),x.debug({newImportMap:i,newDependenciesMap:s}),await this.updateDependenciesLocked(i,s),{dependenciesMap:s}})}async reinstallNpmDependencies(){return jA(async()=>{let{currentImportMap:e,currentDependenciesMap:j}=this.getCurrentDependencies();delete e.scopes;let{importMap:t}=await Xo(e,UA,lj);return await this.updateDependenciesLocked(t,j),t})}async uninstallBlockedNpmDependencies(){return jA(async()=>{let{currentImportMap:e,currentDependenciesMap:j}=this.getCurrentDependencies(),t=Cr(j),r=await Wo(e);return await this.updateDependenciesLocked(r,t),r})}async clearNpmDependencies(){return jA(async()=>this.updateDependenciesLocked({imports:{}},{dependencies:{}}))}async removeBlockedNpmDependencies(){return jA(async()=>{let{currentImportMap:e,currentDependenciesMap:j}=this.getCurrentDependencies(),t=Cr(j);return await this.updateDependenciesLocked(e,j),t})}async rebuildImportMapFromDependencies(){return jA(async()=>{let e=this.dependenciesModule?.dependenciesMapContent,j=e?JSON.parse(e):{dependencies:{}},t=await Zo(j,UA,lj);return await this.updateDependenciesLocked(t,j),t})}getLocalModuleBareImports(){let e=new Set;for(let j of this.persistedModules.values())for(let t of j.imports.bare)e.add(t);return e}getComposedImportMap(){let e=ji();if(this.dependenciesModule?.importMapContent){let r=JSON.parse(this.dependenciesModule.importMapContent);e=Rj(e,r,"source-wins")}let j=this.getLocalModuleBareImports();e.imports=Object.fromEntries(Object.entries(e.imports).filter(([r])=>j.has(r)));let t=this.createLocalModuleImportMap();return e=Rj(e,t,"source-wins"),e}createLocalModuleImportMap(){let e={};for(let j of this.persistedModules.values()){let t=j;if(GA(t.files.module)){let r=Nj(t.localId,t.files.module);e[r]=t.moduleURL}}return{imports:e}}async rebuildImportMapFromEntryPoints(e,j,t){return jA(async()=>{let r=j??this.getComposedImportMap(),o=await st(e,UA,lj,r),n=this.dependenciesModule?.dependenciesMapContent,i=n?JSON.parse(n):{dependencies:{}},a=Object.fromEntries(Object.entries(o.imports??{}).filter(([B])=>!UA.has(B)&&!gr(B))),s=new Set([...this.persistedModules.values()].map(B=>B.baseURL)),l={},k=[];for(let B in o.scopes){let u=o.scopes[B];if(!u)continue;let E=Object.fromEntries(Object.entries(u).filter(([f])=>!(UA.has(f)||gr(f)||Vn(f)||B==="https://ga.jspm.io/"&&(f==="fs"||f==="process"))));Object.keys(E).length>0&&(s.has(B)?Object.assign(l,E):k.push([B,E]))}let c={imports:a,...k.length>0?{scopes:Object.fromEntries(k)}:{}};c.imports=Object.assign(c.imports,l);let d=new Set(Object.keys(c.imports??{})),$={dependencies:Object.fromEntries(Object.entries(i.dependencies??{}).filter(([B])=>d.has(B)))};return t?(x.info("Dry run import map",c),x.info("Dry run dependencies map",$)):await this.updateDependenciesLocked(c,$),c})}async unsafeUpgradeDependency(e,j,t){return jA(async()=>{let{currentImportMap:r,currentDependenciesMap:o}=this.getCurrentDependencies(),n=await Yo(r,e,j,t),i=Re(n),a=Ge(i,o);return await this.updateDependenciesLocked(n,a),n})}async extendCurrentImportMap(e,j){return jA(async()=>{let{currentImportMap:t,currentDependenciesMap:r}=this.getCurrentDependencies(),o=Rj(t,e),n=Ge(r,j);return this.updateDependenciesLocked(o,n)})}async extendCurrentDependenciesMap(e){let j={};for(let r of e)j[r.name]=r.version;let t=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return t.dependencies=Object.assign(j,t.dependencies),t}getCurrentDependencies(){let e=this.dependenciesModule?.importMapContent?JSON.parse(this.dependenciesModule?.importMapContent):{imports:{}},j=this.dependenciesModule?.dependenciesMapContent?JSON.parse(this.dependenciesModule?.dependenciesMapContent):{dependencies:{}};return{currentImportMap:e,currentDependenciesMap:j}}async updateDependenciesLocked(e,j){let t=JSON.stringify(e,null,4),r=JSON.stringify(j,null,4);if(t===this.dependenciesModule?.importMapContent&&r===this.dependenciesModule?.dependenciesMapContent)return;let o={moduleId:"$upsertName",name:br,saveId:dj(),type:"config",files:[{name:"importMap.json",type:"importMap",content:t},{name:"dependencies.json",type:"dependencies",content:r}],imports:{absolute:[],relative:[],bare:[]},detached:this.detached};I(!this.readOnlyTree,"modules storage is read only"),I(this.modulesService);let{data:[n]}=await this.modulesService.saveBatch({batch:[o]});I(n,"Modules API must return an updated import map after savebatch"),this.updateTreeNodeWithOwnTreeVersion(jj,n);let i={kind:"dependencies",importMapContent:t,dependenciesMapContent:r,...n,id:n.id,localId:n.localId,type:n.type,name:n.name};this.setNextInternalState({dependenciesModule:i,persistedModules:this.persistedModules,transientSaves:this.transientSaves,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})}getPersistedDependenciesModule(){return this.dependenciesModule}getPersistedModuleByGlobalId(e){for(let j of this.persistedModules.values())if(j.id===e)return j}getPersistedModuleByLocalId(e){return this.persistedModules.get(e)}getTransientSaveByLocalId(e){return this.transientSaves.get(e)}async handleRemoteModuleDeleteEvents(e){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleDeletes(e.map(j=>j.id))}async handleRemoteModuleDeletes(e){await jA(async()=>{let j=[],t=[];for(let i of e){let a=this.getPersistedModuleByGlobalId(i);a&&(t.push(X(a)),j.push(a.localId))}let r=kA(this.persistedModules,i=>{for(let a of j)i.delete(a)}),o=kA(this.transientSaves,i=>{for(let a of j)i.delete(a)}),n=this.lastSnapshot.depsGraph;for(let i of t)n=ut(n,i);this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:r,transientSaves:o,depsGraph:n,didRemoteChange:!0})})}async handleRemoteModuleSaveEvents(e){if(!this.useTreeAsLocalModuleList)return this.handleRemoteModuleSaves(e.map(j=>j.module))}async handleRemoteModuleSaves(e){let j=[],t=[];for(let n of e)X(n)===jj?j.push(n):t.push(n);let r,o=j.length>0?j[j.length-1]:void 0;if(o){let{importMapContent:n,dependenciesMapContent:i}=await this.getDependenciesFiles(o);I(i,"No dependencies file exists for the remote update!"),r={kind:"dependencies",...o,id:o.id,localId:o.localId,type:"config",name:o.name,importMapContent:n,dependenciesMapContent:i}}await jA(async()=>{r&&(this.dependenciesModule=r);let n=this.persistedModules,i=this.lastSnapshot.depsGraph,a=await Promise.all(t.map(s=>this.createServerModuleFromData(s)));for(let s of a){let l=X(s),k=s.localId;n=kA(n,c=>{c.set(k,s)}),this.transientSaves.has(k)||(i=Vj(this.lastSnapshot.depsGraph,l,s.imports.relative))}this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:n,transientSaves:this.transientSaves,depsGraph:i,didRemoteChange:!0,multiplayerChange:!0})})}getPatchTransientSave(e,j,t){return{saveId:t,type:j.type,name:j.name,localId:e,moduleContent:j.moduleContent,sourceContent:j.sourceContent,sourceMapContent:j.sourceMapContent,submoduleContents:j.submoduleContents,binaryAssetContents:j.binaryAssetContents,imports:j.imports,exports:j.exports,reExportedModules:j.reExportedModules,sourceRevision:j.sourceRevision,update:j.update}}async upsertBatchLocked(e){if(this.readOnlyTree)return;let j=this.persistedModules,t=new Map,r=[],o=new Map;for(let k of j.values()){let c=X(k);o.set(c,k.localId),r.push([c,k.imports.relative])}let n=new Map;for(let k in e){let c=k,d=e[c];I(d,"No persist params found for",c);let $=this.transientSaves.get(c),B=$??j.get(c);I(B,"No module found for",c);let u=X(B);n.set(u,$?.saveId??dj()),t.set(u,MA(d.name)),o.set(u,c),$&&r.push([u,$.imports.relative])}let i=Nr(r),a=new Map,s=kA(this.transientSaves,k=>{for(let c in e)k.delete(c)}),l;try{let{batch:k,nextPersistedModules:c}=await this.createBatch(e,a,j,i,o,n,t);I(!this.readOnlyTree,"modules storage is read only"),I(this.modulesService);let{data:d}=await this.modulesService.saveBatch({batch:k});j=kA(c,$=>{for(let B of d.values()){let u=B.localId,E=a.get(u);if(!E){let v=$.get(u);I(v,u,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(u,B),v.saveId=B.saveId,v.moduleURL=B.baseURL+B.files.module;continue}let f={kind:"local",...B,id:B.id,localId:B.localId,imports:E.imports,moduleURL:B.baseURL+B.files.module,sourceContent:E.sourceContent,sourceMapContent:E.sourceMapContent,moduleContent:E.moduleContent,submoduleContents:E.submoduleContents,binaryAssetContents:E.binaryAssetContents,sourceRevision:E.sourceRevision,annotations:E.annotations,update:E.update},F=e[u]?.errors,g=E.kitSectionsStructure,b=E.treeVersion??this.treeStore.remoteTreeVersion;if(!this.updateTreeNode(B.localId,b,f,F,g))return;$.set(u,f)}})}catch(k){j=this.persistedModules;let c=Array.from(a.values()).map(u=>u.saveId).join("-"),d=this.transientSaveRetries.get(c)??0,{error:$,dropTransient:B}=this.handlePersistenceError(k,d,()=>{this.transientSaveRetries.set(c,d+1),setTimeout(async()=>{let u=Object.entries(a).every(([E,f])=>{let F=E,g=this.transientSaves.get(F);return g&&g.saveId===f.saveId});Ft($)&&(this.transientSaveRelativeImportRetries.add(c),await this.refresh()),u&&(x.debug("retrying saving batchId with id:",c),this.upsertBatchLocked(e))},1e3+d*1e3)});if(!B)return;l=$}if(this.setNextInternalState({dependenciesModule:this.dependenciesModule,persistedModules:j,transientSaves:s,depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0}),l)throw l}async createBatch(e,j,t,r,o,n,i){let a=[];for(let c in e){let d=c,$=e[d];I($,"No persist params found for",d);let B=this.transientSaves.get(d);if(!B){let E=t.get(d);I(E,`Trying to persist ${d} but it doesn't have neither a corresponding transient save nor an existing persisted module.`),E.kind==="server"&&(E=await this.createLocalModuleFromModule(E),t=kA(t,F=>{E&&F.set(E.localId,E)}));let f=n.get(d);I(f,"No save id found for",d),B=this.getPatchTransientSave(d,E,f)}j.set(d,B);let u=await this.createBatchSaveForUpdatedModule(this.persistedModules.get(d)?.id??"$upsertName",B,t,n,i,$);a.push(u)}let s=new Map;for(let c in e){let d=c,$=e[d];I($,"No persist params found for",d);let B=X($),u=new Set;hj(r,B,u),s.set(d,u)}let l=[];for(let c of s.values())for(let d of c){let $=o.get(d);I($,"Cannot find localId for",d);let B=t.get($);B?.kind==="server"&&l.push(this.createLocalModuleFromModule(B))}if(l.length>0){let c=await Promise.all(l);t=kA(t,d=>{for(let $ of c)d.set($.localId,$)})}for(let c of s.values())for(let d of c)n.has(d)||n.set(d,dj());let k=new Set;for(let[c,d]of s){let[$]=lt(c);for(let B of d){let u=o.get(B);if(I(u,"Cannot find localId for",B),j.has(u)||k.has(B)||t.get(u)?.metadata.localModuleImportMapEntries===!0&&this.moduleUsesLocalImportMapSpecifiers(B)&&($!=="codeFile"||!r[B]?.dependencies.has(c)))continue;k.add(B);let F=await this.createBatchSaveForDependentModule(u,t,n,i);a.push(F)}}return{batch:a,nextPersistedModules:t}}handlePersistenceError(e,j,t){let r=e instanceof Error?e.message:"",o=e instanceof _r?e.code:0,n=e instanceof _r?e.status:0,i=o===1002,a=o===-1e3,s=n>=300&&n!==400&&n!==403,l=a||s||Ft(e),k=20,c=2;if(Ft(e))return!l||j>=c?(x.reportError("Relative imports error, exceeded max retries, making document read only:",{missing:e.persistedMissingRelativeImports}),this.makeDocumentReadOnly(),BA({type:"add",variant:"warning",primaryText:"Cannot save changes.",secondaryText:"Please reload.",key:"client-outdated",duration:Number.POSITIVE_INFINITY,icon:"warning",showCloseButton:"never",action:{title:"Reload",onClick:()=>{x.reportError("ModulesStorage: Reloaded due to relative imports error.",{missing:e.persistedMissingRelativeImports}),window.top.location.reload()}}}),{error:e,dropTransient:!0}):(x.debug("Relative imports error, will retry:",{missing:e.persistedMissingRelativeImports}),t(),{error:e,dropTransient:!1});if(i&&j>0)x.debug("Ignoring duplicated save id.");else{if(i)return x.debug("Duplicate save id error, will drop transient save:",e),{error:e,dropTransient:!0};if(l&&j<k)return x.info("Connection error, will retry:",{message:r,code:o,status:n,retryCount:j}),t(),{dropTransient:!1};if(l)x.error("Error saving: too many retries, will drop transient save:",{message:r,code:o,status:n,retryCount:j});else return x.debug("Error saving, will drop transient save:",e),{error:e,dropTransient:!0}}return{dropTransient:!1}}moduleUsesLocalImportMapSpecifiers(e){let[j,t]=lt(e);if(j==="layoutTemplate")return!0;if(j==="collection")return hA.isOn("collectionLocalModuleImportMapEntries");if(j==="screen"){let r=this.treeStore.tree.get(t);if(ro(r)||SA(r))return!0}return!1}processTransientSaveData({nextPersistedModules:e,transientSave:j,data:t},r,o){let n=j.treeVersion??this.treeStore.remoteTreeVersion,i;return e=kA(e,a=>{let s=t.values(),l=s.next().value;i=l.localId;let k={kind:"local",...l,id:l.id,localId:i,imports:j.imports,moduleURL:l.baseURL+l.files.module,sourceContent:j.sourceContent,sourceMapContent:j.sourceMapContent,moduleContent:j.moduleContent,submoduleContents:j.submoduleContents,binaryAssetContents:j.binaryAssetContents,sourceRevision:j.sourceRevision,annotations:j.annotations,update:j.update};if(this.updateTreeNode(l.localId,n,k,r,o)){a.set(i,k);for(let d of s){let $=a.get(d.localId);I($,d.localId,"is not in persistedModules"),this.updateTreeNodeWithOwnTreeVersion(d.localId,d),$.saveId=d.saveId,$.moduleURL=d.baseURL+d.files.module}}}),I(i,"Updated module",j,"is not found in the response"),{nextPersistedModules:e,updatedModuleLocalId:i}}setNextInternalState({dependenciesModule:e,persistedModules:j,transientSaves:t,depsGraph:r,didRemoteChange:o,multiplayerChange:n=!1}){this.dependenciesModule=e,this.persistedModules=j,this.transientSaves=t;let i=Ja(e,this.lastSnapshot.dependenciesModule,j,t,r,this.lastSnapshot.modules,this.initialized,o,n),a=this.lastSnapshot.initialized;this.lastSnapshot={dependenciesModule:i.dependenciesModule,modules:i.modules,depsGraph:i.depsGraph,initialized:i.initialized},!(i.metadata.patches.length===0&&i.initialized===a)&&this.notifyListeners(i)}async createLocalModuleFromModule(e){x.debug("compiling server module:",e.localId);let j=e.sourceContent;j||(j=await this.fetchSourceContentFromData(e));let t={},r={},o=this.downloadQueue,n=new Array;for(let s of e.submodules)n.push(o.run(async()=>{let l=await fetch(e.baseURL+s);t[s]=await l.text()}));for(let s of e.binaryAssets)n.push(o.run(async()=>{let k=await(await fetch(e.baseURL+s)).arrayBuffer();r[s]=new Uint8Array(k)}));await Promise.all(n);let i=X(e),a=await this.compile({localId:e.localId,name:i,source:j,type:e.type,includeSourceMap:n6(e.type)});for(let[s,l]of this.lazyServerModulesForTransientSaves)l.delete(i),l.size===0&&this.lazyServerModulesForTransientSaves.delete(s);return{...e,kind:"local",id:e.id,localId:e.localId,sourceContent:j,moduleContent:a.code,sourceMapContent:a.sourceMap,submoduleContents:t,binaryAssetContents:r,imports:a.imports,sourceRevision:k6(e),annotations:a.annotations}}async createBatchSaveForUpdatedModule(e,j,t,r,o,n){let i=X(j),{localId:a,moduleContent:s,sourceContent:l,sourceMapContent:k,submoduleContents:c={},binaryAssetContents:d={},metadata:$,sourceRevision:B,imports:u,type:E,name:f,annotations:F,update:g,...b}=j;switch(e){case"$new":I(a===void 0,`Attempted to create ${i} but it already has localId: ${a}`);break;case"$upsertName":default:I(a!==void 0,`The transient save for the provided moduleId: ${e} doesn't have localId`)}let{type:G,name:v,metadata:N,files:C,...R}=n;I(G===E&&v===f,`Mismatched type/name between save and parameters: ${G}/${v} !== ${E}/${f}`);let K=MA(v),w=s;u.relative.length>0&&(w=await this.replaceRelativeImportsWithAbsolute(i,s,u.relative,t,r,Or(c),o)),k&&(w+=`
//# sourceMappingURL=./${K.sourceMap}`);let y=(C??[]).concat([{name:K.module,type:"module",content:w},{name:K.source,type:"source",content:l}]);k&&y.push({name:K.sourceMap,type:"sourceMap",content:k});for(let[P,H]of Object.entries(c))y.push({name:P,type:"submodule",content:H});for(let[P,H]of Object.entries(d))y.push({name:P,type:"binaryAsset",bytes:H});let S={};if($||N)if(a){let P=t.get(a);I(P||e==="$upsertName",`Cannot safely update metadata for ${e} (${a})`),S.metadata={...P?.metadata,...$,...N,sourceRevision:B}}else S.metadata={...$,...N,sourceRevision:B};return{...b,moduleId:e,type:G,name:v,files:y,imports:u,detached:this.detached,...R,...S}}async createBatchSaveForDependentModule(e,j,t,r){let o=j.get(e);I(o,e,"is not found in persistedModules"),I(o.kind==="local","persisted module is not a local module");let n=X(o),i=MA(o.name),a=o.imports,s=o.moduleContent;a.relative.length>0&&(s=await this.replaceRelativeImportsWithAbsolute(n,o.moduleContent,a.relative,j,t,Or(o.submoduleContents),r));let l=t.get(n);I(l,"newSaveIds don't contain saveId for",n);let k={},c=this.moduleUsesLocalImportMapSpecifiers(n);return o.metadata.localModuleImportMapEntries!==c&&(k.metadata={...o.metadata,localModuleImportMapEntries:c}),{type:o.type,moduleId:o.id,name:o.name,saveId:l,patchSaveId:o.saveId,files:[{name:i.module,type:"module",content:s}],imports:a,detached:this.detached,...k}}findPersistedModuleLocalIdByTypeSlashName(e,j){return this.ensurePersistedLocalIdsByTypeSlashNameCacheFor(e).get(j)}ensurePersistedLocalIdsByTypeSlashNameCacheFor(e){let j=this.persistedLocalIdsByTypeSlashNameCache.get(e);return j||(j=za(e),this.persistedLocalIdsByTypeSlashNameCache.set(e,j)),j}async replaceRelativeImportsWithAbsolute(e,j,t,r,o,n,i){let{modulesCDN:a}=Ir(),s={};for(let B of n){let u=Ci(B);s[u]=u}let l=this.moduleUsesLocalImportMapSpecifiers(e),k=new Set;for(let B of t){if(B in s)continue;let u=Fj(B,e);if(!u)continue;let E=this.findPersistedModuleLocalIdByTypeSlashName(r,u);if(!E){k.add(u),x.error("Cannot resolve",B,"from",e);continue}let f=r.get(E);I(f);let{id:F,files:g}=f,b=o.get(u)??f.saveId,G=i?.get(u)?.module??g.module;I(GA(G),"Must have a module file name to build a local module import map specifier."),s[B]=l?Nj(E,G):`${a}/${F}/${b}/${G}`}let c=await It(j,s);if(c.ok)return c.value;if(e.startsWith("codeFile"))return c.error.partiallyProcessedCode;let d=new Set,$=this.treeStore.tree;for(let B of c.error.unresolvedRelativeImports){let u=Fj(B,e);if(!u)continue;let[E]=lt(u);if(!(E==="codeFile"||!$.getNodeWithTrait(u,wr))){d.add(u);break}}if(d.size===0)return x.reportError("Failed to rewrite relative imports due to unpersisted relative dependencies",{relativeImports:t,unresolved:Array.from(c.error.unresolvedRelativeImports)}),c.error.partiallyProcessedCode;throw x.reportError("Failed to rewrite relative imports",{typeSlashName:e,missing:Array.from(d)}),new Ce(d)}async getDependenciesFiles({baseURL:e,files:j}){let[t,r]=await Promise.allSettled([this.downloadQueue.run(async()=>{let i=await fetch(e+j.importMap);if(i.ok!==!0)throw new Error("failed to load importMap file");return i.text()}),this.downloadQueue.run(async()=>{let i=await fetch(e+j.dependencies);if(i.ok!==!0)throw new Error("failed to load dependencies file");return i.text()})]);I(t.status==="fulfilled","The importMap has to exist on the module");let o=t.value,n;return r.status==="fulfilled"?n=r.value:x.warn("No dependencies file was found!"),{importMapContent:o,dependenciesMapContent:n}}async upsertKit(e,j,t,r,o){return jA(async()=>{let n=JSON.stringify(e),i=[{name:"kit.json",type:"source",content:n},...t.map(c=>({name:`${c.id}.json`,type:"kitSection",content:JSON.stringify(c.content)})),...r.map(c=>({name:`${c.id}.json`,type:"kitVectorSetNames",content:JSON.stringify(c.content)}))],a=performance.now(),s="kit/kit",l={type:"kit",files:i,assets:o.size>0?Array.from(o):void 0,name:Tk,moduleId:this.persistedModules.get(s)?.id??"$upsertName",saveId:dj(),metadata:{kit:{id:e.id,title:e.title,icon:j}},imports:{absolute:[],relative:[],bare:[]},detached:!1};I(this.modulesService);let{data:k}=await this.modulesService.saveBatch({batch:[l]});this.setNextInternalState({dependenciesModule:this.dependenciesModule,transientSaves:this.transientSaves,persistedModules:kA(this.persistedModules,c=>{for(let d of k.values()){if(d.localId!==s)continue;let $={kind:"local",...d,id:d.id,localId:d.localId,imports:d.imports,moduleURL:d.baseURL+d.files.source,sourceContent:n,sourceMapContent:void 0,moduleContent:n,submoduleContents:{},binaryAssetContents:{},sourceRevision:void 0,annotations:void 0,update:a};c.set(s,$)}}),depsGraph:this.lastSnapshot.depsGraph,didRemoteChange:!0})})}async enqueueKitScreenshots(e,j,t){let r=this.persistedModules.get(hr("kit","kit"));I(r,"Kit module must have been persisted to enqueue screenshots");let o=t?"draft":r.saveId;I(o,"Kit Save ID must be set"),I(this.modulesService),await this.modulesService.enqueueKitScreenshots({moduleId:r.id,saveId:o,ids:Array.from(j),kitPageContent:e})}takeSnapshot(){return new a6(this.persistedModules)}};function Nk(A,e){return`${Ir().modulesCDN}/${e.id}/${A.saveId}/${e.files.module}`}function Ja(A,e,j,t,r,o,n,i,a){let s=new Set(o.keys()),l=new Set(t.keys()),k=[],[c,d]=Bt(o,u=>{for(let E of j.values()){let f=E.localId,F=X(E),g=t.get(f),b=g?.type??E.type;if(!ri(b))continue;let G;if(g)G={kind:"local",localId:f,type:g.type,name:g.name,moduleURL:Nk(g,E),moduleContent:g.moduleContent,sourceContent:g.sourceContent,sourceMapContent:g.sourceMapContent,submoduleContents:g.submoduleContents,binaryAssetContents:g.binaryAssetContents,relativeImports:g.imports.relative,files:E.files,sourceRevision:g.sourceRevision,svgIcon:g.svgIcon,update:g.update};else{let v=k6(E);G=E.kind==="local"?{kind:"local",localId:f,type:E.type,name:E.name,moduleURL:E.moduleURL,moduleContent:E.moduleContent,sourceContent:E.sourceContent,sourceMapContent:E.sourceMapContent,submoduleContents:E.submoduleContents,binaryAssetContents:E.binaryAssetContents,relativeImports:E.imports.relative,files:E.files,sourceRevision:v,svgIcon:void 0,update:E.update}:{kind:"server",localId:f,type:E.type,name:E.name,moduleURL:E.moduleURL,sourceContent:E.sourceContent,relativeImports:E.imports.relative,files:E.files,sourceRevision:v,update:E.update}}Ha(u,F,G),l.delete(f),s.delete(F)}for(let E of l){let f=t.get(E);if(I(f),!f.localId)continue;let F=MA(f.name),g={kind:"local",localId:f.localId,type:f.type,name:f.name,moduleURL:`./transient/${f.saveId}/${F.module}`,moduleContent:f.moduleContent,sourceContent:f.sourceContent,sourceMapContent:f.sourceMapContent,submoduleContents:f.submoduleContents,binaryAssetContents:f.binaryAssetContents,relativeImports:f.imports.relative,files:F,sourceRevision:f.sourceRevision,svgIcon:f.svgIcon,update:f.update};Ha(u,E,g),s.delete(X(g))}for(let E of s)u.delete(E),k.push(E)}),$={};for(let u of k){let E=o.get(u);E&&($[u]=E.localId)}let B=kA(e,u=>{if(A){if(!u)return{kind:"dependencies",localId:jj,type:A.type,name:A.name,importMapContent:A.importMapContent,dependenciesMapContent:A.dependenciesMapContent};u.importMapContent=A.importMapContent,u.dependenciesMapContent=A.dependenciesMapContent}});return B&&B!==e&&d.push({op:e?"replace":"add",path:[X(B)],value:B}),{dependenciesModule:B,modules:c,deletedLocalIdsByTypeSlashNames:$,depsGraph:r,initialized:n,metadata:{patches:d,hasLocalChanges:t.size>0,didRemoteChange:i,multiplayerChange:a}}}function Ha(A,e,j){let t=A.get(e);if(!t){A.set(e,j);return}if(t.kind!==j.kind){A.set(e,j);return}if(t.kind==="server"){I(j.kind==="server"),Qa(t,j);return}I(j.kind==="local"),Kk(t.relativeImports,j.relativeImports)||(t.relativeImports=j.relativeImports),oo(t.files,j.files)||(t.files=j.files);let{relativeImports:r,files:o,...n}=j;Qa(t,n)}function Qa(A,e){Object.assign(A,e)}function Kk(A,e){if(!A&&!e)return!0;if(A&&e){let j=A.length;if(j!==e.length)return!1;for(let t=0;t<j;t++)if(A[t]!==e[t])return!1;return!0}else return!1}function Lk(A){return A.type==="save"}function Jk(A){return A.type==="delete"}function dj(){return Ie()}function n6(A){return A==="codeFile"||A==="canvasComponent"||A==="shader"}function Ua(A,e,j){return A.replace(new RegExp(`\\b(from\\s*)(["'])${t6(e)}\\2`,"g"),`$1${JSON.stringify(j)}`)}function Hk(A,e){switch(A){case"canvasComponent":case"layoutTemplate":case"screen":case"prototype":case"collection":case"draftCollection":case"webPageMetadata":case"siteMetadata":case"snippets":case"vector":case"vectorSet":case"kit":case"shader":return e.default;case"codeFile":case"css":case"componentPresets":case"config":case"localization":case"design":return Object.values(e)[0];default:fj(A)}}var Va={start:new Date("2025-09-03T10:00:00Z").getTime(),end:new Date("2025-09-07T13:00:00Z").getTime()};function Qk(A,e){for(let j of A){if(j.id!==e.localId)continue;if(j.save.saveId===e.saveId)return!1;let t=new Date(e.savedAt).getTime();return Number.isNaN(t)?!1:t>Va.start&&t<Va.end}return!1}function za(A){let e=new Map;for(let[j,t]of A.entries())e.set(X(t),j);return e}var a6=class{constructor(e){this.persistedModules=e;T(this,"persistedLocalIdsByTypeSlashName");this.persistedLocalIdsByTypeSlashName=za(e)}getPersistedModuleByLocalId(e){return this.persistedModules.get(e)}getModuleWithTypeSlashName(e){let j=this.persistedLocalIdsByTypeSlashName.get(e);if(j)return this.persistedModules.get(j)}};function Wa(A,e){if(!A||A.length===0)return e?.placeholder??"";if(A.length===1)return A[0]&&A[0]!==""?A[0]:e?.placeholder??"";let j=[...A],t="";if(e?.max&&e.max<A.length){let r=A.length-e.max;j=j.slice(0,e.max),t=`${r} ${r>1?"others":"other"}`}else t=j.pop()??"";return j.length>1?`${j.join(", ")}, and ${t}`:`${j.join(", ")} and ${t}`}function De(A){let e=AA(A);if(!(!e||!JA(e)||!Aj(e)))return`${e.moduleId}:${e.exportSpecifier}`}function Za(A){let e=new Map;for(let j of A){let t=De(j);t&&e.set(t,j)}return e}function As(A,e){let j=A.getRawControlProps();for(let t in j){let r=j[t]?.type,o=j[t]?.value;if(r!=="vectorsetitem"||!GA(o)||!JA(o))continue;let n=De(o);if(!n||!e.has(n))continue;let i=e.get(n);i&&A.setControlProp(t,{type:"vectorsetitem",value:i})}}function js(A,e){for(let j of e){As(j,A);let t=De(j.codeComponentIdentifier);if(!t||!A.has(t))continue;let r=A.get(t);r&&j.set({codeComponentIdentifier:r})}}function es(A,e){let j=No(e);if(j){I(j.isLoaded(),"CMS Should always be loaded.");for(let{node:t,skipChildren:r}of j.walkWithSkipChildren()){if(Lj(t)){if(!t.variables.some(i=>i.type==="vectorsetitem")){r();continue}ts(t,A)}if(!Gj(t))continue;let o=t.getControlProps();for(let n in o){let i=o[n]?.value;if(o[n]?.type!=="vectorsetitem"||!GA(i)||!JA(i))continue;let s=De(i);if(!s||!A.has(s))continue;let l=A.get(s);l&&t.setControlProp(n,{...o[n],value:l})}}}}function ts(A,e){let j=!1,t=A.variables.map(r=>{if(r.type!=="vectorsetitem")return r;let{initialValue:o}=r,n=o.identifier;if(!n)return r;let i=De(n);if(!i||!e.has(i))return r;let a=e.get(i);return a?(j=!0,{...r,initialValue:{...o,identifier:a}}):r});j&&A.set({variables:t})}function rs(A,e){for(let j of e.root.children){if(SA(j)){As(j,A);continue}(Kj(j)||co(j))&&ts(j,A)}}var mA=LA("modules-store"),ns=new Set(["codeFile","canvasComponent","screen","layoutTemplate","vector"]),Vk=500;function yt(A){let{module:e,exportSpecifier:j}=A,{id:t,saveId:r,files:o}=e;return I(o.module,"module file must exist for a saved module"),sj(t,r,o.module,j)}var Yj,we,qe,$j,_j,yj,os=class extends Qo{constructor(j,t,r,o,n,i,a,s){super();this.componentLoader=j;this.treeStore=t;this.loadedExternalModulesStore=r;this.chromeStore=o;this.modulesAPIServicePromise=n;this.makeDocumentReadOnly=i;this.insertTemporaryImportMap=a;this.loadAllLocalModules=s;T(this,"dependenciesModule");T(this,"localModules",new Map);T(this,"fastRefreshModules",new Map);T(this,"externalModulesDynamicInfo",new Map);T(this,"revision",0);KA(this,Yj,new Map);T(this,"moduleDepsGraph",{});T(this,"modulesStorage");T(this,"moduleUpdatesEmitter",new yr);T(this,"fastRefreshModulesEmitter",new yr);KA(this,we);KA(this,qe,new Map);KA(this,$j,new Map);KA(this,_j,!1);KA(this,yj,[]);T(this,"debugModuleStoreAndComponentLoaderRevisionsMatch",()=>this.revision===this.componentLoader.modulesRevision);T(this,"checkForExternalModuleUpdates",async()=>{if(this.treeStore.tree.isViewOnly)return;let j=Fe.get(this.treeStore.tree);if(!j||!j.children?.length)return;let t=[],r=new Map;j.children.forEach(a=>{let s=AA(a.codeComponentIdentifier);if(I(s?.kind==="externalModuleExport","expected ExternalModuleNode identifier to be of kind externalModuleExport"),a.type==="vector"){let l=a.annotation("framerVector");if(!Qj(l))return;let k=l.set.moduleId,c=r.get(k)??[];c.push(s),r.set(k,c)}else t.push(s)});for(let[a,s]of r){let l=this.treeStore.tree.get(a);if(!QA(l))continue;let k=l.annotation("framerVectorSet");pe(k)&&(Lo(k)||t.push(...s))}let o=t.map(({moduleId:a,saveId:s})=>({moduleId:a,saveId:s}));if(!o.length)return;let n=[],i=[];for(let a=0;a<o.length;a++){let s=o[a];if(I(s,"query is expected to be defined."),n.push(s),n.length<Vk&&a<o.length-1)continue;let{modules:l}=await this.lookUpModules(n,{includeStatus:!0});i.push(...l),n=[]}this.treeStore.tree.isViewOnly||this.updateExternalModuleNodes(i.map((a,s)=>{let l=t[s];return I(l,"External module missing a matching identifier"),{module:a,exportSpecifier:l.exportSpecifier}}),{onTreeUpdate(){}}).catch(EA)});T(this,"updatesPollId");T(this,"compileFastRefreshModule",async({localId:j,name:t,source:r,includeSourceMap:o=!0})=>{let{type:n,name:i}=rt(j);if(!ns.has(n))return;let a=n==="codeFile"?MA(t).source:i,{code:s,imports:l,sourceMap:k}=await Ea({localId:j,source:r,name:a,includeSourceMap:o}),c={kind:"fast-refresh",localId:j,type:n,name:a,sourceContent:r,moduleContent:s,relativeImports:l.relative,sourceMapContent:k,binaryAssetContents:void 0,submoduleContents:{},update:0},[d,$]=Bt(this.fastRefreshModules,B=>{B.set(t,c)});this.fastRefreshModules=d,this.fastRefreshModulesEmitter.emit({patches:$,dependentModules:[],prioritizedModules:[],revision:++this.revision,initialized:!0})});T(this,"compile",({localId:j,name:t,source:r,includeSourceMap:o=!0,type:n,telemetrySession:i})=>{let a=Ba({name:t,source:r,includeSourceMap:o,type:n,telemetrySession:i});return this.fastRefreshEnabled&&j&&this.compileFastRefreshModule({localId:j,name:t,source:r,includeSourceMap:o}).catch(EA),a});this.modulesStorage=new _t(()=>this.modulesAPIServicePromise.catch(l=>{throw mA.error(l,{context:"Failed to discover ModulesAPI service:"}),l}),this.compile,l=>this.scheduler.process(l),l=>this.scheduler.processWhenReady(l),l=>this.scheduler.runWhenIdle(l),t,()=>this.getActiveScope(),()=>this.makeDocumentReadOnly()),this.fastRefreshModulesEmitter.onNewStream=l=>(mA.debug("onNewStream - fast refresh",l),{latest:this.getAllModulesAsUpdateEvent(!0)}),this.moduleUpdatesEmitter.onNewStream=l=>(mA.debug("onNewStream - module updates",l),{latest:this.getAllModulesAsUpdateEvent(!1)}),Xi(()=>Yn.isTest||this.treeStore.tree.isViewOnly||!hA.isOn("importMapPruning")?!1:nA(this,_j)||nA(this,yj).length>0?(mA.debug("Showing Unsaved Changes dialog (import map queue processing)"),!0):!1),this.modulesStorage.subscribe(l=>{let k=l.dependenciesModule?.importMapContent,c=this.dependenciesModule?.importMapContent,d=!1,$=!1,B=!1,u=!1;if(k&&c&&k!==c){let C=JSON.parse(k),R=c?JSON.parse(c):void 0;for(let K in C.imports){let w=C.imports[K];nA(this,Yj).set(K,"success");let y=R?.imports?.[K];if(!y){d=!0;continue}y!==w&&($=!0)}B=!$&&!d,u=l.metadata.multiplayerChange||$||B}u&&l.metadata.multiplayerChange,this.dependenciesModule=l.dependenciesModule,this.localModules=l.modules;let E=this.moduleDepsGraph;this.moduleDepsGraph=l.depsGraph;let f=l.metadata.patches,F=new Set,g=[],b=[],G;for(let C of f){let R=C.path[0];if(I(typeof R=="string"),R===jj){G=C;for(let K of l.modules.keys())F.add(K);break}C.op==="remove"&&C.path.length===1?b.push(R):g.push(R)}let v=new Set;if(!G){let C=this.getActiveScope(),R=xe(C);mA.debug("Calculated visible code component module typeSlashNames",R);for(let K of g)hj(l.depsGraph,K,F,R,v);for(let K of b)hj(E,K,F,R,v);g.forEach(K=>{F.delete(K)}),b.forEach(K=>{F.delete(K),v.delete(K)})}mA.debug("prioritized evaluation sending to sandbox",{dependentModules:F,visibleDependentModules:v},"highprio size",v.size,"dep size",F.size);let N={patches:f,dependentModules:Array.from(F),prioritizedModules:Array.from(v),revision:++this.revision,initialized:l.initialized};this.moduleUpdatesEmitter.emit(N),this.fastRefreshEnabled&&G&&this.fastRefreshModulesEmitter.emit({patches:[G],dependentModules:[],prioritizedModules:[],revision:N.revision,initialized:l.initialized})})}getActiveScope(){if(this.chromeStore.mainView===5)return;let j=this.treeStore.tree.getNode(nA(this,we));if(j)return I(j?.loaded,"Active scope node should be loaded"),j.loaded}setActiveScope(j){et(this,we,j)}getLatestDependencyGraph(){return this.moduleDepsGraph}initialize(){return this.initialized?this.modulesStorage.refresh():(this.setupPollingExternalModulesUpdates(),this.modulesStorage.initialize())}get initialized(){return this.modulesStorage.initialized}whenInitialized(){return this.modulesStorage.whenInitialized()}whenIdle(){return this.modulesStorage.whenIdle()}refresh(){return this.modulesStorage.refresh()}deleteModules(j){return this.modulesStorage.delete(j)}upsertBatch(j){return this.modulesStorage.upsertBatch(j)}forType(j){return new bt(this.modulesStorage,j,this.debugModuleStoreAndComponentLoaderRevisionsMatch)}getNpmDependencyInstallStatus(j){return nA(this,Yj).get(me(j))??"unknown"}async addNpmDependencies(j){let r=typeof this.dependenciesModule>"u"&&!sa(),o=await ta(this.modulesStorage.addNpmDependencies(j)),n=Array.isArray(j)?j:[j],i=n.filter(({target:l})=>!fe(l));for(let l of i)nA(this,Yj).set(me(l),o.ok?"success":"failure");if(!o.ok)throw o.error;r&&la();let a=Object.keys(o.value.dependenciesMap.dependencies),s=n.map(({target:l})=>l).filter(l=>!a.includes(l)&&fe(l));if(s.length>0){let l=Wa(s,{max:5,placeholder:"package"});BA({type:"add",variant:"warning",primaryText:l,secondaryText:`${s.length===1?"is":"are"} incompatible.`,duration:5e3})}return o.value}changeScope(j){this.setActiveScope(j.id),this.modulesStorage.changeScope(j)}async reinstallNpmDependencies(){return{importMap:await this.modulesStorage.reinstallNpmDependencies()}}async uninstallBlockedNpmDependencies(){return{importMap:await this.modulesStorage.uninstallBlockedNpmDependencies()}}async unsafeUpgradeDependency(j,t,r){return{importMap:await this.modulesStorage.unsafeUpgradeDependency(j,t,r)}}async clearNpmDependencies(){return this.modulesStorage.clearNpmDependencies()}async removeBlockedNpmDependencies(){return{dependenciesMap:await this.modulesStorage.removeBlockedNpmDependencies()}}async rebuildImportMapFromDependencies(){return{importMap:await this.modulesStorage.rebuildImportMapFromDependencies()}}async rebuildImportMapFromEntryPoints(j=!1){let t=this.getEntryPointModuleNames();return{importMap:await this.modulesStorage.rebuildImportMapFromEntryPoints(t,void 0,j)}}async extendImportMapFromExternalEntryPoints(j,t){let r=await st(j,UA,lj,t);return await this.modulesStorage.extendCurrentImportMap(r,{dependencies:{}}),{importMap:r}}getEntryPointModuleNames(){let j=[];for(let t of this.localModules.values()){if(t.kind==="fast-refresh"||t.type!=="codeFile"&&t.type!=="canvasComponent"&&t.type!=="screen")continue;let r=t.files?.module;if(!r)continue;let o=Nj(t.localId,r);j.push(o)}for(let t of Fe.getModuleNodes(this.treeStore.tree)){if(t.type!=="codeFile"&&t.type!=="canvasComponent")continue;let r=AA(t.codeComponentIdentifier);Aj(r)&&j.push(r.importSpecifier)}return[...new Set(j)]}async updateSources(j){return this.modulesStorage.updateSources(j)}async updateKit(...j){return await this.modulesStorage.whenInitialized(),this.modulesStorage.upsertKit(...j)}async listKits(){let j=await this.modulesAPIServicePromise;return I(j,"Modules API service not initialized correctly"),await j.kits()}async enqueueKitScreenshots(...j){return this.modulesStorage.enqueueKitScreenshots(...j)}async updateDependenciesSource(j,t){await this.modulesStorage.updateDependenciesSource(j,t)}getDependentsOfModule(j){return this.modulesStorage.getDependentsOfModule(j)}subscribeToModulesStorage(j){return this.modulesStorage.subscribe(j)}async getModuleDependencies(j){let t=await this.modulesAPIServicePromise;return I(t,"Modules API service not initialized correctly"),await t.getModuleDependencies(j)}getModuleEntryByLocalId(j){for(let t of this.localModules.values())if(t.localId===j)return t}getModuleEntryByUniqueName(j){for(let t of this.localModules.values())if(t.name===j)return t}getPersistedDependenciesModule(){return this.modulesStorage.getPersistedDependenciesModule()}getPersistedModuleByGlobalId(j){return this.modulesStorage.getPersistedModuleByGlobalId(j)}getPersistedModuleByLocalId(j){return this.modulesStorage.getPersistedModuleByLocalId(j)}getPersistedModuleByLocalIdentifier(j){let t=AA(j);if(yA(t))return this.getPersistedModuleByLocalId(t.localId)}tryConvertExternalCodeComponentIdentifierToLocal(j){let t=AA(j);if(t?.kind!=="externalModuleExport")return;let r=this.getPersistedModuleByGlobalId(t.moduleId);if(r)return tt(r.localId,t.exportSpecifier).value}async listNamespaces(){let j=await this.modulesAPIServicePromise;return I(j,"Modules API service not initialized correctly"),await j.listNamespaces()}async createNamespace(j,t){let r=await this.modulesAPIServicePromise;return I(r,"Modules API service not initialized correctly"),await r.createNamespace({ownerId:j,ownerType:t})}async lookUpModule(j,t){let{modules:r,dependencies:o}=await this.lookUpModules([j],t),n=r[0];I(n,"Module does not exist, looking up:",j);let i={module:n};return o&&(i.dependencies=o[n.ownerType]?.[n.ownerId]),i}async lookUpModules(j,t){let r=await this.modulesAPIServicePromise;if(!r)return mA.error("Modules API service not initialized correctly"),{modules:[],dependencies:{}};let{data:o,dependencies:n}=await r.lookUpModules({queries:j,...t}),i=new Map(this.externalModulesDynamicInfo);for(let s of o){let l=s.id,{localId:k,title:c,description:d,lastPublish:$,status:B}=s;i.set(l,{localId:k,title:c,description:d,lastPublish:$,status:B??i.get(l)?.status})}this.externalModulesDynamicInfo=i;let a={modules:o};return n&&(a.dependencies=n),a}trackExternalComponentInsert(j,t){let r=vo();for(let o of j)ca({insertId:r,insertType:t,codeComponentId:o})}async installExternalModulesDependencies(j){let t=[],r=[];for(let o of j){let n=nA(this,qe).get(o);n?r.push(n):t.push(o)}if(t.length>0){let o=this.installDependenciesForModuleURLs(t);for(let n of t)nA(this,qe).set(n,o);r.push(o)}return Promise.allSettled(r).then(o=>{for(let n of o)n.status!=="fulfilled"&&mA.error("Failed to install external module",n.reason)})}isProcessingModules(){return this.modulesStorage.isProcessing()}hasLocalCodeFileChanges(){return this.modulesStorage.hasLocalCodeFileChanges()}resetModuleStateAndPermissions(j){this.modulesStorage.resetModuleStateAndPermissions(j)}getTransientSave(j){return this.modulesStorage.getTransientSave(j)}startUsingLocalModulesInTree(){return this.modulesStorage.startUsingLocalModulesInTree()}stopUsingLocalModulesInTree(){return this.modulesStorage.stopUsingLocalModulesInTree()}usingLocalModulesInTree(){return this.modulesStorage.usingLocalModulesInTree()}createFastRefreshModuleFromModule(j){if(ns.has(j.type)){if(j.kind==="server"){let t=this.getPersistedModuleByLocalId(j.localId);I(t?.kind==="server","Only server modules should have no sourceContent"),this.modulesStorage.createLocalModuleFromModule(t).catch(EA);return}this.compileFastRefreshModule({name:X(j),localId:j.localId,source:j.sourceContent}).catch(EA)}}getModuleWithTypeSlashName(j){return this.modulesStorage.getModuleWithTypeSlashName(j)}waitForModulesToSave(){return this.modulesStorage.waitForModulesToSave()}async installDependenciesForExternalModules(j){let t,r,o=[],n=new Set;for(let{dependencies:i,module:a}of j){if(!i?.importMap)continue;let s=i?.importMap;if(hA.isOn("importMapPruning")){I(a.files.module,"Module must have a module file");let l=`${a.baseURL}${a.files.module}`;if(o.push(l),n.has(a.ownerId))continue;n.add(a.ownerId)}if(!hA.isOn("importMapPruning")){let l=i.dependencies??Re(i?.importMap);r=Ge(r??{dependencies:{}},l)}t=Rj(t??{imports:{}},s)}!t||zo(t)||(hA.isOn("importMapPruning")&&o.length>0&&(await this.insertTemporaryImportMap(t),this.queueExternalImportMapUpdate(o,t).catch(EA)),!hA.isOn("importMapPruning")&&r&&await this.modulesStorage.extendCurrentImportMap(t,r))}installDependenciesForModuleURLs(j){return mA.info(`\u{1F986} Installing external modules:
	`,j.join(`
	`)),this.lookUpModules(j.map(t=>({url:t})),{includeDependencies:!0}).then(async({modules:t,dependencies:r={}})=>{let o=t.map(n=>({module:n,dependencies:r[n.ownerType]?.[n.ownerId]}));await this.installDependenciesForExternalModules(o)})}async addOrUpdateExternalVectors(j){await this.modulesStorage.whenInitialized();let{modules:t}=await this.lookUpModules(j.filter(n=>{let i=this.treeStore.tree.getNodeWithTrait(n.moduleId,QA);return i?AA(i.codeComponentIdentifier).saveId!==n.saveId:!0}),{includeDependencies:!1,includeStatus:!0}),r=new Map,o="default";for(let n of t){let i=yt({module:n,exportSpecifier:o}),a=this.treeStore.tree.getNodeWithTrait(n.id,QA);JA(a?.codeComponentIdentifier)&&AA(a.codeComponentIdentifier).saveId===n.saveId||r.set(i.value,{module:n,exportSpecifier:o})}await Promise.all(Array.from(r.keys(),n=>{let i=AA(n);return I(i,"Identifier must be a valid module identifier"),this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(i).catch(a=>{mA.error(`Failed to evaluate external module "${n}"`,a)})})),await new Promise((n,i)=>{this.scheduler.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes(Array.from(r.values()),{onTreeUpdate:()=>{let a=Za(r.keys());js(a,this.treeStore.getLoadedIndexes().codeComponents),es(a,this.treeStore.tree),rs(a,this.treeStore.tree)},updateSave:!0}).then(n).catch(i)},{name:"update_external_module_version",runInBackground:!0})})}async addOrUpdateVectorSetAndVectors(j){await this.addOrUpdateExternalVectors([j]);let r=this.treeStore.tree.getNodeWithTrait(j.moduleId,QA)?.annotation("framerVectorSet");pe(r)&&await this.addOrUpdateExternalVectors(r.items.map(o=>({moduleId:o.moduleId,saveId:o.saveId??""})))}async addExternalModulesToProject(j,t){let r=j.map(n=>typeof n=="string"?AA(n):n),o=await this.preloadExternalModules(r);return this.updateExternalModuleNodes(o,t)}async preloadExternalModules(j){await this.modulesStorage.whenInitialized();let t=new Map;for(let s of j)t.set(s.bareValue,s);let r=[],o=[],n=[];for(let[s,l]of t){let{moduleId:k,saveId:c}=l;if(!!this.modulesStorage.getPersistedModuleByGlobalId(k)){mA.reportError("Attempted to treat local module as external module",{identifier:l});continue}let $=this.treeStore.tree.getNode(k);if($&&AA($.codeComponentIdentifier).saveId===c&&!this.loadedExternalModulesStore.hasModuleForIdentifier(l)){o.push(l);continue}let B=nA(this,$j).get(s);if(B){n.push({identifier:l,preloadPromise:B});continue}nA(this,$j).set(s,new le),r.push(l)}let i=new Map;for(let{identifier:s,preloadPromise:l}of n)try{let k=await l;i.set(s.value,k)}catch{nA(this,$j).set(s.bareValue,new le),r.push(s)}if(r.length)try{let s=Array.from(r.values(),({moduleId:d,saveId:$})=>({moduleId:d,saveId:$})),{modules:l,dependencies:k}=await this.lookUpModules(s,{includeDependencies:!0,includeStatus:!0}),c=0;for(let d of r){let $=l[c++];I($,"Module must be defined"),i.set(d.value,{module:$,dependencies:k?.[$.ownerType]?.[$.ownerId],exportSpecifier:d.exportSpecifier}),o.push(d)}}catch(s){mA.reportError(s);for(let l of r)nA(this,$j).get(l.bareValue)?.reject(s);throw Error(`Failed to preload modules: ${s}`)}let a;for(let s of o){let l=i.get(s.value);if(!l)continue;let{dependencies:k}=l;k?.importMap&&(a=Rj(a??{imports:{}},k.importMap))}a&&await this.insertTemporaryImportMap(a),await Promise.all(Array.from(o.values(),s=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(l=>{mA.error(`Failed to evaluate external module "${s.value}"`,l)})));for(let s of r){let l=i.get(s.value);I(l,"Expected to have module information for:",s.value);let k=nA(this,$j).get(s.bareValue);I(k,"Expected to find a preload promise for:",s.bareValue),k.resolve(l)}return[...i.values()]}queueExternalImportMapUpdate(j,t){return new Promise((r,o)=>{nA(this,yj).push({entryPoints:j,inputMap:t,resolve:r,reject:o}),this.processExternalImportMapQueue()})}async processExternalImportMapQueue(){if(!nA(this,_j)){for(et(this,_j,!0);nA(this,yj).length>0;){let j=nA(this,yj).shift();if(!j)break;let{entryPoints:t,inputMap:r,resolve:o,reject:n}=j;try{let i=await this.extendImportMapFromExternalEntryPoints(t,r);o(i.importMap)}catch(i){n(i)}}et(this,_j,!1)}}async updateExternalModuleNodes(j,{onTreeUpdate:t,updateSave:r=!1}){return await this.installDependenciesForExternalModules(j),await Promise.all(j.map(o=>this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(yt(o)))),this.scheduler.processWhenReadyAsync(()=>{if(this.treeStore.tree.isViewOnly)throw Error("unable to edit");for(let o of j){let{id:n}=o.module,i=this.treeStore.tree.getNode(n);if(i&&!r){let a=yt(o),s=this.externalModulesDynamicInfo.get(a.moduleId)?.status??o.module.status;i.set({group:s?.group,updateSaveId:s?.updateSaveId})}else{let{type:a,metadata:s,ownerId:l,ownerType:k}=o.module,c=yt(o),{title:d,status:$}=this.externalModulesDynamicInfo.get(c.moduleId)??o.module,B=Fe.get(this.treeStore.tree);B||(B=new Fe,this.treeStore.tree.insertNode(B,this.treeStore.tree.root.id)),I($o(B));let u=s.pluginId,E={codeComponentIdentifier:c.value,type:a,scopeNodeId:ti(o.module),intrinsicWidth:Hj(s.intrinsicWidth,!0)??200,intrinsicHeight:Hj(s.intrinsicHeight,!0)??200,ownerId:l,ownerType:k,group:$?.group,updateSaveId:$?.updateSaveId,namespaceId:o.module.lastPublish?.namespaceId,pluginId:GA(u)?u:void 0},f=this.componentLoader.componentForIdentifier(c.value);I(f,"Component not found in the component loader",c.value);let F=f.annotations??void 0;E.annotations=oi(a)?Uj({default:F}).default:F;let g=f.name??d;if(E.title=g,i)i.set(E);else{let b=new ii({id:n,...E});this.treeStore.tree.insertNode(b,B.id)}}}return t()})}setupPollingExternalModulesUpdates(){let j=ra(()=>{this.checkForExternalModuleUpdates().catch(mA.reportError)},1e4),t=()=>{j(),this.updatesPollId===void 0&&(this.updatesPollId=window.setInterval(this.checkForExternalModuleUpdates,6e4))},r=()=>{window.clearInterval(this.updatesPollId),this.updatesPollId=void 0};function o(){return!document.hidden&&navigator.onLine}o()&&t();function n(){setTimeout(()=>{o()?t():r()},500)}document.addEventListener("visibilitychange",n),window.addEventListener("offline",n),window.addEventListener("online",n)}getCodeComponentNodesForExternalModuleExport(j){return this.treeStore.getLoadedIndexes().codeComponents.filter(t=>{if(!fA(t)||wA(t)&&!t.isVectorInstance)return!1;let r=AA(t.codeComponentIdentifier);return r?.kind!=="externalModuleExport"?!1:r.moduleId===j.moduleId&&r.exportSpecifier===j.exportSpecifier})}get fastRefreshEnabled(){return this.chromeStore.codeEditorPreviewVisible}async updateExternalModuleComponentInstances(j){let t=AA(j);I(t?.kind==="externalModuleExport","parsed 'ExternalModuleNodes.id' should be of kind externalModuleExport");let{moduleId:r,exportSpecifier:o}=t,n=this.externalModulesDynamicInfo.get(r)?.status?.updateSaveId;if(!n){mA.warn("Could not update module",r,"latest status missing");return}let{module:i,dependencies:a}=await this.lookUpModule({moduleId:r,saveId:n},{includeDependencies:!0,includeStatus:!0});I(i.files.module,"Module file must be defined");let s=sj(r,n,i.files.module,o);try{await this.loadedExternalModulesStore.ensureModuleEvaluatedInSandbox(s).catch(mA.reportError),await new Promise((l,k)=>{this.scheduler.runWithFullyLoadedTree(()=>{this.updateExternalModuleNodes([{module:i,dependencies:a,exportSpecifier:o}],{onTreeUpdate:()=>{this.getCodeComponentNodesForExternalModuleExport(t).forEach(d=>d.set({codeComponentIdentifier:s.value})),Ei(this.treeStore.tree,t.value,s.value),Oi(this.treeStore.tree,t.value,s.value)},updateSave:!0}).then(l).catch(k)},{name:"update_external_module_version",modalTitle:"Updating the module version"})}),this.trackExternalComponentInsert([s.value],"update")}catch(l){mA.reportError(l)}}async replaceRelativeImportsWithImportMapSpecifiers(j,t,r){let o={};for(let i of r){let a=Fj(i,j);if(!a)continue;let s;if(s=this.fastRefreshModules.get(a),s||(s=this.modulesStorage.getModuleWithTypeSlashName(a)),!s){mA.error("Cannot resolve",i,"from",j);continue}let l,{name:k,localId:c}=s;if(s.kind==="fast-refresh")l=MA(k).module;else{let{files:d}=s;I(GA(d.module),"Must have a module file name to build a local module import map specifier."),l=d.module}o[i]=Nj(c,l)}let n=await It(t,o);return I(n.ok),n.value}getModules(j=!1){let t={};for(let[r,o]of this.localModules)t[r]=o;if(j)for(let[r,o]of this.fastRefreshModules)t[r]=o;return{dependenciesModule:this.dependenciesModule,modules:t,revision:this.revision,initialized:this.modulesStorage.initialized}}getAllModulesAsUpdateEvent(j=!1){let{dependenciesModule:t,modules:r,initialized:o,revision:n}=this.getModules(j),i=[];t&&i.push({op:"add",path:[`${t.type}/${t.name}`],value:t});for(let a of Object.values(r))i.push({op:"add",path:[`${a.type}/${a.name}`],value:a});return{patches:i,dependentModules:[],prioritizedModules:[],initialized:o,revision:n}}getModulesUpdatesService(j=!1){return{moduleUpdatesStream:()=>j?this.fastRefreshModulesEmitter.newStream({replay:"latest"}):this.moduleUpdatesEmitter.newStream({replay:"latest"})}}hasScreenModuleLoaded(j){let t=Qn("screen",j,"default").value;return this.componentLoader.componentForIdentifier(t)!==null}hasPendingTreeData(){return this.modulesStorage.hasPendingTreeData()}writeTreeData(){this.modulesStorage.writeTreeData()}postProcess(){this.modulesStorage.processTreeUpdates()}takeSnapshot(){let j=this.modulesStorage.takeSnapshot();return new c6(this,j)}};Yj=new WeakMap,we=new WeakMap,qe=new WeakMap,$j=new WeakMap,_j=new WeakMap,yj=new WeakMap;var c6=class{constructor(e,j){this.modulesStorageSnapshot=j;T(this,"dependenciesModule");T(this,"localModuleKeys");this.dependenciesModule=e.dependenciesModule,this.localModuleKeys=Array.from(e.localModules.keys())}getPersistedModuleByLocalId(e){return this.modulesStorageSnapshot.getPersistedModuleByLocalId(e)}getPersistedModuleByLocalIdentifier(e){let j=AA(e);if(yA(j))return this.getPersistedModuleByLocalId(j.localId)}getModuleWithTypeSlashName(e){return this.modulesStorageSnapshot.getModuleWithTypeSlashName(e)}};var zk={defaultComponent:{insert:"insert-default",drag:"insert-default-drag"},libraryModule:{insert:"insert-library",drag:"insert-library-drag"},externalModuleComponent:{insert:"insert",drag:"insert-drag"}},d6="default_component_",St="external_",$6="local_",is="legacy_design_component",as="legacy_code_component",ss=`${$6}${as}`,Wk=`${St}${as}`,ls=`${$6}${is}`,ks=`${St}${is}`;var Yk=new Set(["form","frame","image-frame","stack","repeater"]),Zk=A=>A.startsWith(d6),cs=A=>A===ls||A===ks,Ac=A=>Yk.has(A);function ds({canvasNode:A,source:e,isDrag:j,engine:t}){let r=jc(A,t);switch(PA("component_instance",{componentType:r.type,source:e}),e){case"insert_menu":{let o=ec(r);PA("insert_menu_add",{type_added:o});break}}if(r.type==="local_module_canvasComponent_component"&&PA("component_canvas_instance",{componentId:A.id}),cs(r.type)&&PA("component_design_instance",{}),fA(A)&&Aj(A.codeComponentIdentifier)){let o=r.type.startsWith(d6)?"defaultComponent":e==="team_library"?"libraryModule":"externalModuleComponent",n=zk[o][j?"drag":"insert"];t.stores.modulesStore.trackExternalComponentInsert([A.codeComponentIdentifier],n)}}function jc(A,e){if(fA(A)){let r=A.codeComponentIdentifier,o=AA(r);if(!o)return{type:A.codeComponentIdentifier.startsWith(".")?ss:Wk,codeComponentIdentifier:r};if(yA(o))return{type:`${$6}module_${o.type}_component`,codeComponentIdentifier:r};if(Aj(o)){let n=e.stores.treeStore.tree.getNode(o.moduleId);return Et(e.stores.treeStore.tree,r)?{type:`${d6}${n?.title}`,codeComponentIdentifier:r}:{type:`${St}module_${n?.type??"unknown"}_component`,codeComponentIdentifier:r}}}let t=A.replicaInfo?.master&&e.tree.getNode(A.replicaInfo.master)||A;return so(t)?lo(t)?{type:ks}:{type:ls}:ko(A)?{type:"repeater"}:Po(A)?{type:"form"}:HA(A)?{type:"stack"}:de(A)?A.fillType==="image"?{type:"image-frame"}:{type:"frame"}:{type:"unknown"}}function ec({type:A}){return A.startsWith("local_module_")||A===ss?"code_component":cs(A)?"design_component":A.startsWith(St)?"package":Zk(A)||Ac(A)?A:"unknown"}function $s(A,e){let j=A.children;return io(A)?!j||j.length===0?[]:e.getChildrenRects(A.id)??[]:null}function us(A,e,j){if(A>=e&&A<=j||A<=e&&A>=j)return 0;let t=Math.abs(e-A),r=Math.abs(j-A);return Math.min(t,r)}function tc(A,e,j){let t=A?"y":"x",r=A?"height":"width",o=e[t],n=0,i=1/0;return j.forEach((a,s)=>{if(i===0)return;let l=a[t],k=l+a[r],c=us(o,l,k);c<i&&(n=s,i=c)}),n}function rc(A,e,j,t){let r=Math.max(A,j),o=Math.min(e,t);return r<o}function nc(A,e,j){let t=A?"y":"x",r=A?"height":"width",o=j[e];I(o,"Out of bound access to childRects:",e,j);let n=o[t],i=n+o[r],a=new Set([e]);return j.forEach((s,l)=>{if(l===e)return;let k=s[t],c=k+s[r];rc(n,i,k,c)&&a.add(l)}),{startIndex:Math.min(...a),endIndex:Math.max(...a)}}function oc(A,e,j,t,r,o){if(r)return t.startIndex;if(o)return t.endIndex;let n=e?"x":"y",i=e?"width":"height",a=A[n],s=1/0,l=t.startIndex;for(let k=t.startIndex;k<=t.endIndex;k++){let c=j[k];I(c,"Ouf of bound access to childRects:",k,t,j);let d=c[n],$=d+c[i],B=us(a,d,$);B<s&&(s=B,l=k)}return l}function ic(A,e){let j=[];for(let t=e.startIndex;t<=e.endIndex;t++){let r=A[t];I(r,"Ouf of bound access to childRects:",t,e,A),j.push(r)}return lA.merge(...j)}function ac(A,e,j,t){let r=$e(A)||A.resolveValue("stackDirection")==="horizontal",o=lA.merge(...e),n=r?"x":"y",i=r?"y":"x",a=r?"width":"height",s=r?"height":"width",l=j[n],k=j[i],c=o[i],d=c+o[s],$=k<c,B=!$&&k>d,u=tc(r,j,e),E=nc(r,u,e),f=oc(j,r,e,E,$,B),F=e[f];I(F,"Closest rect is not defined:",f);let g=F[n]+F[a]/2,b=$||B?$:l<g,G=b?f:f+1;$&&(G=0),B&&(G=e.length);let v=F[n],N=v+F[a],C=b?v:N,R=null,K=b?f-1:f+1;if(K>=E.startIndex&&K<=E.endIndex){let Y=e[K];if(Y){let tA=Y[n],m=tA+Y[a];R=b?m:tA}}let w=C;ej(R)&&(w=Math.round((w+R)/2));let y=ic(e,E),S=Math.round(y[i]+y[s]/2),P={[n]:w,[i]:S},H={...P},V={...P},rA=t[s],eA=Math.round(rA/2);return r?(H.y-=eA,V.y+=eA):(H.x-=eA,V.x+=eA),{insertionIndex:G,localInsertionLine:{a:H,b:V}}}function sc(A,e){let j={insertionIndex:0,localInsertionLine:{a:{...e},b:{...e}}};if(A.length===0)return j;let t=new Map,r=1e3;A.forEach((c,d)=>{let $=Math.round(c.x*r),B=t.get($);B?(B.indices.push(d),c.width>B.width&&(B.width=c.width)):t.set($,{x:c.x,width:c.width,indices:[d]})});let o=Array.from(t.values()).sort((c,d)=>c.x-d.x),n=o.find(c=>e.x>=c.x&&e.x<=c.x+c.width);if(n||(n=o.reduce((c,d)=>{if(!c)return d;let $=d.x+d.width/2,B=c.x+c.width/2;return Math.abs(e.x-$)<Math.abs(e.x-B)?d:c},o[0])),!n)return j;let i=[...n.indices].sort((c,d)=>{let $=A[c],B=A[d];return!$||!B?0:$.y-B.y}),a=i.findIndex(c=>{let d=A[c];return d?e.y<d.y+d.height/2:!1});a===-1&&(a=i.length);let s;a<i.length?s=i[a]??0:s=(i[i.length-1]??0)+1;let l;if(a<=0){if(!i[0])return j;l=A[i[0]]?.y??0}else if(a>=i.length){let c=i[i.length-1];if(!c)return j;let d=A[c];if(!d)return j;l=d.y+d.height}else{let c=i[a];if(!c)return j;let d=A[c];if(!d)return j;l=d.y}let k={a:{x:n.x,y:l},b:{x:n.x+n.width,y:l}};return{insertionIndex:s,localInsertionLine:k}}var Es=4,Bs=20;function ps(A,e,j,t,r){if(I(e.length,"childInsertion only works correctly if there are more than 0 child rects"),hA.isOn("betterStackGridItemMoving")){let{rect:k,index:c}=lA.closestRect(e,t),d=ce(A),$=ao(A)?!d:A.resolveValue("stackDirection")==="horizontal",B=$?"x":"y",u=$?"y":"x",E=$?"width":"height",f=$?"height":"width",F=t[B]<k[B]+k[E]/2,g=d&&ej(A.gridColumnCount)?Math.max(Math.floor(A.gridColumnCount),1):1,b=F?c-g:c+g,G=e[b],v=!G||(F?G[B]>=k[B]:k[B]>=G[B]),N=F?c:Math.min(c+g,e.length);if(v){let C=F?k[B]+Es:k[B]+k[E]-Es;return{insertionIndex:N,localInsertionLine:{a:Mt(B,C,k[u]),b:Mt(B,C,k[u]+Math.max(k[f],Bs))}}}else{let C=F?(G[B]+G[E]+k[B])/2:(k[B]+k[E]+G[B])/2;return{insertionIndex:N,localInsertionLine:{a:Mt(B,C,Math.min(G[u],k[u])),b:Mt(B,C,Math.max(G[u]+G[f],k[u]+Math.max(k[f],Bs)))}}}}if($e(A)||A.stackWrapEnabled)return ce(A)?sc(e,t):ac(A,e,t,r);let o=1/0,n=null,i=A.stackDirection==="vertical";e.forEach((k,c)=>{let d=Math.abs(i?t.y-k.y:t.x-k.x);d>o||(o=d,n=c)});let a=0;if(n!==null){let k=e[n];I(k,"Closest child rect is not defined:",n);let c=lA.center(k);(i?t.y>c.y:t.x>c.x)&&n++,a=Math.min(Math.max(0,n),e.length)}let s=kc(A),l=cc(A.resolveValue("stackDirection"),A.resolveValue("stackAlignment"),s,j,e,a,r);return{insertionIndex:lc(A,a),localInsertionLine:l}}function Mt(A,e,j){return A==="x"?{x:e,y:j}:{x:j,y:e}}function lc(A,e){I(Be(A),"A node must support children to consider an insertion index.");let j=e;for(let t=0;t<A.children.length&&t!==e;t++){let r=A.children[t];r&&(ni(r)||j++)}return j}function kc(A){let e=A.resolveValue("stackDirection"),j=A.resolveValue("stackAlignment");if(j==="center")return 0;let t=Ko(A);if(!t.perSide)return t.top;let r=j==="start";return e==="vertical"?r?t.left:t.right:r?t.top:t.bottom}function cc(A,e,j,t,r,o,n){let i=r[o-1],a=r[o],s=A==="vertical",l={x:t.width/2,y:t.height/2};if(!(!i&&!a)){if(r.length===1){let k=i||a;I(k,"Child rect must be defined"),o===0?s?l.y=k.y-10:l.x=k.x-10:s?l.y=k.y+k.height+10:l.x=k.x+k.width+10}else if(i&&a){let k=Math.abs(s?i.y+i.height-a.y:i.x+i.width-a.x);s?l.y=a.y-k/2:l.x=a.x-k/2}else if(i){let k=r[o-2];I(k,"Child rect must be defined");let c=Math.abs(s?k.y+k.height-i.y:k.x+k.width-i.x);s?l.y=i.y+i.height+c/2:l.x=i.x+i.width+c/2}else if(a){let k=r[o+1];I(k,"Child rect must be defined");let c=Math.abs(s?a.y+a.height-k.y:a.x+a.width-k.x);s?l.y=a.y-c/2:l.x=a.x-c/2}}return l.x=Math.min(Math.max(4,l.x),t.width-4),l.y=Math.min(Math.max(4,l.y),t.height-4),dc(A,e,j,l,t,n)}function dc(A,e,j,t,r,o){let n=A==="vertical",i,a,s=j??0;switch(e){case"center":i={x:n?t.x-o.width/2:t.x,y:n?t.y:t.y-o.height/2},a={x:n?t.x+o.width/2:t.x,y:n?t.y:t.y+o.height/2};break;case"start":i={x:n?s:t.x,y:n?t.y:s},a={x:n?o.width+s:t.x,y:n?t.y:o.height+s};break;case"end":default:i={x:n?r.width-o.width-s:t.x,y:n?t.y:r.height-o.height-s},a={x:n?r.width-s:t.x,y:n?t.y:r.height-s};break}return{a:i,b:a}}var ms=6;function $c(A,e){for(let j of A)if(e.includes(j))return!0;return!1}function Ec(A,e,j,t,r){if(r.length===0||A.stackWrapEnabled||Eo(A)||wA(A))return null;let{tree:o}=e,{zoom:n}=e.stores.canvasStore,i=o.getParent(A.id);if(i&&HA(i)&&(i.stackDirection!==A.stackDirection||i.stackWrapEnabled))return null;let a=o.convertPointToNode(A,j),s=o.getRect(A),l=A.stackDirection==="vertical",k=l?"x":"y",c=l?"y":"x",d=l?"width":"height",$=l?"height":"width",B=s[d],u=s[$],E=B*n,f=u*n;if(E<40||f<40)return null;let F=a[k],g=10/n,b=lA.merge(...r),G=b[k],v=G+b[d],N=Math.max(g,G/2),C=Math.max(g,(B-v)/2),R=F<=N,K=F>=B-C;if(!R&&!K)return null;let w=R?0:1,y=t[$],S=4/n,P=R?S:B-S,H=u/2,V=y/2,rA=u/3,eA=a[c],p="end";y>u?p="center":eA<rA?p="start":eA<2*rA&&(p="center");let Y,tA;switch(p){case"start":{Y=0,tA=y;break}case"end":{tA=u,Y=tA-y;break}case"center":default:{Y=H-V,tA=H+V;break}}let m={[k]:P,[c]:Y},aA={[k]:P,[c]:tA},bA=o.convertPointToCanvas(A,m),CA=o.convertPointToCanvas(A,aA);return{insertionIndex:w,insertionLine:{a:bA,b:CA},wrap:{wrapAlignment:p}}}function E6(A,e,j,t,{allowWrapping:r=!0}={}){if(!Be(A))return{insertionIndex:null,insertionLine:null};let o=$s(A,e.stores.layoutCache);if(!o)return{insertionIndex:null,insertionLine:null};if(HA(A)&&r){let c=Ec(A,e,j,t,o);if(c)return c}let n=e.tree,i=n.getRect(A),a=n.convertPointToNode(A,j);if(o.length===0)return{insertionIndex:0,insertionLine:null};let{insertionIndex:s,localInsertionLine:l}=ps(A,o,i,a,t),k={a:n.convertPointToCanvas(A,l.a),b:n.convertPointToCanvas(A,l.b)};return{insertionIndex:s,insertionLine:k}}var Bc={width:10,height:10};function fs(A,e,j,t,r=!1){I(j.length,"getStackOrGridInRange(): expects at least a single selected node");let o=A.stores.scopeStore.active;if(j.some(Co))return null;let i=A.tree.getNodesAtPoint(o,e).filter(l=>!(Jo(l)&&l.locked||!Be(l)||wi(l)||wo(A.tree,A.stores.overlayStore.activeOverlays,l))).reverse();if(t){let l=t.id,k=i.find(c=>c.id===l);if(k)return k}let a=null,s=j.map(l=>l.id);for(let l of i){if(!fo(l)||r&&!Jj(l))continue;let k=A.tree.getAncestors(l.id);if(k.push(l.id),$c(k,s)||(a||(a=l),!Ee(l)))continue;let{insertionLine:d}=E6(l,A,e,Bc);if(!d)continue;if(d.a.x===d.b.x){if(Math.abs(e.x-d.a.x)*A.stores.canvasStore.zoom>ms)continue}else if(d.a.y===d.b.y){if(Math.abs(e.y-d.a.y)*A.stores.canvasStore.zoom>ms)continue}else continue;if(j.every(B=>ue(A.tree,l,B,o.id,A.componentLoader)))return l}if(Ee(a)){let l=a;if(j.every(c=>ue(A.tree,l,c,o.id,A.componentLoader)))return a}return null}function Gs(A,e,{wrapAlignment:j}){let t=Ji.addStack(A,[e]);if(!t)return null;let r=A.tree.getNode(t);return!r||!HA(r)?null:(r.set({stackDirection:e.stackDirection==="horizontal"?"vertical":"horizontal",stackAlignment:j}),r)}function B6(A,e){let{width:j,height:t}=A.tree.getRect(e);return vr(e)&&Pr(e)&&(e.widthType===2&&e.width>0&&(j=e.width),e.heightType===2&&e.height>0&&(t=e.height)),{width:j,height:t}}function uc(A,e,j){let t=B6(A,e);return{...t,x:j.x-t.width/2,y:j.y-t.height/2}}function pc(A,e){let j=B6(A,e),t=A.stores.scopeStore.active,r=A.tree.getCommonGroundNode(A.stores.selectionStore.nodes),o,n;if(r){let a=A.tree.convertFrameToCanvas(r);o=lA.center(a).x-j.width/2,n=a.y}else if(SA(t)||Kj(t)){let a=t.getPrimaryVariant(),s=A.tree.convertFrameToCanvas(a);o=lA.center(s).x-j.width/2,n=s.y}else{let a=A.stores.canvasStore.getCanvasCenter();o=a.x-j.width/2,n=a.y-j.height/2}let i={x:o,y:n};for(;;){let a={...j,...i},s=ui(A.tree,t,a,!0);if(s.length===0)return a;let l=A.tree.getBoundingFrameForNodes(s);i.x=l.x-j.width-100}}function mc(A,e,j,t=!1){let{tree:r}=A,o=r.getPotentialParents(A.stores.scopeStore.active,A.stores.overlayStore.activeOverlays,lA.cornerPoints({...j,width:1,height:1}),j,A.componentLoader,e);return t&&(o=o.filter(Jj)),o=r.sortVisually(o).reverse(),o.length>0&&o[0]?o[0]:null}var Rs={width:1,widthType:1,heightType:2,left:0,right:null};function Fs({engine:A,component:e,canvasPoint:j,source:t,type:r,shouldBecomeFullWidthForVariants:o=new Set,isLayoutSection:n=!1,notDraggedOntoCanvas:i=!1,insertAsGroundNode:a=!1,insertAsOverlayType:s,imageToUpload:l,parentId:k}){ds({canvasNode:e,source:r==="libraryModule"?"team_library":t,isDrag:!0,engine:A});let{selectionStore:c,canvasStore:d,scopeStore:$}=A.stores,B=a?pc(A,e):uc(A,e,j);s===1&&it(e)&&e.set({floatingPositionEnabled:!0,floatingPlacement:To,floatingAlignment:Do,floatingOffsetX:0,floatingOffsetY:10});let u=qi(A,e),E=fs(A,j,[u],null,n);if(i&&n&&!E){let y=d.getCanvasVisibleRectTakingOverlaysIntoAccount(),S=c.ids.length===1&&c.ids[0]?A.tree.getNode(c.ids[0]):null,P=S?A.tree.getGroundNodeFor(S):null;Ee(P)&&lA.intersects(A.tree.convertFrameToCanvas(P),y)&&(E=P)}let f=k?A.tree.getNode(k):E??mc(A,e,j,n),F=c.ids.length===0,g=$.active,b=Ro(g)?g.getPrimaryVariant():null;if(i&&n&&b&&F&&(f=b),s===1&&f&&it(u)&&!Jj(f)){I(f,"Parent should exist");let y=f.getPrimaryId(),S=vi(A.componentLoader,A.stores,"framer/useShowRelativeOverlay",y,u.draftOrCurrent());if(!S)return;A.tree.move(S.id,y);return}else it(u)&&u.set(xo);if(a&&(f=null,E=null,!lA.containsRect(d.getCanvasVisibleRectTakingOverlaysIntoAccount(),B))){let y=lA.center(B),S=d.zoom,P=Math.min(S,1);d.scrollToCenter(y,{animate:!0,zoom:P})}let G=-1,v=null;if(f){Ri(A,f,e,B),Fi(A,f,e);let y=f.draftOrCurrent();HA(y)&&(E=y)}if(E){let y=B6(A,e);if(k)G=E.children.length;else{let{insertionIndex:S,wrap:P}=E6(E,A,j,y);P&&(v=P),ej(S)&&(G=S)}if(i&&n){if(G=E.children.length,c.ids.length===1){let OA=c.ids[0],TA=OA&&A.tree.getNode(OA);if(TA){let WA=new Set([TA.id]);for(let ie of TA.ancestors())WA.add(ie.id);let wj=E.children.findIndex(ie=>WA.has(ie.id));wj>=0&&(G=wj+1)}}let S,P=E.children[G-1];P?(S=A.tree.convertFrameToCanvas(P),S.y+=S.height):S=A.tree.convertFrameToCanvas(E),S.height=y.height;let H=A.tree.convertFrameToCanvas(E),V=Math.min(S.x,H.x),rA=Math.max(lA.maxX(S),lA.maxX(H));S.x=V,S.width=rA-V;let{zoom:eA}=d,p=d.getCanvasVisibleRectTakingOverlaysIntoAccount(),Y=p.width*eA,tA=p.height*eA,m=40,aA=Math.max(Y-m*2,100),bA=Math.max(tA-m*2,100),CA=aA/(S.width||1),NA=bA/(S.height||1),dA=Math.min(CA,NA,.5),pj=lA.center(S);d.scrollToCenter(pj,{animate:!0,zoom:dA})}Ii(A,E,e,B)}let N;if(f){let{width:y,height:S}=B;N={...Bi(A.tree,f,B),width:y,height:S}}else N=B;let C=u.updateForRect({rect:N,parentSizeInfo:null,constraintsLocked:!1,shouldGuessPinToBottom:f?di(A.tree,u,f):!0,shouldGuessPinToRight:f?$i(A.tree,u,f):!0});f&&HA(f)&&Pr(u)&&vr(u)&&(C=Gc(u,C)),ma(A.componentLoader,u,C),u.set(C,A.tree);let R=u.id,K=!1,w=null;if(f){if(w=f,uo(f)&&(w=A.tree.getNode(f.originalid),K=!0,I(w,"Fail to insert node into variants: the original parent should exist")),v&&!wA(w)&&HA(w)){let H=Gs(A,w,v);if(!H)return;w=H}A.moveNode(u.id,w.id,G),K&&(I(wA(f),"Fail to insert node into variants: the new parent should be a replica node"),R=qo(A,u,f,w));let y=A.tree.getGroundNodeFor(w),S=y.resolveValue("name"),P=!!(S&&o.has(S.toLowerCase()));if(de(u)&&P&&u.set({left:0,width:1,widthType:1},A.tree),fA(u)&&Bo(y)&&Jj(y)){let V={width:u.width,widthType:u.widthType,left:u.left,right:u.right};P&&u.set(Rs);let rA=fi(A.componentLoader,u);if(rA){let eA=A.tree.getScopeNodeFor(y);SA(eA)&&eA.getTopLevelReplicaVariants().forEach(Y=>{let tA=Y.resolveValue("name");if(!tA)return;let m=Gi(tA,rA);if(!m||m===rA.defaultVariant)return;let aA={...Y.replicaInfo.overrides},bA={...Y.replicaInfo,overrides:aA},CA={...aA[u.id]},NA=fc(P,o,tA,V);NA&&Object.assign(CA,NA),CA[mo(rA.key)]={type:"enum",value:m},aA[u.id]=CA,Y.set({replicaInfo:bA})})}}$e(f)&&Mo(u)&&(P||u.set({gridItemFillCellWidth:!0}),ce(f)||u.set({gridItemFillCellHeight:!0}))}l&&de(e)&&Vi(l,e,A).catch(EA),!k&&c.set(R,{switchToLayers:!!k,switchToProperties:!0})}function fc(A,e,j,t){let r=e.has(j.toLowerCase());if(A!==r)return r?Rs:t}function Gc(A,e){let j={...e};return(A.widthType===3||A.widthType===1)&&ej(e.width)&&e.widthType!==A.widthType&&(delete j.width,delete j.widthType),(A.heightType===3||A.heightType===1)&&ej(e.height)&&e.heightType!==A.heightType&&(delete j.height,delete j.heightType),j}function Ot({engine:A,module:e,identifier:j,position:t,centerInParent:r,insertAsGroundNode:o,update:n,parentId:i}){let a={width:Hj(e.metadata.intrinsicWidth,!0)??200,height:Hj(e.metadata.intrinsicHeight,!0)??200},s=new ai({codeComponentIdentifier:j,slotsAreChildNodes:hA.isOn("componentSlotsAreChildNodes"),...a});n&&n(s);let l=t;if(r&&!o&&!i){let k=Pa(s,A),c=k?lA.center(A.tree.convertFrameToCanvas(k)):null,d=A.stores.canvasStore.getCanvasVisibleRectTakingOverlaysIntoAccount();c&&lA.containsPoint(d,c)&&(l=c)}return Fs({engine:A,component:s,canvasPoint:l,source:"context_menu",insertAsGroundNode:i?!1:o,parentId:i}),s}var Ne=LA("unlinking");function Is(A,e,j=!0){A.scheduler.processWhenReady(()=>{let{overlayStore:t,selectionStore:r,scopeStore:o,canvasStore:n,persistedUserDefaults:i}=A.stores;o.selectByNode(e.id);let a=xr(e)?e:A.tree.getNodeWithTrait(e.cache.overlayAncestorId,xr);if(a?t.showOverlay(r,a,a.parentid):t.hideAll(),r.set(e.id),j){let s=A.tree.getBoundingFrameForNodes([e]);n.zoomToCenter(s,{animated:i.animateOnZoom,maxZoom:1})}})}async function Rc(A,e,j){let{codeEditorStore:t,selectionStore:r,treeStore:o}=A.stores;t.closeEditor();let[n]=r.nodes;if(r.nodes.length===1&&fA(n)&&n.codeComponentIdentifier===e)return!0;let i=await A.runWithFullyLoadedTreeAsync(()=>{for(let a of o.treeIndex.codeComponentNodeIds){let s=A.tree.getNodeWithTrait(a,fA);if(s?.codeComponentIdentifier===e)return s}},{runInBackground:!0,name:`findCodeComponentInstance: ${e}`});return i?(Is(A,i),!0):(BA({type:"add",variant:"info",key:"add-component-instance-to-edit-in-plugin",primaryText:"Add component to Canvas",secondaryText:`to edit in ${j.name}.`}),!1)}async function hs(A,e,j){return await Rc(A,e,j)?(A.stores.pluginStore.openPlugin(j,A,{mode:"canvas"}),!0):!1}function gs(A,e){let j=A.componentForIdentifier(e);if(j)return j;let t=AA(e);return!yA(t)||!JA(t)?null:A.componentForIdentifier(Hn(t))}var Fc=0;async function Pt(A,e,j=Fc){if(j===0){let r=AA(e),o=Pi(A.stores.treeStore,A.stores.modulesStore,A.stores.pluginStore,r);if(o&&await hs(A,e,o))return}let t=gs(A.componentLoader,e);t&&A.stores.codeEditorStore.editFile(t.file)}async function bs(A,{identifier:e,info:j,instance:t,enterIsolation:r,codeComponentIsolationMode:o}){let n=j.module.baseURL+j.module.files.source,a=await(await fetch(n)).text(),[s,l]=await Promise.all([ua(a),A.stores.modulesStore.getModuleDependencies(e)]);if(s.ok){let B=new Map;for(let E of s.value.relative){let f=Fj(E.specifier,`${j.module.type}/`);if(!f){Ne.warn("Failed to normalize relative import",E.specifier);continue}let F=B.get(f)??[];F.push(E),B.set(f,F)}let u;for(let E of l.imports){if(E.type!=="local")continue;let f=`${E.moduleType}/${E.moduleName}`,F=B.get(f);if(!F){Ne.warn("Unable to get source location of import",f,"when unlinking");continue}for(let g of F){u||(u=a.split(`
`));let b=g.specifierLine;u[b]=u[b].replace(JSON.stringify(g.specifier),JSON.stringify(E.importURL))}}u&&(a=u.join(`
`))}let k=A.stores.modulesStore.forType("codeFile"),c=k.getUniqueName(j.module.name),d=await k.create({name:c,source:a,metadata:{pluginId:j.module.metadata.pluginId}}),$=Un(e,d).value;return t&&A.scheduler.processWhenReady(()=>{let B=A.tree.get(t.getPrimaryId());B&&B.set({codeComponentIdentifier:$})}),r&&(A.stores.chromeStore.contentPanelTab="Assets",Pt(A,$,o)),$}var _s={canvasComponent:Si,codeFile:bs};function hc(A){return GA(A)?A in _s:!1}async function p6(A,{identifier:e,moduleType:j,instance:t,enterIsolation:r=!0,codeComponentIsolationMode:o,renamedIds:n=new Map,isAutoDetach:i=!1}){if(!hc(j))throw Error(`Cannot import external module of type ${j}`);let[a]=await A.stores.modulesStore.preloadExternalModules([e]);I(a,"external module must exist on preload");let s={identifier:e,info:a,instance:t,enterIsolation:r,codeComponentIsolationMode:o,renamedIds:n,isAutoDetach:i},l=_s[j],k=await l(A,s);if(!ke(k))return!GA(k)&&Kj(k)?{...a,codeComponentIdentifier:k.instanceIdentifier,node:k}:{...a,codeComponentIdentifier:k,node:void 0}}var u6=new Set;async function gc(A,e){let{instance:j,withUnlinkModal:t,...r}=e,o=Et(A.stores.treeStore.tree,e.identifier),n=A.stores.insertSidebarStore.getEditBehavior(e.identifier.moduleId);if(t&&n!=="autoUnlink"&&(!o||Qi.isOn("openPrimaryForBuiltInModules"))){A.stores.modalStore.set({type:"UnlinkComponent",source:"edit_action",...r,nodeId:j?.id});return}if(!u6.has(e.identifier)){u6.add(e.identifier),A.scheduler.process(()=>{A.beginUndoGroup()});try{return(await p6(A,{instance:j,enterIsolation:n!=="autoDetach",...r}))?.codeComponentIdentifier}catch(i){Ne.reportError(i),BA({type:"add",variant:"error",primaryText:"Failed to unlink",secondaryText:"component.",key:"external-component-unlink-error",icon:"error"})}finally{A.scheduler.processWhenReady(()=>{A.endUndoGroup()}),u6.delete(e.identifier)}}}async function nR(A,e){let{instance:j,moduleType:t,enterIsolation:r,codeComponentIsolationMode:o}=e;if(!fA(j))return;let n=await gc(A,{...e,enterIsolation:!1});if(!n)return;await hi(A.componentLoader,[n],A.stores.modulesStore);let i=A.componentLoader.componentForIdentifier(n);if(!i)return;let a=Li(i);a&&A.scheduler.processWhenReady(()=>{if(A.tree.getNodes(Array.from(A.stores.treeStore.treeIndex.codeComponentNodeIds)).forEach(l=>{if(!a||a.id===l.id||!fA(l)||l.codeComponentIdentifier!==j.codeComponentIdentifier||wA(l)||!Ni(l,{allowLockedNodes:!0}))return;let k=A.cloneNode(a,!1,!1);Ki(A,l,k).catch(EA)}),!!r)if(t==="canvasComponent"){let l=at(n);l&&A.stores.scopeStore.select(l,{keepHistory:!1})}else t==="codeFile"&&Pt(A,n,o)})}function oR(A,e,j){if(mi(A,"canDesign"))return;let r=A.tree.getNodeWithTrait(e,QA)?.annotation("framerVector");if(!Qj(r))return;let o=r.set.moduleId,i=A.tree.getNodeWithTrait(o,QA)?.annotation("framerVectorSet");pe(i)&&A.stores.modalStore.set({type:"EditVector",source:"edit_action",vectorSetNodeId:o,moduleId:e,itemCount:i.items.length,instanceNodeId:j})}var bc=LA("clipboard:modules");async function fR(A,e,j){if(!e||!ei(e))return!1;let t="insert-external-component";try{await yc({engine:A,moduleURL:e,position:j,centerInParent:!0,toastKey:t}),BA({type:"remove",key:t})}catch(r){console.error("Failed to insert external component",r),BA({type:"add",variant:"error",key:t,primaryText:"Failed to insert",secondaryText:"external component.",icon:"error"})}return!0}function m6(A){switch(A){case"screen":return"web page.";case"vector":return"vector set.";default:return"external component."}}async function _c(A,e){let j=new URL(e),t=j.hash.substring(1).split(","),r=t[0]||"default",o=t.some((k,c)=>c>0&&k==="unlink"),{module:n}=await A.stores.modulesStore.lookUpModule({url:j.href}),i=n.id,a=A.stores.modulesStore.getPersistedModuleByGlobalId(i);I(n.files.module,"Module file must be defined");let s=sj(i,n.saveId,n.files.module,r),l=a?tt(a.localId,r):s;return{module:n,moduleIdentifier:l,externalIdentifier:s,insertUnlinked:o}}async function yc({engine:A,moduleURL:e,position:j,centerInParent:t,insertAsGroundNode:r,toastKey:o,update:n,parentId:i}){let{module:a,moduleIdentifier:s,externalIdentifier:l,insertUnlinked:k}=await _c(A,e);if(a.type==="screen")if(yA(s)){let c=at(s.value);if(!c)return;let d=A.tree.getNode(c);if(!SA(d))return;await A.loadScopesThenProcess([d],([$])=>{$&&Oa(A,$,$.getPrimaryVariant())})}else o&&BA({type:"add",variant:"progress",key:o,primaryText:"Inserting",secondaryText:m6(a.type),icon:"reconnecting",duration:1/0,showCloseButton:"never"}),await Mi(A,l);else if(k){o&&BA({type:"add",variant:"progress",key:o,primaryText:"Inserting",secondaryText:m6(a.type),icon:"reconnecting",duration:1/0,showCloseButton:"never"});let c=await p6(A,{identifier:l,moduleType:a.type,enterIsolation:!1});await A.scheduler.processWhenReadyAsync(()=>{c&&Ot({engine:A,module:a,identifier:c.codeComponentIdentifier,position:j,centerInParent:t,insertAsGroundNode:r,update:n,parentId:i})})}else{if(o&&BA({type:"add",variant:"progress",key:o,primaryText:"Inserting",secondaryText:m6(a.type),icon:"reconnecting",duration:1/0,showCloseButton:"never"}),!Aj(s)){await A.scheduler.processWhenReadyAsync(()=>{Ot({engine:A,module:a,identifier:s.value,position:j,centerInParent:t,insertAsGroundNode:r,update:n,parentId:i})});return}await A.stores.modulesStore.addExternalModulesToProject([s],{onTreeUpdate:()=>{if(Ot({engine:A,module:a,identifier:s.value,position:j,centerInParent:t,insertAsGroundNode:r,update:n,parentId:i}),a.type!=="vector")return;let c=A.tree.getNodeWithTrait(a.id,QA)?.annotation("framerVector");Qj(c)&&A.stores.modulesStore.addOrUpdateVectorSetAndVectors({moduleId:c.set.moduleId,saveId:""}).catch(EA)}}).catch(bc.reportError),A.stores.modulesStore.trackExternalComponentInsert([s.value],"paste-url")}return a}function ys(A,e){if(A.stores.projectStore.projectLicenseType===pi())return A.stores.modalStore.set({type:"UpsellEnterprise",source:"upsell",description:"Sign up for an Enterprise plan to increase your file upload limit to 150MB and unlock other powerful features that help scale your site.",upsell:"file-limit-enterprise-upsell",upsellFeatures:["Advanced Permissions","Custom Limits","Custom Hosting","Custom Proxy Support","Enterprise Security","Dedicated Support"]});let j=A.stores.projectStore.resourceLimits?.fileUploadLimitInMB;I(typeof j=="number","fileUploadLimitInMB is not a number");let t=j.toLocaleString()+"MB",r=(e/na).toLocaleString(void 0,{minimumFractionDigits:0,maximumFractionDigits:1})+"MB";return A.stores.modalStore.set({source:"upsell",type:"UpsellFeature",upsellFeature:"fileUploadLimitInMB",title:"File Upload Limit",description:`Your current plan limits file uploads to ${t}, and you\u2019re trying to upload a file that\u2019s ${r}. Upgrade your site to increase the limit and upload your file.`})}var Ss=class{constructor(e,{concurrency:j=5,silent:t=!1}={}){this.engine=e;T(this,"uploads",new Map);T(this,"completed",0);T(this,"failed",0);T(this,"generating",!1);T(this,"resolveStatusUpdate");T(this,"limiter");T(this,"silent");this.limiter=new Wj(j),this.silent=t}add(e){return this.createTask(e,j=>j)()}createTask(e,j){let t=this.uploads.get(e);t||(t={task:async()=>{try{return typeof e=="string"?e.startsWith("data:")?await this.uploadFile(await Ui(e,"imported")):await ge.uploadAssetByURL(e,{silent:this.silent,refreshAssetService:!1}):await this.uploadFile(e)}catch(n){throw this.failed++,n}finally{this.completed++,this.resolveStatusUpdate?.()}}},this.uploads.set(e,t));let r=t;return async()=>{r.resultPromise||(r.resultPromise=this.limiter.run(r.task),this.resolveStatusUpdate?.());let o=await r.resultPromise;return this.engine.stores.assetStore.assetService?.addAssets([o.asset]),j(o)}}async uploadFile(e){let j=this.engine.stores.projectStore.resourceLimits?.fileUploadLimitInMB??void 0,t={silent:this.silent,maxFileSize:j,onExceedsCustomMaxSize:o=>ys(this.engine,o),refreshAssetService:!1},r;if(e.type.startsWith("image/")?r=await ge.uploadImage(e,t):e.type.startsWith("video/")?r=await ge.uploadVideo(e,t):r=await ge.uploadFile(e,t),!r)throw Error("Failed to upload file");return r}get active(){return[...this.uploads.values()].map(({resultPromise:e})=>e).filter(to)}get status(){let{active:e,completed:j,failed:t}=this;return{started:e.length,completed:j,failed:t}}async*statusUpdates(){if(this.generating)throw Error("`statusUpdates` is in use by another call");for(this.generating=!0,yield this.status;this.completed<this.active.length;)await new Promise(e=>{this.resolveStatusUpdate=()=>{e(),this.resolveStatusUpdate=void 0}}),yield this.status;await this.engine.stores.assetStore.assetService?.refresh().catch(EA),this.generating=!1}async results(){let e=await Promise.allSettled(this.active).then(j=>j.filter(no).map(t=>t.value));return await this.engine.stores.assetStore.assetService?.refresh().catch(EA),e}};var Sc={}.hasOwnProperty;function f6(A,e){let j=-1,t;if(e.extensions)for(;++j<e.extensions.length;)f6(A,e.extensions[j]);for(t in e)if(Sc.call(e,t))switch(t){case"extensions":break;case"unsafe":{Ms(A[t],e[t]);break}case"join":{Ms(A[t],e[t]);break}case"handlers":{Mc(A[t],e[t]);break}default:A.options[t]=e[t]}return A}function Ms(A,e){e&&A.push(...e)}function Mc(A,e){e&&Object.assign(A,e)}function Os(A,e,j,t){let r=j.enter("blockquote"),o=j.createTracker(t);o.move("> "),o.shift(2);let n=j.indentLines(j.containerFlow(A,o.current()),Oc);return r(),n}function Oc(A,e,j){return">"+(j?"":" ")+A}function vt(A,e){return Ps(A,e.inConstruct,!0)&&!Ps(A,e.notInConstruct,!1)}function Ps(A,e,j){if(typeof e=="string"&&(e=[e]),!e||e.length===0)return j;let t=-1;for(;++t<e.length;)if(A.includes(e[t]))return!0;return!1}function G6(A,e,j,t){let r=-1;for(;++r<j.unsafe.length;)if(j.unsafe[r].character===`
`&&vt(j.stack,j.unsafe[r]))return/[ \t]/.test(t.before)?"":" ";return`\\
`}function vs(A,e){let j=String(A),t=j.indexOf(e),r=t,o=0,n=0;if(typeof e!="string")throw new TypeError("Expected substring");for(;t!==-1;)t===r?++o>n&&(n=o):o=1,r=t+e.length,t=j.indexOf(e,r);return n}function Ke(A,e){return!!(e.options.fences===!1&&A.value&&!A.lang&&/[^ \r\n]/.test(A.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(A.value))}function xs(A){let e=A.options.fence||"`";if(e!=="`"&&e!=="~")throw new Error("Cannot serialize code with `"+e+"` for `options.fence`, expected `` ` `` or `~`");return e}function Cs(A,e,j,t){let r=xs(j),o=A.value||"",n=r==="`"?"GraveAccent":"Tilde";if(Ke(A,j)){let k=j.enter("codeIndented"),c=j.indentLines(o,Pc);return k(),c}let i=j.createTracker(t),a=r.repeat(Math.max(vs(o,r)+1,3)),s=j.enter("codeFenced"),l=i.move(a);if(A.lang){let k=j.enter(`codeFencedLang${n}`);l+=i.move(j.safe(A.lang,{before:l,after:" ",encode:["`"],...i.current()})),k()}if(A.lang&&A.meta){let k=j.enter(`codeFencedMeta${n}`);l+=i.move(" "),l+=i.move(j.safe(A.meta,{before:l,after:`
`,encode:["`"],...i.current()})),k()}return l+=i.move(`
`),o&&(l+=i.move(o+`
`)),l+=i.move(a),s(),l}function Pc(A,e,j){return(j?"":"    ")+A}function Zj(A){let e=A.options.quote||'"';if(e!=='"'&&e!=="'")throw new Error("Cannot serialize title with `"+e+"` for `options.quote`, expected `\"`, or `'`");return e}function Ts(A,e,j,t){let r=Zj(j),o=r==='"'?"Quote":"Apostrophe",n=j.enter("definition"),i=j.enter("label"),a=j.createTracker(t),s=a.move("[");return s+=a.move(j.safe(j.associationId(A),{before:s,after:"]",...a.current()})),s+=a.move("]: "),i(),!A.url||/[\0- \u007F]/.test(A.url)?(i=j.enter("destinationLiteral"),s+=a.move("<"),s+=a.move(j.safe(A.url,{before:s,after:">",...a.current()})),s+=a.move(">")):(i=j.enter("destinationRaw"),s+=a.move(j.safe(A.url,{before:s,after:A.title?" ":`
`,...a.current()}))),i(),A.title&&(i=j.enter(`title${o}`),s+=a.move(" "+r),s+=a.move(j.safe(A.title,{before:s,after:r,...a.current()})),s+=a.move(r),i()),n(),s}function Ds(A){let e=A.options.emphasis||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize emphasis with `"+e+"` for `options.emphasis`, expected `*`, or `_`");return e}R6.peek=vc;function R6(A,e,j,t){let r=Ds(j),o=j.enter("emphasis"),n=j.createTracker(t),i=n.move(r);return i+=n.move(j.containerPhrasing(A,{before:i,after:r,...n.current()})),i+=n.move(r),o(),i}function vc(A,e,j){return j.options.emphasis||"*"}var xc={};function Sj(A,e){let j=e||xc,t=typeof j.includeImageAlt=="boolean"?j.includeImageAlt:!0,r=typeof j.includeHtml=="boolean"?j.includeHtml:!0;return qs(A,t,r)}function qs(A,e,j){if(Cc(A)){if("value"in A)return A.type==="html"&&!j?"":A.value;if(e&&"alt"in A&&A.alt)return A.alt;if("children"in A)return ws(A.children,e,j)}return Array.isArray(A)?ws(A,e,j):""}function ws(A,e,j){let t=[],r=-1;for(;++r<A.length;)t[r]=qs(A[r],e,j);return t.join("")}function Cc(A){return!!(A&&typeof A=="object")}function xt(A,e){let j=!1;return nt(A,function(t){if("value"in t&&/\r?\n|\r/.test(t.value)||t.type==="break")return j=!0,bo}),!!((!A.depth||A.depth<3)&&Sj(A)&&(e.options.setext||j))}function Ns(A,e,j,t){let r=Math.max(Math.min(6,A.depth||1),1),o=j.createTracker(t);if(xt(A,j)){let l=j.enter("headingSetext"),k=j.enter("phrasing"),c=j.containerPhrasing(A,{...o.current(),before:`
`,after:`
`});return k(),l(),c+`
`+(r===1?"=":"-").repeat(c.length-(Math.max(c.lastIndexOf("\r"),c.lastIndexOf(`
`))+1))}let n="#".repeat(r),i=j.enter("headingAtx"),a=j.enter("phrasing");o.move(n+" ");let s=j.containerPhrasing(A,{before:"# ",after:`
`,...o.current()});return/^[\t ]/.test(s)&&(s="&#x"+s.charCodeAt(0).toString(16).toUpperCase()+";"+s.slice(1)),s=s?n+" "+s:n,j.options.closeAtx&&(s+=" "+n),a(),i(),s}F6.peek=Tc;function F6(A){return A.value||""}function Tc(){return"<"}I6.peek=Dc;function I6(A,e,j,t){let r=Zj(j),o=r==='"'?"Quote":"Apostrophe",n=j.enter("image"),i=j.enter("label"),a=j.createTracker(t),s=a.move("![");return s+=a.move(j.safe(A.alt,{before:s,after:"]",...a.current()})),s+=a.move("]("),i(),!A.url&&A.title||/[\0- \u007F]/.test(A.url)?(i=j.enter("destinationLiteral"),s+=a.move("<"),s+=a.move(j.safe(A.url,{before:s,after:">",...a.current()})),s+=a.move(">")):(i=j.enter("destinationRaw"),s+=a.move(j.safe(A.url,{before:s,after:A.title?" ":")",...a.current()}))),i(),A.title&&(i=j.enter(`title${o}`),s+=a.move(" "+r),s+=a.move(j.safe(A.title,{before:s,after:r,...a.current()})),s+=a.move(r),i()),s+=a.move(")"),n(),s}function Dc(){return"!"}h6.peek=wc;function h6(A,e,j,t){let r=A.referenceType,o=j.enter("imageReference"),n=j.enter("label"),i=j.createTracker(t),a=i.move("!["),s=j.safe(A.alt,{before:a,after:"]",...i.current()});a+=i.move(s+"]["),n();let l=j.stack;j.stack=[],n=j.enter("reference");let k=j.safe(j.associationId(A),{before:a,after:"]",...i.current()});return n(),j.stack=l,o(),r==="full"||!s||s!==k?a+=i.move(k+"]"):r==="shortcut"?a=a.slice(0,-1):a+=i.move("]"),a}function wc(){return"!"}g6.peek=qc;function g6(A,e,j){let t=A.value||"",r="`",o=-1;for(;new RegExp("(^|[^`])"+r+"([^`]|$)").test(t);)r+="`";for(/[^ \r\n]/.test(t)&&(/^[ \r\n]/.test(t)&&/[ \r\n]$/.test(t)||/^`|`$/.test(t))&&(t=" "+t+" ");++o<j.unsafe.length;){let n=j.unsafe[o],i=j.compilePattern(n),a;if(n.atBreak)for(;a=i.exec(t);){let s=a.index;t.charCodeAt(s)===10&&t.charCodeAt(s-1)===13&&s--,t=t.slice(0,s)+" "+t.slice(a.index+1)}}return r+t+r}function qc(){return"`"}function b6(A,e){let j=Sj(A);return!!(!e.options.resourceLink&&A.url&&!A.title&&A.children&&A.children.length===1&&A.children[0].type==="text"&&(j===A.url||"mailto:"+j===A.url)&&/^[a-z][a-z+.-]+:/i.test(A.url)&&!/[\0- <>\u007F]/.test(A.url))}_6.peek=Nc;function _6(A,e,j,t){let r=Zj(j),o=r==='"'?"Quote":"Apostrophe",n=j.createTracker(t),i,a;if(b6(A,j)){let l=j.stack;j.stack=[],i=j.enter("autolink");let k=n.move("<");return k+=n.move(j.containerPhrasing(A,{before:k,after:">",...n.current()})),k+=n.move(">"),i(),j.stack=l,k}i=j.enter("link"),a=j.enter("label");let s=n.move("[");return s+=n.move(j.containerPhrasing(A,{before:s,after:"](",...n.current()})),s+=n.move("]("),a(),!A.url&&A.title||/[\0- \u007F]/.test(A.url)?(a=j.enter("destinationLiteral"),s+=n.move("<"),s+=n.move(j.safe(A.url,{before:s,after:">",...n.current()})),s+=n.move(">")):(a=j.enter("destinationRaw"),s+=n.move(j.safe(A.url,{before:s,after:A.title?" ":")",...n.current()}))),a(),A.title&&(a=j.enter(`title${o}`),s+=n.move(" "+r),s+=n.move(j.safe(A.title,{before:s,after:r,...n.current()})),s+=n.move(r),a()),s+=n.move(")"),i(),s}function Nc(A,e,j){return b6(A,j)?"<":"["}y6.peek=Kc;function y6(A,e,j,t){let r=A.referenceType,o=j.enter("linkReference"),n=j.enter("label"),i=j.createTracker(t),a=i.move("["),s=j.containerPhrasing(A,{before:a,after:"]",...i.current()});a+=i.move(s+"]["),n();let l=j.stack;j.stack=[],n=j.enter("reference");let k=j.safe(j.associationId(A),{before:a,after:"]",...i.current()});return n(),j.stack=l,o(),r==="full"||!s||s!==k?a+=i.move(k+"]"):r==="shortcut"?a=a.slice(0,-1):a+=i.move("]"),a}function Kc(){return"["}function Ae(A){let e=A.options.bullet||"*";if(e!=="*"&&e!=="+"&&e!=="-")throw new Error("Cannot serialize items with `"+e+"` for `options.bullet`, expected `*`, `+`, or `-`");return e}function Ks(A){let e=Ae(A),j=A.options.bulletOther;if(!j)return e==="*"?"-":"*";if(j!=="*"&&j!=="+"&&j!=="-")throw new Error("Cannot serialize items with `"+j+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(j===e)throw new Error("Expected `bullet` (`"+e+"`) and `bulletOther` (`"+j+"`) to be different");return j}function Ls(A){let e=A.options.bulletOrdered||".";if(e!=="."&&e!==")")throw new Error("Cannot serialize items with `"+e+"` for `options.bulletOrdered`, expected `.` or `)`");return e}function Ct(A){let e=A.options.rule||"*";if(e!=="*"&&e!=="-"&&e!=="_")throw new Error("Cannot serialize rules with `"+e+"` for `options.rule`, expected `*`, `-`, or `_`");return e}function Js(A,e,j,t){let r=j.enter("list"),o=j.bulletCurrent,n=A.ordered?Ls(j):Ae(j),i=A.ordered?n==="."?")":".":Ks(j),a=e&&j.bulletLastUsed?n===j.bulletLastUsed:!1;if(!A.ordered){let l=A.children?A.children[0]:void 0;if((n==="*"||n==="-")&&l&&(!l.children||!l.children[0])&&j.stack[j.stack.length-1]==="list"&&j.stack[j.stack.length-2]==="listItem"&&j.stack[j.stack.length-3]==="list"&&j.stack[j.stack.length-4]==="listItem"&&j.indexStack[j.indexStack.length-1]===0&&j.indexStack[j.indexStack.length-2]===0&&j.indexStack[j.indexStack.length-3]===0&&(a=!0),Ct(j)===n&&l){let k=-1;for(;++k<A.children.length;){let c=A.children[k];if(c&&c.type==="listItem"&&c.children&&c.children[0]&&c.children[0].type==="thematicBreak"){a=!0;break}}}}a&&(n=i),j.bulletCurrent=n;let s=j.containerFlow(A,t);return j.bulletLastUsed=n,j.bulletCurrent=o,r(),s}function Hs(A){let e=A.options.listItemIndent||"one";if(e!=="tab"&&e!=="one"&&e!=="mixed")throw new Error("Cannot serialize items with `"+e+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return e}function Qs(A,e,j,t){let r=Hs(j),o=j.bulletCurrent||Ae(j);e&&e.type==="list"&&e.ordered&&(o=(typeof e.start=="number"&&e.start>-1?e.start:1)+(j.options.incrementListMarker===!1?0:e.children.indexOf(A))+o);let n=o.length+1;(r==="tab"||r==="mixed"&&(e&&e.type==="list"&&e.spread||A.spread))&&(n=Math.ceil(n/4)*4);let i=j.createTracker(t);i.move(o+" ".repeat(n-o.length)),i.shift(n);let a=j.enter("listItem"),s=j.indentLines(j.containerFlow(A,i.current()),l);return a(),s;function l(k,c,d){return c?(d?"":" ".repeat(n))+k:(d?o:o+" ".repeat(n-o.length))+k}}function Us(A,e,j,t){let r=j.enter("paragraph"),o=j.enter("phrasing"),n=j.containerPhrasing(A,t);return o(),r(),n}function Vs(A,e,j,t){return(A.children.some(function(n){return So(n)})?j.containerPhrasing:j.containerFlow).call(j,A,t)}function Xs(A){let e=A.options.strong||"*";if(e!=="*"&&e!=="_")throw new Error("Cannot serialize strong with `"+e+"` for `options.strong`, expected `*`, or `_`");return e}S6.peek=Lc;function S6(A,e,j,t){let r=Xs(j),o=j.enter("strong"),n=j.createTracker(t),i=n.move(r+r);return i+=n.move(j.containerPhrasing(A,{before:i,after:r,...n.current()})),i+=n.move(r+r),o(),i}function Lc(A,e,j){return j.options.strong||"*"}function zs(A,e,j,t){return j.safe(A.value,t)}function Ws(A){let e=A.options.ruleRepetition||3;if(e<3)throw new Error("Cannot serialize rules with repetition `"+e+"` for `options.ruleRepetition`, expected `3` or more");return e}function Ys(A,e,j){let t=(Ct(j)+(j.options.ruleSpaces?" ":"")).repeat(Ws(j));return j.options.ruleSpaces?t.slice(0,-1):t}var oj={blockquote:Os,break:G6,code:Cs,definition:Ts,emphasis:R6,hardBreak:G6,heading:Ns,html:F6,image:I6,imageReference:h6,inlineCode:g6,link:_6,linkReference:y6,list:Js,listItem:Qs,paragraph:Us,root:Vs,strong:S6,text:zs,thematicBreak:Ys};var Zs=[Jc];function Jc(A,e,j,t){if(e.type==="code"&&Ke(e,t)&&(A.type==="list"||A.type===e.type&&Ke(A,t)))return!1;if("spread"in j&&typeof j.spread=="boolean")return A.type==="paragraph"&&(A.type===e.type||e.type==="definition"||e.type==="heading"&&xt(e,t))?void 0:j.spread?1:0}var Mj=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"],A7=[{character:"	",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",before:"[\\r\\n]",inConstruct:"phrasing"},{character:"	",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"\r",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:`
`,inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde","codeFencedMetaGraveAccent","codeFencedMetaTilde","destinationLiteral","headingAtx"]},{character:" ",after:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",before:"[\\r\\n]",inConstruct:"phrasing"},{character:" ",inConstruct:["codeFencedLangGraveAccent","codeFencedLangTilde"]},{character:"!",after:"\\[",inConstruct:"phrasing",notInConstruct:Mj},{character:'"',inConstruct:"titleQuote"},{atBreak:!0,character:"#"},{character:"#",inConstruct:"headingAtx",after:`(?:[\r
]|$)`},{character:"&",after:"[#A-Za-z]",inConstruct:"phrasing"},{character:"'",inConstruct:"titleApostrophe"},{character:"(",inConstruct:"destinationRaw"},{before:"\\]",character:"(",inConstruct:"phrasing",notInConstruct:Mj},{atBreak:!0,before:"\\d+",character:")"},{character:")",inConstruct:"destinationRaw"},{atBreak:!0,character:"*",after:`(?:[ 	\r
*])`},{character:"*",inConstruct:"phrasing",notInConstruct:Mj},{atBreak:!0,character:"+",after:`(?:[ 	\r
])`},{atBreak:!0,character:"-",after:`(?:[ 	\r
-])`},{atBreak:!0,before:"\\d+",character:".",after:`(?:[ 	\r
]|$)`},{atBreak:!0,character:"<",after:"[!/?A-Za-z]"},{character:"<",after:"[!/?A-Za-z]",inConstruct:"phrasing",notInConstruct:Mj},{character:"<",inConstruct:"destinationLiteral"},{atBreak:!0,character:"="},{atBreak:!0,character:">"},{character:">",inConstruct:"destinationLiteral"},{atBreak:!0,character:"["},{character:"[",inConstruct:"phrasing",notInConstruct:Mj},{character:"[",inConstruct:["label","reference"]},{character:"\\",after:"[\\r\\n]",inConstruct:"phrasing"},{character:"]",inConstruct:["label","reference"]},{atBreak:!0,character:"_"},{character:"_",inConstruct:"phrasing",notInConstruct:Mj},{atBreak:!0,character:"`"},{character:"`",inConstruct:["codeFencedLangGraveAccent","codeFencedMetaGraveAccent"]},{character:"`",inConstruct:"phrasing",notInConstruct:Mj},{atBreak:!0,character:"~"}];var j7=document.createElement("i");function je(A){let e="&"+A+";";j7.innerHTML=e;let j=j7.textContent;return j.charCodeAt(j.length-1)===59&&A!=="semi"||j===e?!1:j}function Tt(A,e){let j=Number.parseInt(A,e);return j<9||j===11||j>13&&j<32||j>126&&j<160||j>55295&&j<57344||j>64975&&j<65008||(j&65535)===65535||(j&65535)===65534||j>1114111?"\uFFFD":String.fromCodePoint(j)}var Hc=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Dt(A){return A.replace(Hc,Qc)}function Qc(A,e,j){if(e)return e;if(j.charCodeAt(0)===35){let r=j.charCodeAt(1),o=r===120||r===88;return Tt(j.slice(o?2:1),o?16:10)}return je(j)||A}function e7(A){return A.label||!A.identifier?A.label||"":Dt(A.identifier)}function t7(A){if(!A._compiled){let e=(A.atBreak?"[\\r\\n][\\t ]*":"")+(A.before?"(?:"+A.before+")":"");A._compiled=new RegExp((e?"("+e+")":"")+(/[|\\{}()[\]^$+*?.-]/.test(A.character)?"\\":"")+A.character+(A.after?"(?:"+A.after+")":""),"g")}return A._compiled}function r7(A,e,j){let t=e.indexStack,r=A.children||[],o=[],n=-1,i=j.before;t.push(-1);let a=e.createTracker(j);for(;++n<r.length;){let s=r[n],l;if(t[t.length-1]=n,n+1<r.length){let k=e.handle.handlers[r[n+1].type];k&&k.peek&&(k=k.peek),l=k?k(r[n+1],A,e,{before:"",after:"",...a.current()}).charAt(0):""}else l=j.after;o.length>0&&(i==="\r"||i===`
`)&&s.type==="html"&&(o[o.length-1]=o[o.length-1].replace(/(\r?\n|\r)$/," "),i=" ",a=e.createTracker(j),a.move(o.join(""))),o.push(a.move(e.handle(s,A,e,{...a.current(),before:i,after:l}))),i=o[o.length-1].slice(-1)}return t.pop(),o.join("")}function n7(A,e,j){let t=e.indexStack,r=A.children||[],o=e.createTracker(j),n=[],i=-1;for(t.push(-1);++i<r.length;){let a=r[i];t[t.length-1]=i,n.push(o.move(e.handle(a,A,e,{before:`
`,after:`
`,...o.current()}))),a.type!=="list"&&(e.bulletLastUsed=void 0),i<r.length-1&&n.push(o.move(Uc(a,r[i+1],A,e)))}return t.pop(),n.join("")}function Uc(A,e,j,t){let r=t.join.length;for(;r--;){let o=t.join[r](A,e,j,t);if(o===!0||o===1)break;if(typeof o=="number")return`
`.repeat(1+o);if(o===!1)return`

<!---->

`}return`

`}var Vc=/\r?\n|\r/g;function o7(A,e){let j=[],t=0,r=0,o;for(;o=Vc.exec(A);)n(A.slice(t,o.index)),j.push(o[0]),t=o.index+o[0].length,r++;return n(A.slice(t)),j.join("");function n(i){j.push(e(i,r,!i))}}function a7(A,e,j){let t=(j.before||"")+(e||"")+(j.after||""),r=[],o=[],n={},i=-1;for(;++i<A.unsafe.length;){let l=A.unsafe[i];if(!vt(A.stack,l))continue;let k=A.compilePattern(l),c;for(;c=k.exec(t);){let d="before"in l||!!l.atBreak,$="after"in l,B=c.index+(d?c[1].length:0);r.includes(B)?(n[B].before&&!d&&(n[B].before=!1),n[B].after&&!$&&(n[B].after=!1)):(r.push(B),n[B]={before:d,after:$})}}r.sort(Xc);let a=j.before?j.before.length:0,s=t.length-(j.after?j.after.length:0);for(i=-1;++i<r.length;){let l=r[i];l<a||l>=s||l+1<s&&r[i+1]===l+1&&n[l].after&&!n[l+1].before&&!n[l+1].after||r[i-1]===l-1&&n[l].before&&!n[l-1].before&&!n[l-1].after||(a!==l&&o.push(i7(t.slice(a,l),"\\")),a=l,/[!-/:-@[-`{-~]/.test(t.charAt(l))&&(!j.encode||!j.encode.includes(t.charAt(l)))?o.push("\\"):(o.push("&#x"+t.charCodeAt(l).toString(16).toUpperCase()+";"),a++))}return o.push(i7(t.slice(a,s),j.after)),o.join("")}function Xc(A,e){return A-e}function i7(A,e){let j=/\\(?=[!-/:-@[-`{-~])/g,t=[],r=[],o=A+e,n=-1,i=0,a;for(;a=j.exec(o);)t.push(a.index);for(;++n<t.length;)i!==t[n]&&r.push(A.slice(i,t[n])),r.push("\\"),i=t[n];return r.push(A.slice(i)),r.join("")}function s7(A){let e=A||{},j=e.now||{},t=e.lineShift||0,r=j.line||1,o=j.column||1;return{move:a,current:n,shift:i};function n(){return{now:{line:r,column:o},lineShift:t}}function i(s){t+=s}function a(s){let l=s||"",k=l.split(/\r?\n|\r/g),c=k[k.length-1];return r+=k.length-1,o=k.length===1?o+c.length:1+c.length+t,l}}function M6(A,e={}){let j={enter:r,indentLines:o7,associationId:e7,containerPhrasing:Zc,containerFlow:Ad,createTracker:s7,compilePattern:t7,safe:jd,stack:[],unsafe:[...A7],join:[...Zs],handlers:{...oj},options:{},indexStack:[],handle:void 0};f6(j,e),j.options.tightDefinitions&&j.join.push(Yc),j.handle=ot("type",{invalid:zc,unknown:Wc,handlers:j.handlers});let t=j.handle(A,void 0,j,{before:`
`,after:`
`,now:{line:1,column:1},lineShift:0});return t&&t.charCodeAt(t.length-1)!==10&&t.charCodeAt(t.length-1)!==13&&(t+=`
`),t;function r(o){return j.stack.push(o),n;function n(){j.stack.pop()}}}function zc(A){throw new Error("Cannot handle value `"+A+"`, expected node")}function Wc(A){let e=A;throw new Error("Cannot handle unknown node `"+e.type+"`")}function Yc(A,e){if(A.type==="definition"&&A.type===e.type)return 0}function Zc(A,e){return r7(A,this,e)}function Ad(A,e){return n7(A,this,e)}function jd(A,e){return a7(this,A,e)}var l7=["area","base","basefont","bgsound","br","col","command","embed","frame","hr","image","img","input","keygen","link","meta","param","source","track","wbr"];var ed=/["&'<>`]/g,td=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,rd=/[\x01-\t\v\f\x0E-\x1F\x7F\x81\x8D\x8F\x90\x9D\xA0-\uFFFF]/g,nd=/[|\\{}()[\]^$+*?.]/g,k7=new WeakMap;function c7(A,e){if(A=A.replace(e.subset?od(e.subset):ed,t),e.subset||e.escapeOnly)return A;return A.replace(td,j).replace(rd,t);function j(r,o,n){return e.format((r.charCodeAt(0)-55296)*1024+r.charCodeAt(1)-56320+65536,n.charCodeAt(o+2),e)}function t(r,o,n){return e.format(r.charCodeAt(0),n.charCodeAt(o+1),e)}}function od(A){let e=k7.get(A);return e||(e=id(A),k7.set(A,e)),e}function id(A){let e=[],j=-1;for(;++j<A.length;)e.push(A[j].replace(nd,"\\$&"));return new RegExp("(?:"+e.join("|")+")","g")}var ad=/[\dA-Fa-f]/;function d7(A,e,j){let t="&#x"+A.toString(16).toUpperCase();return j&&e&&!ad.test(String.fromCharCode(e))?t:t+";"}var sd=/\d/;function $7(A,e,j){let t="&#"+String(A);return j&&e&&!sd.test(String.fromCharCode(e))?t:t+";"}var E7=["AElig","AMP","Aacute","Acirc","Agrave","Aring","Atilde","Auml","COPY","Ccedil","ETH","Eacute","Ecirc","Egrave","Euml","GT","Iacute","Icirc","Igrave","Iuml","LT","Ntilde","Oacute","Ocirc","Ograve","Oslash","Otilde","Ouml","QUOT","REG","THORN","Uacute","Ucirc","Ugrave","Uuml","Yacute","aacute","acirc","acute","aelig","agrave","amp","aring","atilde","auml","brvbar","ccedil","cedil","cent","copy","curren","deg","divide","eacute","ecirc","egrave","eth","euml","frac12","frac14","frac34","gt","iacute","icirc","iexcl","igrave","iquest","iuml","laquo","lt","macr","micro","middot","nbsp","not","ntilde","oacute","ocirc","ograve","ordf","ordm","oslash","otilde","ouml","para","plusmn","pound","quot","raquo","reg","sect","shy","sup1","sup2","sup3","szlig","thorn","times","uacute","ucirc","ugrave","uml","uuml","yacute","yen","yuml"];var wt={nbsp:"\xA0",iexcl:"\xA1",cent:"\xA2",pound:"\xA3",curren:"\xA4",yen:"\xA5",brvbar:"\xA6",sect:"\xA7",uml:"\xA8",copy:"\xA9",ordf:"\xAA",laquo:"\xAB",not:"\xAC",shy:"\xAD",reg:"\xAE",macr:"\xAF",deg:"\xB0",plusmn:"\xB1",sup2:"\xB2",sup3:"\xB3",acute:"\xB4",micro:"\xB5",para:"\xB6",middot:"\xB7",cedil:"\xB8",sup1:"\xB9",ordm:"\xBA",raquo:"\xBB",frac14:"\xBC",frac12:"\xBD",frac34:"\xBE",iquest:"\xBF",Agrave:"\xC0",Aacute:"\xC1",Acirc:"\xC2",Atilde:"\xC3",Auml:"\xC4",Aring:"\xC5",AElig:"\xC6",Ccedil:"\xC7",Egrave:"\xC8",Eacute:"\xC9",Ecirc:"\xCA",Euml:"\xCB",Igrave:"\xCC",Iacute:"\xCD",Icirc:"\xCE",Iuml:"\xCF",ETH:"\xD0",Ntilde:"\xD1",Ograve:"\xD2",Oacute:"\xD3",Ocirc:"\xD4",Otilde:"\xD5",Ouml:"\xD6",times:"\xD7",Oslash:"\xD8",Ugrave:"\xD9",Uacute:"\xDA",Ucirc:"\xDB",Uuml:"\xDC",Yacute:"\xDD",THORN:"\xDE",szlig:"\xDF",agrave:"\xE0",aacute:"\xE1",acirc:"\xE2",atilde:"\xE3",auml:"\xE4",aring:"\xE5",aelig:"\xE6",ccedil:"\xE7",egrave:"\xE8",eacute:"\xE9",ecirc:"\xEA",euml:"\xEB",igrave:"\xEC",iacute:"\xED",icirc:"\xEE",iuml:"\xEF",eth:"\xF0",ntilde:"\xF1",ograve:"\xF2",oacute:"\xF3",ocirc:"\xF4",otilde:"\xF5",ouml:"\xF6",divide:"\xF7",oslash:"\xF8",ugrave:"\xF9",uacute:"\xFA",ucirc:"\xFB",uuml:"\xFC",yacute:"\xFD",thorn:"\xFE",yuml:"\xFF",fnof:"\u0192",Alpha:"\u0391",Beta:"\u0392",Gamma:"\u0393",Delta:"\u0394",Epsilon:"\u0395",Zeta:"\u0396",Eta:"\u0397",Theta:"\u0398",Iota:"\u0399",Kappa:"\u039A",Lambda:"\u039B",Mu:"\u039C",Nu:"\u039D",Xi:"\u039E",Omicron:"\u039F",Pi:"\u03A0",Rho:"\u03A1",Sigma:"\u03A3",Tau:"\u03A4",Upsilon:"\u03A5",Phi:"\u03A6",Chi:"\u03A7",Psi:"\u03A8",Omega:"\u03A9",alpha:"\u03B1",beta:"\u03B2",gamma:"\u03B3",delta:"\u03B4",epsilon:"\u03B5",zeta:"\u03B6",eta:"\u03B7",theta:"\u03B8",iota:"\u03B9",kappa:"\u03BA",lambda:"\u03BB",mu:"\u03BC",nu:"\u03BD",xi:"\u03BE",omicron:"\u03BF",pi:"\u03C0",rho:"\u03C1",sigmaf:"\u03C2",sigma:"\u03C3",tau:"\u03C4",upsilon:"\u03C5",phi:"\u03C6",chi:"\u03C7",psi:"\u03C8",omega:"\u03C9",thetasym:"\u03D1",upsih:"\u03D2",piv:"\u03D6",bull:"\u2022",hellip:"\u2026",prime:"\u2032",Prime:"\u2033",oline:"\u203E",frasl:"\u2044",weierp:"\u2118",image:"\u2111",real:"\u211C",trade:"\u2122",alefsym:"\u2135",larr:"\u2190",uarr:"\u2191",rarr:"\u2192",darr:"\u2193",harr:"\u2194",crarr:"\u21B5",lArr:"\u21D0",uArr:"\u21D1",rArr:"\u21D2",dArr:"\u21D3",hArr:"\u21D4",forall:"\u2200",part:"\u2202",exist:"\u2203",empty:"\u2205",nabla:"\u2207",isin:"\u2208",notin:"\u2209",ni:"\u220B",prod:"\u220F",sum:"\u2211",minus:"\u2212",lowast:"\u2217",radic:"\u221A",prop:"\u221D",infin:"\u221E",ang:"\u2220",and:"\u2227",or:"\u2228",cap:"\u2229",cup:"\u222A",int:"\u222B",there4:"\u2234",sim:"\u223C",cong:"\u2245",asymp:"\u2248",ne:"\u2260",equiv:"\u2261",le:"\u2264",ge:"\u2265",sub:"\u2282",sup:"\u2283",nsub:"\u2284",sube:"\u2286",supe:"\u2287",oplus:"\u2295",otimes:"\u2297",perp:"\u22A5",sdot:"\u22C5",lceil:"\u2308",rceil:"\u2309",lfloor:"\u230A",rfloor:"\u230B",lang:"\u2329",rang:"\u232A",loz:"\u25CA",spades:"\u2660",clubs:"\u2663",hearts:"\u2665",diams:"\u2666",quot:'"',amp:"&",lt:"<",gt:">",OElig:"\u0152",oelig:"\u0153",Scaron:"\u0160",scaron:"\u0161",Yuml:"\u0178",circ:"\u02C6",tilde:"\u02DC",ensp:"\u2002",emsp:"\u2003",thinsp:"\u2009",zwnj:"\u200C",zwj:"\u200D",lrm:"\u200E",rlm:"\u200F",ndash:"\u2013",mdash:"\u2014",lsquo:"\u2018",rsquo:"\u2019",sbquo:"\u201A",ldquo:"\u201C",rdquo:"\u201D",bdquo:"\u201E",dagger:"\u2020",Dagger:"\u2021",permil:"\u2030",lsaquo:"\u2039",rsaquo:"\u203A",euro:"\u20AC"};var B7=["cent","copy","divide","gt","lt","not","para","times"];var u7={}.hasOwnProperty,O6={},qt;for(qt in wt)u7.call(wt,qt)&&(O6[wt[qt]]=qt);var ld=/[^\dA-Za-z]/;function p7(A,e,j,t){let r=String.fromCharCode(A);if(u7.call(O6,r)){let o=O6[r],n="&"+o;return j&&E7.includes(o)&&!B7.includes(o)&&(!t||e&&e!==61&&ld.test(String.fromCharCode(e)))?n:n+";"}return""}function m7(A,e,j){let t=d7(A,e,j.omitOptionalSemicolons),r;if((j.useNamedReferences||j.useShortestReferences)&&(r=p7(A,e,j.omitOptionalSemicolons,j.attribute)),(j.useShortestReferences||!r)&&j.useShortestReferences){let o=$7(A,e,j.omitOptionalSemicolons);o.length<t.length&&(t=o)}return r&&(!j.useShortestReferences||r.length<t.length)?r:t}function ij(A,e){return c7(A,Object.assign({format:m7},e))}var kd=/^>|^->|<!--|-->|--!>|<!-$/g,cd=[">"],dd=["<",">"];function f7(A,e,j,t){return t.settings.bogusComments?"<?"+ij(A.value,Object.assign({},t.settings.characterReferences,{subset:cd}))+">":"<!--"+A.value.replace(kd,r)+"-->";function r(o){return ij(o,Object.assign({},t.settings.characterReferences,{subset:dd}))}}function G7(A,e,j,t){return"<!"+(t.settings.upperDoctype?"DOCTYPE":"doctype")+(t.settings.tightDoctype?"":" ")+"html>"}function ee(A,e){let j=String(A);if(typeof e!="string")throw new TypeError("Expected character");let t=0,r=j.indexOf(e);for(;r!==-1;)t++,r=j.indexOf(e,r+e.length);return t}var $d=/[ \t\n\f\r]/g;function Oj(A){return typeof A=="object"?A.type==="text"?R7(A.value):!1:R7(A)}function R7(A){return A.replace($d,"")===""}var sA=F7(1),P6=F7(-1),Ed=[];function F7(A){return e;function e(j,t,r){let o=j?j.children:Ed,n=(t||0)+A,i=o[n];if(!r)for(;i&&Oj(i);)n+=A,i=o[n];return i}}var Bd={}.hasOwnProperty;function Nt(A){return e;function e(j,t,r){return Bd.call(A,j.tagName)&&A[j.tagName](j,t,r)}}var Le=Nt({body:pd,caption:v6,colgroup:v6,dd:Rd,dt:Gd,head:v6,html:ud,li:fd,optgroup:Fd,option:Id,p:md,rp:I7,rt:I7,tbody:gd,td:h7,tfoot:bd,th:h7,thead:hd,tr:_d});function v6(A,e,j){let t=sA(j,e,!0);return!t||t.type!=="comment"&&!(t.type==="text"&&Oj(t.value.charAt(0)))}function ud(A,e,j){let t=sA(j,e);return!t||t.type!=="comment"}function pd(A,e,j){let t=sA(j,e);return!t||t.type!=="comment"}function md(A,e,j){let t=sA(j,e);return t?t.type==="element"&&(t.tagName==="address"||t.tagName==="article"||t.tagName==="aside"||t.tagName==="blockquote"||t.tagName==="details"||t.tagName==="div"||t.tagName==="dl"||t.tagName==="fieldset"||t.tagName==="figcaption"||t.tagName==="figure"||t.tagName==="footer"||t.tagName==="form"||t.tagName==="h1"||t.tagName==="h2"||t.tagName==="h3"||t.tagName==="h4"||t.tagName==="h5"||t.tagName==="h6"||t.tagName==="header"||t.tagName==="hgroup"||t.tagName==="hr"||t.tagName==="main"||t.tagName==="menu"||t.tagName==="nav"||t.tagName==="ol"||t.tagName==="p"||t.tagName==="pre"||t.tagName==="section"||t.tagName==="table"||t.tagName==="ul"):!j||!(j.type==="element"&&(j.tagName==="a"||j.tagName==="audio"||j.tagName==="del"||j.tagName==="ins"||j.tagName==="map"||j.tagName==="noscript"||j.tagName==="video"))}function fd(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&t.tagName==="li"}function Gd(A,e,j){let t=sA(j,e);return!!(t&&t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd"))}function Rd(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&(t.tagName==="dt"||t.tagName==="dd")}function I7(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&(t.tagName==="rp"||t.tagName==="rt")}function Fd(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&t.tagName==="optgroup"}function Id(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&(t.tagName==="option"||t.tagName==="optgroup")}function hd(A,e,j){let t=sA(j,e);return!!(t&&t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot"))}function gd(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&(t.tagName==="tbody"||t.tagName==="tfoot")}function bd(A,e,j){return!sA(j,e)}function _d(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&t.tagName==="tr"}function h7(A,e,j){let t=sA(j,e);return!t||t.type==="element"&&(t.tagName==="td"||t.tagName==="th")}var g7=Nt({body:Md,colgroup:Od,head:Sd,html:yd,tbody:Pd});function yd(A){let e=sA(A,-1);return!e||e.type!=="comment"}function Sd(A){let e=new Set;for(let t of A.children)if(t.type==="element"&&(t.tagName==="base"||t.tagName==="title")){if(e.has(t.tagName))return!1;e.add(t.tagName)}let j=A.children[0];return!j||j.type==="element"}function Md(A){let e=sA(A,-1,!0);return!e||e.type!=="comment"&&!(e.type==="text"&&Oj(e.value.charAt(0)))&&!(e.type==="element"&&(e.tagName==="meta"||e.tagName==="link"||e.tagName==="script"||e.tagName==="style"||e.tagName==="template"))}function Od(A,e,j){let t=P6(j,e),r=sA(A,-1,!0);return j&&t&&t.type==="element"&&t.tagName==="colgroup"&&Le(t,j.children.indexOf(t),j)?!1:!!(r&&r.type==="element"&&r.tagName==="col")}function Pd(A,e,j){let t=P6(j,e),r=sA(A,-1);return j&&t&&t.type==="element"&&(t.tagName==="thead"||t.tagName==="tbody")&&Le(t,j.children.indexOf(t),j)?!1:!!(r&&r.type==="element"&&r.tagName==="tr")}var Kt={name:[[`	
\f\r &/=>`.split(""),`	
\f\r "&'/=>\``.split("")],[`\0	
\f\r "&'/<=>`.split(""),`\0	
\f\r "&'/<=>\``.split("")]],unquoted:[[`	
\f\r &>`.split(""),`\0	
\f\r "&'<=>\``.split("")],[`\0	
\f\r "&'<=>\``.split(""),`\0	
\f\r "&'<=>\``.split("")]],single:[["&'".split(""),"\"&'`".split("")],["\0&'".split(""),"\0\"&'`".split("")]],double:[['"&'.split(""),"\"&'`".split("")],['\0"&'.split(""),"\0\"&'`".split("")]]};function b7(A,e,j,t){let r=t.schema,o=r.space==="svg"?!1:t.settings.omitOptionalTags,n=r.space==="svg"?t.settings.closeEmptyElements:t.settings.voids.includes(A.tagName.toLowerCase()),i=[],a;r.space==="html"&&A.tagName==="svg"&&(t.schema=Rt);let s=vd(t,A.properties),l=t.all(r.space==="html"&&A.tagName==="template"?A.content:A);return t.schema=r,l&&(n=!1),(s||!o||!g7(A,e,j))&&(i.push("<",A.tagName,s?" "+s:""),n&&(r.space==="svg"||t.settings.closeSelfClosing)&&(a=s.charAt(s.length-1),(!t.settings.tightSelfClosing||a==="/"||a&&a!=='"'&&a!=="'")&&i.push(" "),i.push("/")),i.push(">")),i.push(l),!n&&(!o||!Le(A,e,j))&&i.push("</"+A.tagName+">"),i.join("")}function vd(A,e){let j=[],t=-1,r;if(e){for(r in e)if(e[r]!==null&&e[r]!==void 0){let o=xd(A,r,e[r]);o&&j.push(o)}}for(;++t<j.length;){let o=A.settings.tightAttributes?j[t].charAt(j[t].length-1):void 0;t!==j.length-1&&o!=='"'&&o!=="'"&&(j[t]+=" ")}return j.join("")}function xd(A,e,j){let t=Xr(A.schema,e),r=A.settings.allowParseErrors&&A.schema.space==="html"?0:1,o=A.settings.allowDangerousCharacters?0:1,n=A.quote,i;if(t.overloadedBoolean&&(j===t.attribute||j==="")?j=!0:(t.boolean||t.overloadedBoolean)&&(typeof j!="string"||j===t.attribute||j==="")&&(j=!!j),j==null||j===!1||typeof j=="number"&&Number.isNaN(j))return"";let a=ij(t.attribute,Object.assign({},A.settings.characterReferences,{subset:Kt.name[r][o]}));return j===!0||(j=Array.isArray(j)?(t.commaSeparated?ha:ga)(j,{padLeft:!A.settings.tightCommaSeparatedLists}):String(j),A.settings.collapseEmptyAttributes&&!j)?a:(A.settings.preferUnquoted&&(i=ij(j,Object.assign({},A.settings.characterReferences,{attribute:!0,subset:Kt.unquoted[r][o]}))),i!==j&&(A.settings.quoteSmart&&ee(j,n)>ee(j,A.alternative)&&(n=A.alternative),i=n+ij(j,Object.assign({},A.settings.characterReferences,{subset:(n==="'"?Kt.single:Kt.double)[r][o],attribute:!0}))+n),a+(i&&"="+i))}var Cd=["<","&"];function Lt(A,e,j,t){return j&&j.type==="element"&&(j.tagName==="script"||j.tagName==="style")?A.value:ij(A.value,Object.assign({},t.settings.characterReferences,{subset:Cd}))}function _7(A,e,j,t){return t.settings.allowDangerousHtml?A.value:Lt(A,e,j,t)}function y7(A,e,j,t){return t.all(A)}var S7=ot("type",{invalid:Td,unknown:Dd,handlers:{comment:f7,doctype:G7,element:b7,raw:_7,root:y7,text:Lt}});function Td(A){throw new Error("Expected node, not `"+A+"`")}function Dd(A){let e=A;throw new Error("Cannot compile unknown node `"+e.type+"`")}var wd={},qd={},Nd=[];function x6(A,e){let j=e||wd,t=j.quote||'"',r=t==='"'?"'":'"';if(t!=='"'&&t!=="'")throw new Error("Invalid quote `"+t+"`, expected `'` or `\"`");return{one:Kd,all:Ld,settings:{omitOptionalTags:j.omitOptionalTags||!1,allowParseErrors:j.allowParseErrors||!1,allowDangerousCharacters:j.allowDangerousCharacters||!1,quoteSmart:j.quoteSmart||!1,preferUnquoted:j.preferUnquoted||!1,tightAttributes:j.tightAttributes||!1,upperDoctype:j.upperDoctype||!1,tightDoctype:j.tightDoctype||!1,bogusComments:j.bogusComments||!1,tightCommaSeparatedLists:j.tightCommaSeparatedLists||!1,tightSelfClosing:j.tightSelfClosing||!1,collapseEmptyAttributes:j.collapseEmptyAttributes||!1,allowDangerousHtml:j.allowDangerousHtml||!1,voids:j.voids||l7,characterReferences:j.characterReferences||qd,closeSelfClosing:j.closeSelfClosing||!1,closeEmptyElements:j.closeEmptyElements||!1},schema:j.space==="svg"?Rt:Ia,quote:t,alternative:r}.one(Array.isArray(A)?{type:"root",children:A}:A,void 0,void 0)}function Kd(A,e,j){return S7(A,e,j,this)}function Ld(A){let e=[],j=A&&A.children||Nd,t=-1;for(;++t<j.length;)e[t]=this.one(j[t],t,A);return e.join("")}function Jt(A){let e=this,j={...e.data("settings"),...A};e.compiler=t;function t(r){return x6(r,j)}}function C6(A){if(typeof A!="string")throw new TypeError("Expected a string");return A.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function Je(A,e,j){let r=go((j||{}).ignore||[]),o=Jd(e),n=-1;for(;++n<o.length;)_o(A,"text",i);function i(s,l){let k=-1,c;for(;++k<l.length;){let d=l[k],$=c?c.children:void 0;if(r(d,$?$.indexOf(d):void 0,c))return;c=d}if(c)return a(s,l)}function a(s,l){let k=l[l.length-1],c=o[n][0],d=o[n][1],$=0,u=k.children.indexOf(s),E=!1,f=[];c.lastIndex=0;let F=c.exec(s.value);for(;F;){let g=F.index,b={index:F.index,input:F.input,stack:[...l,s]},G=d(...F,b);if(typeof G=="string"&&(G=G.length>0?{type:"text",value:G}:void 0),G===!1?c.lastIndex=g+1:($!==g&&f.push({type:"text",value:s.value.slice($,g)}),Array.isArray(G)?f.push(...G):G&&f.push(G),$=g+F[0].length,E=!0),!c.global)break;F=c.exec(s.value)}return E?($<s.value.length&&f.push({type:"text",value:s.value.slice($)}),k.children.splice(u,1,...f)):f=[s],u+f.length}}function Jd(A){let e=[];if(!Array.isArray(A))throw new TypeError("Expected find and replace tuple or list of tuples");let j=!A[0]||Array.isArray(A[0])?A:[A],t=-1;for(;++t<j.length;){let r=j[t];e.push([Hd(r[0]),Qd(r[1])])}return e}function Hd(A){return typeof A=="string"?new RegExp(C6(A),"g"):A}function Qd(A){return typeof A=="function"?A:function(){return A}}function T6(A){Je(A,[/\r?\n|\r/g,Ud])}function Ud(){return{type:"break"}}function Ht(){return function(A){T6(A)}}var $A=Ej(/[A-Za-z]/),iA=Ej(/[\dA-Za-z]/),M7=Ej(/[#-'*+\--9=?A-Z^-~]/);function Pj(A){return A!==null&&(A<32||A===127)}var He=Ej(/\d/),O7=Ej(/[\dA-Fa-f]/),P7=Ej(/[!-/:-@[-`{-~]/);function O(A){return A!==null&&A<-2}function Q(A){return A!==null&&(A<0||A===32)}function q(A){return A===-2||A===-1||A===32}var vj=Ej(new RegExp("\\p{P}|\\p{S}","u")),VA=Ej(/\s/);function Ej(A){return e;function e(j){return j!==null&&j>-1&&A.test(String.fromCharCode(j))}}var D6="phrasing",w6=["autolink","link","image","label"];function N6(){return{transforms:[Zd],enter:{literalAutolink:Vd,literalAutolinkEmail:q6,literalAutolinkHttp:q6,literalAutolinkWww:q6},exit:{literalAutolink:Yd,literalAutolinkEmail:Wd,literalAutolinkHttp:Xd,literalAutolinkWww:zd}}}function K6(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:D6,notInConstruct:w6},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:D6,notInConstruct:w6},{character:":",before:"[ps]",after:"\\/",inConstruct:D6,notInConstruct:w6}]}}function Vd(A){this.enter({type:"link",title:null,url:"",children:[]},A)}function q6(A){this.config.enter.autolinkProtocol.call(this,A)}function Xd(A){this.config.exit.autolinkProtocol.call(this,A)}function zd(A){this.config.exit.data.call(this,A);let e=this.stack[this.stack.length-1];e.type,e.url="http://"+this.sliceSerialize(A)}function Wd(A){this.config.exit.autolinkEmail.call(this,A)}function Yd(A){this.exit(A)}function Zd(A){Je(A,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,A$],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),j$]],{ignore:["link","linkReference"]})}function A$(A,e,j,t,r){let o="";if(!v7(r)||(/^w/i.test(e)&&(j=e+j,e="",o="http://"),!e$(j)))return!1;let n=t$(j+t);if(!n[0])return!1;let i={type:"link",title:null,url:o+e+n[0],children:[{type:"text",value:e+n[0]}]};return n[1]?[i,{type:"text",value:n[1]}]:i}function j$(A,e,j,t){return!v7(t,!0)||/[-\d_]$/.test(j)?!1:{type:"link",title:null,url:"mailto:"+e+"@"+j,children:[{type:"text",value:e+"@"+j}]}}function e$(A){let e=A.split(".");return!(e.length<2||e[e.length-1]&&(/_/.test(e[e.length-1])||!/[a-zA-Z\d]/.test(e[e.length-1]))||e[e.length-2]&&(/_/.test(e[e.length-2])||!/[a-zA-Z\d]/.test(e[e.length-2])))}function t$(A){let e=/[!"&'),.:;<>?\]}]+$/.exec(A);if(!e)return[A,void 0];A=A.slice(0,e.index);let j=e[0],t=j.indexOf(")"),r=ee(A,"("),o=ee(A,")");for(;t!==-1&&r>o;)A+=j.slice(0,t+1),j=j.slice(t+1),t=j.indexOf(")"),o++;return[A,j]}function v7(A,e){let j=A.input.charCodeAt(A.index-1);return(A.index===0||VA(j)||vj(j))&&(!e||j!==47)}function RA(A){return A.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}x7.peek=c$;function r$(){this.buffer()}function n$(A){this.enter({type:"footnoteReference",identifier:"",label:""},A)}function o$(){this.buffer()}function i$(A){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},A)}function a$(A){let e=this.resume(),j=this.stack[this.stack.length-1];j.type,j.identifier=RA(this.sliceSerialize(A)).toLowerCase(),j.label=e}function s$(A){this.exit(A)}function l$(A){let e=this.resume(),j=this.stack[this.stack.length-1];j.type,j.identifier=RA(this.sliceSerialize(A)).toLowerCase(),j.label=e}function k$(A){this.exit(A)}function c$(){return"["}function x7(A,e,j,t){let r=j.createTracker(t),o=r.move("[^"),n=j.enter("footnoteReference"),i=j.enter("reference");return o+=r.move(j.safe(j.associationId(A),{after:"]",before:o})),i(),n(),o+=r.move("]"),o}function L6(){return{enter:{gfmFootnoteCallString:r$,gfmFootnoteCall:n$,gfmFootnoteDefinitionLabelString:o$,gfmFootnoteDefinition:i$},exit:{gfmFootnoteCallString:a$,gfmFootnoteCall:s$,gfmFootnoteDefinitionLabelString:l$,gfmFootnoteDefinition:k$}}}function J6(A){let e=!1;return A&&A.firstLineBlank&&(e=!0),{handlers:{footnoteDefinition:j,footnoteReference:x7},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function j(t,r,o,n){let i=o.createTracker(n),a=i.move("[^"),s=o.enter("footnoteDefinition"),l=o.enter("label");return a+=i.move(o.safe(o.associationId(t),{before:a,after:"]"})),l(),a+=i.move("]:"),t.children&&t.children.length>0&&(i.shift(4),a+=i.move((e?`
`:" ")+o.indentLines(o.containerFlow(t,i.current()),e?C7:d$))),s(),a}}function d$(A,e,j){return e===0?A:C7(A,e,j)}function C7(A,e,j){return(j?"":"    ")+A}var $$=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];T7.peek=u$;function H6(){return{canContainEols:["delete"],enter:{strikethrough:E$},exit:{strikethrough:B$}}}function Q6(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:$$}],handlers:{delete:T7}}}function E$(A){this.enter({type:"delete",children:[]},A)}function B$(A){this.exit(A)}function T7(A,e,j,t){let r=j.createTracker(t),o=j.enter("strikethrough"),n=r.move("~~");return n+=j.containerPhrasing(A,{...r.current(),before:n,after:"~"}),n+=r.move("~~"),o(),n}function u$(){return"~"}function p$(A){return A.length}function w7(A,e){let j=e||{},t=(j.align||[]).concat(),r=j.stringLength||p$,o=[],n=[],i=[],a=[],s=0,l=-1;for(;++l<A.length;){let B=[],u=[],E=-1;for(A[l].length>s&&(s=A[l].length);++E<A[l].length;){let f=m$(A[l][E]);if(j.alignDelimiters!==!1){let F=r(f);u[E]=F,(a[E]===void 0||F>a[E])&&(a[E]=F)}B.push(f)}n[l]=B,i[l]=u}let k=-1;if(typeof t=="object"&&"length"in t)for(;++k<s;)o[k]=D7(t[k]);else{let B=D7(t);for(;++k<s;)o[k]=B}k=-1;let c=[],d=[];for(;++k<s;){let B=o[k],u="",E="";B===99?(u=":",E=":"):B===108?u=":":B===114&&(E=":");let f=j.alignDelimiters===!1?1:Math.max(1,a[k]-u.length-E.length),F=u+"-".repeat(f)+E;j.alignDelimiters!==!1&&(f=u.length+f+E.length,f>a[k]&&(a[k]=f),d[k]=f),c[k]=F}n.splice(1,0,c),i.splice(1,0,d),l=-1;let $=[];for(;++l<n.length;){let B=n[l],u=i[l];k=-1;let E=[];for(;++k<s;){let f=B[k]||"",F="",g="";if(j.alignDelimiters!==!1){let b=a[k]-(u[k]||0),G=o[k];G===114?F=" ".repeat(b):G===99?b%2?(F=" ".repeat(b/2+.5),g=" ".repeat(b/2-.5)):(F=" ".repeat(b/2),g=F):g=" ".repeat(b)}j.delimiterStart!==!1&&!k&&E.push("|"),j.padding!==!1&&!(j.alignDelimiters===!1&&f==="")&&(j.delimiterStart!==!1||k)&&E.push(" "),j.alignDelimiters!==!1&&E.push(F),E.push(f),j.alignDelimiters!==!1&&E.push(g),j.padding!==!1&&E.push(" "),(j.delimiterEnd!==!1||k!==s-1)&&E.push("|")}$.push(j.delimiterEnd===!1?E.join("").replace(/ +$/,""):E.join(""))}return $.join(`
`)}function m$(A){return A==null?"":String(A)}function D7(A){let e=typeof A=="string"?A.codePointAt(0):0;return e===67||e===99?99:e===76||e===108?108:e===82||e===114?114:0}function V6(){return{enter:{table:f$,tableData:q7,tableHeader:q7,tableRow:R$},exit:{codeText:F$,table:G$,tableData:U6,tableHeader:U6,tableRow:U6}}}function f$(A){let e=A._align;this.enter({type:"table",align:e.map(function(j){return j==="none"?null:j}),children:[]},A),this.data.inTable=!0}function G$(A){this.exit(A),this.data.inTable=void 0}function R$(A){this.enter({type:"tableRow",children:[]},A)}function U6(A){this.exit(A)}function q7(A){this.enter({type:"tableCell",children:[]},A)}function F$(A){let e=this.resume();this.data.inTable&&(e=e.replace(/\\([\\|])/g,I$));let j=this.stack[this.stack.length-1];j.type,j.value=e,this.exit(A)}function I$(A,e){return e==="|"?e:A}function X6(A){let e=A||{},j=e.tableCellPadding,t=e.tablePipeAlign,r=e.stringLength,o=j?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:c,table:n,tableCell:a,tableRow:i}};function n(d,$,B,u){return s(l(d,B,u),d.align)}function i(d,$,B,u){let E=k(d,B,u),f=s([E]);return f.slice(0,f.indexOf(`
`))}function a(d,$,B,u){let E=B.enter("tableCell"),f=B.enter("phrasing"),F=B.containerPhrasing(d,{...u,before:o,after:o});return f(),E(),F}function s(d,$){return w7(d,{align:$,alignDelimiters:t,padding:j,stringLength:r})}function l(d,$,B){let u=d.children,E=-1,f=[],F=$.enter("table");for(;++E<u.length;)f[E]=k(u[E],$,B);return F(),f}function k(d,$,B){let u=d.children,E=-1,f=[],F=$.enter("tableRow");for(;++E<u.length;)f[E]=a(u[E],d,$,B);return F(),f}function c(d,$,B){let u=oj.inlineCode(d,$,B);return B.stack.includes("tableCell")&&(u=u.replace(/\|/g,"\\$&")),u}}function z6(){return{exit:{taskListCheckValueChecked:N7,taskListCheckValueUnchecked:N7,paragraph:h$}}}function W6(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:g$}}}function N7(A){let e=this.stack[this.stack.length-2];e.type,e.checked=A.type==="taskListCheckValueChecked"}function h$(A){let e=this.stack[this.stack.length-2];if(e&&e.type==="listItem"&&typeof e.checked=="boolean"){let j=this.stack[this.stack.length-1];j.type;let t=j.children[0];if(t&&t.type==="text"){let r=e.children,o=-1,n;for(;++o<r.length;){let i=r[o];if(i.type==="paragraph"){n=i;break}}n===j&&(t.value=t.value.slice(1),t.value.length===0?j.children.shift():j.position&&t.position&&typeof t.position.start.offset=="number"&&(t.position.start.column++,t.position.start.offset++,j.position.start=Object.assign({},t.position.start)))}}this.exit(A)}function g$(A,e,j,t){let r=A.children[0],o=typeof A.checked=="boolean"&&r&&r.type==="paragraph",n="["+(A.checked?"x":" ")+"] ",i=j.createTracker(t);o&&i.move(n);let a=oj.listItem(A,e,j,{...t,...i.current()});return o&&(a=a.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,s)),a;function s(l){return l+n}}function Y6(){return[N6(),L6(),H6(),V6(),z6()]}function Z6(A){return{extensions:[K6(),J6(A),Q6(),X6(A),W6()]}}function cA(A,e,j,t){let r=A.length,o=0,n;if(e<0?e=-e>r?0:r+e:e=e>r?r:e,j=j>0?j:0,t.length<1e4)n=Array.from(t),n.unshift(e,j),A.splice(...n);else for(j&&A.splice(e,j);o<t.length;)n=t.slice(o,o+1e4),n.unshift(e,0),A.splice(...n),o+=1e4,e+=1e4}function IA(A,e){return A.length>0?(cA(A,A.length,0,e),A):e}var K7={}.hasOwnProperty;function Qt(A){let e={},j=-1;for(;++j<A.length;)b$(e,A[j]);return e}function b$(A,e){let j;for(j in e){let r=(K7.call(A,j)?A[j]:void 0)||(A[j]={}),o=e[j],n;if(o)for(n in o){K7.call(r,n)||(r[n]=[]);let i=o[n];_$(r[n],Array.isArray(i)?i:i?[i]:[])}}}function _$(A,e){let j=-1,t=[];for(;++j<e.length;)(e[j].add==="after"?A:t).push(e[j]);cA(A,0,0,t)}var y$={tokenize:v$,partial:!0},L7={tokenize:x$,partial:!0},J7={tokenize:C$,partial:!0},H7={tokenize:T$,partial:!0},S$={tokenize:D$,partial:!0},Q7={name:"wwwAutolink",tokenize:O$,previous:V7},U7={name:"protocolAutolink",tokenize:P$,previous:X7},aj={name:"emailAutolink",tokenize:M$,previous:z7},XA={};function jn(){return{text:XA}}var xj=48;for(;xj<123;)XA[xj]=aj,xj++,xj===58?xj=65:xj===91&&(xj=97);XA[43]=aj;XA[45]=aj;XA[46]=aj;XA[95]=aj;XA[72]=[aj,U7];XA[104]=[aj,U7];XA[87]=[aj,Q7];XA[119]=[aj,Q7];function M$(A,e,j){let t=this,r,o;return n;function n(k){return!An(k)||!z7.call(t,t.previous)||en(t.events)?j(k):(A.enter("literalAutolink"),A.enter("literalAutolinkEmail"),i(k))}function i(k){return An(k)?(A.consume(k),i):k===64?(A.consume(k),a):j(k)}function a(k){return k===46?A.check(S$,l,s)(k):k===45||k===95||iA(k)?(o=!0,A.consume(k),a):l(k)}function s(k){return A.consume(k),r=!0,a}function l(k){return o&&r&&$A(t.previous)?(A.exit("literalAutolinkEmail"),A.exit("literalAutolink"),e(k)):j(k)}}function O$(A,e,j){let t=this;return r;function r(n){return n!==87&&n!==119||!V7.call(t,t.previous)||en(t.events)?j(n):(A.enter("literalAutolink"),A.enter("literalAutolinkWww"),A.check(y$,A.attempt(L7,A.attempt(J7,o),j),j)(n))}function o(n){return A.exit("literalAutolinkWww"),A.exit("literalAutolink"),e(n)}}function P$(A,e,j){let t=this,r="",o=!1;return n;function n(k){return(k===72||k===104)&&X7.call(t,t.previous)&&!en(t.events)?(A.enter("literalAutolink"),A.enter("literalAutolinkHttp"),r+=String.fromCodePoint(k),A.consume(k),i):j(k)}function i(k){if($A(k)&&r.length<5)return r+=String.fromCodePoint(k),A.consume(k),i;if(k===58){let c=r.toLowerCase();if(c==="http"||c==="https")return A.consume(k),a}return j(k)}function a(k){return k===47?(A.consume(k),o?s:(o=!0,a)):j(k)}function s(k){return k===null||Pj(k)||Q(k)||VA(k)||vj(k)?j(k):A.attempt(L7,A.attempt(J7,l),j)(k)}function l(k){return A.exit("literalAutolinkHttp"),A.exit("literalAutolink"),e(k)}}function v$(A,e,j){let t=0;return r;function r(n){return(n===87||n===119)&&t<3?(t++,A.consume(n),r):n===46&&t===3?(A.consume(n),o):j(n)}function o(n){return n===null?j(n):e(n)}}function x$(A,e,j){let t,r,o;return n;function n(s){return s===46||s===95?A.check(H7,a,i)(s):s===null||Q(s)||VA(s)||s!==45&&vj(s)?a(s):(o=!0,A.consume(s),n)}function i(s){return s===95?t=!0:(r=t,t=void 0),A.consume(s),n}function a(s){return r||t||!o?j(s):e(s)}}function C$(A,e){let j=0,t=0;return r;function r(n){return n===40?(j++,A.consume(n),r):n===41&&t<j?o(n):n===33||n===34||n===38||n===39||n===41||n===42||n===44||n===46||n===58||n===59||n===60||n===63||n===93||n===95||n===126?A.check(H7,e,o)(n):n===null||Q(n)||VA(n)?e(n):(A.consume(n),r)}function o(n){return n===41&&t++,A.consume(n),r}}function T$(A,e,j){return t;function t(i){return i===33||i===34||i===39||i===41||i===42||i===44||i===46||i===58||i===59||i===63||i===95||i===126?(A.consume(i),t):i===38?(A.consume(i),o):i===93?(A.consume(i),r):i===60||i===null||Q(i)||VA(i)?e(i):j(i)}function r(i){return i===null||i===40||i===91||Q(i)||VA(i)?e(i):t(i)}function o(i){return $A(i)?n(i):j(i)}function n(i){return i===59?(A.consume(i),t):$A(i)?(A.consume(i),n):j(i)}}function D$(A,e,j){return t;function t(o){return A.consume(o),r}function r(o){return iA(o)?j(o):e(o)}}function V7(A){return A===null||A===40||A===42||A===95||A===91||A===93||A===126||Q(A)}function X7(A){return!$A(A)}function z7(A){return!(A===47||An(A))}function An(A){return A===43||A===45||A===46||A===95||iA(A)}function en(A){let e=A.length,j=!1;for(;e--;){let t=A[e][1];if((t.type==="labelLink"||t.type==="labelImage")&&!t._balanced){j=!0;break}if(t._gfmAutolinkLiteralWalkedInto){j=!1;break}}return A.length>0&&!j&&(A[A.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),j}function xA(A){let e=[],j=-1,t=0,r=0;for(;++j<A.length;){let o=A.charCodeAt(j),n="";if(o===37&&iA(A.charCodeAt(j+1))&&iA(A.charCodeAt(j+2)))r=2;else if(o<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(o))||(n=String.fromCharCode(o));else if(o>55295&&o<57344){let i=A.charCodeAt(j+1);o<56320&&i>56319&&i<57344?(n=String.fromCharCode(o,i),r=1):n="\uFFFD"}else n=String.fromCharCode(o);n&&(e.push(A.slice(t,j),encodeURIComponent(n)),t=j+r+1,n=""),r&&(j+=r,r=0)}return e.join("")+A.slice(t)}function te(A){if(A===null||Q(A)||VA(A))return 1;if(vj(A))return 2}function Bj(A,e,j){let t=[],r=-1;for(;++r<A.length;){let o=A[r].resolveAll;o&&!t.includes(o)&&(e=o(e,j),t.push(o))}return e}var Qe={name:"attention",tokenize:q$,resolveAll:w$};function w$(A,e){let j=-1,t,r,o,n,i,a,s,l;for(;++j<A.length;)if(A[j][0]==="enter"&&A[j][1].type==="attentionSequence"&&A[j][1]._close){for(t=j;t--;)if(A[t][0]==="exit"&&A[t][1].type==="attentionSequence"&&A[t][1]._open&&e.sliceSerialize(A[t][1]).charCodeAt(0)===e.sliceSerialize(A[j][1]).charCodeAt(0)){if((A[t][1]._close||A[j][1]._open)&&(A[j][1].end.offset-A[j][1].start.offset)%3&&!((A[t][1].end.offset-A[t][1].start.offset+A[j][1].end.offset-A[j][1].start.offset)%3))continue;a=A[t][1].end.offset-A[t][1].start.offset>1&&A[j][1].end.offset-A[j][1].start.offset>1?2:1;let k=Object.assign({},A[t][1].end),c=Object.assign({},A[j][1].start);W7(k,-a),W7(c,a),n={type:a>1?"strongSequence":"emphasisSequence",start:k,end:Object.assign({},A[t][1].end)},i={type:a>1?"strongSequence":"emphasisSequence",start:Object.assign({},A[j][1].start),end:c},o={type:a>1?"strongText":"emphasisText",start:Object.assign({},A[t][1].end),end:Object.assign({},A[j][1].start)},r={type:a>1?"strong":"emphasis",start:Object.assign({},n.start),end:Object.assign({},i.end)},A[t][1].end=Object.assign({},n.start),A[j][1].start=Object.assign({},i.end),s=[],A[t][1].end.offset-A[t][1].start.offset&&(s=IA(s,[["enter",A[t][1],e],["exit",A[t][1],e]])),s=IA(s,[["enter",r,e],["enter",n,e],["exit",n,e],["enter",o,e]]),s=IA(s,Bj(e.parser.constructs.insideSpan.null,A.slice(t+1,j),e)),s=IA(s,[["exit",o,e],["enter",i,e],["exit",i,e],["exit",r,e]]),A[j][1].end.offset-A[j][1].start.offset?(l=2,s=IA(s,[["enter",A[j][1],e],["exit",A[j][1],e]])):l=0,cA(A,t-1,j-t+3,s),j=t+s.length-l-2;break}}for(j=-1;++j<A.length;)A[j][1].type==="attentionSequence"&&(A[j][1].type="data");return A}function q$(A,e){let j=this.parser.constructs.attentionMarkers.null,t=this.previous,r=te(t),o;return n;function n(a){return o=a,A.enter("attentionSequence"),i(a)}function i(a){if(a===o)return A.consume(a),i;let s=A.exit("attentionSequence"),l=te(a),k=!l||l===2&&r||j.includes(a),c=!r||r===2&&l||j.includes(t);return s._open=!!(o===42?k:k&&(r||!c)),s._close=!!(o===42?c:c&&(l||!k)),e(a)}}function W7(A,e){A.column+=e,A.offset+=e,A._bufferIndex+=e}var tn={name:"autolink",tokenize:N$};function N$(A,e,j){let t=0;return r;function r(d){return A.enter("autolink"),A.enter("autolinkMarker"),A.consume(d),A.exit("autolinkMarker"),A.enter("autolinkProtocol"),o}function o(d){return $A(d)?(A.consume(d),n):d===64?j(d):s(d)}function n(d){return d===43||d===45||d===46||iA(d)?(t=1,i(d)):s(d)}function i(d){return d===58?(A.consume(d),t=0,a):(d===43||d===45||d===46||iA(d))&&t++<32?(A.consume(d),i):(t=0,s(d))}function a(d){return d===62?(A.exit("autolinkProtocol"),A.enter("autolinkMarker"),A.consume(d),A.exit("autolinkMarker"),A.exit("autolink"),e):d===null||d===32||d===60||Pj(d)?j(d):(A.consume(d),a)}function s(d){return d===64?(A.consume(d),l):M7(d)?(A.consume(d),s):j(d)}function l(d){return iA(d)?k(d):j(d)}function k(d){return d===46?(A.consume(d),t=0,l):d===62?(A.exit("autolinkProtocol").type="autolinkEmail",A.enter("autolinkMarker"),A.consume(d),A.exit("autolinkMarker"),A.exit("autolink"),e):c(d)}function c(d){if((d===45||iA(d))&&t++<63){let $=d===45?c:k;return A.consume(d),$}return j(d)}}function D(A,e,j,t){let r=t?t-1:Number.POSITIVE_INFINITY,o=0;return n;function n(a){return q(a)?(A.enter(j),i(a)):e(a)}function i(a){return q(a)&&o++<r?(A.consume(a),i):(A.exit(j),e(a))}}var zA={tokenize:K$,partial:!0};function K$(A,e,j){return t;function t(o){return q(o)?D(A,r,"linePrefix")(o):r(o)}function r(o){return o===null||O(o)?e(o):j(o)}}var Ut={name:"blockQuote",tokenize:L$,continuation:{tokenize:J$},exit:H$};function L$(A,e,j){let t=this;return r;function r(n){if(n===62){let i=t.containerState;return i.open||(A.enter("blockQuote",{_container:!0}),i.open=!0),A.enter("blockQuotePrefix"),A.enter("blockQuoteMarker"),A.consume(n),A.exit("blockQuoteMarker"),o}return j(n)}function o(n){return q(n)?(A.enter("blockQuotePrefixWhitespace"),A.consume(n),A.exit("blockQuotePrefixWhitespace"),A.exit("blockQuotePrefix"),e):(A.exit("blockQuotePrefix"),e(n))}}function J$(A,e,j){let t=this;return r;function r(n){return q(n)?D(A,o,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(n):o(n)}function o(n){return A.attempt(Ut,e,j)(n)}}function H$(A){A.exit("blockQuote")}var Vt={name:"characterEscape",tokenize:Q$};function Q$(A,e,j){return t;function t(o){return A.enter("characterEscape"),A.enter("escapeMarker"),A.consume(o),A.exit("escapeMarker"),r}function r(o){return P7(o)?(A.enter("characterEscapeValue"),A.consume(o),A.exit("characterEscapeValue"),A.exit("characterEscape"),e):j(o)}}var Xt={name:"characterReference",tokenize:U$};function U$(A,e,j){let t=this,r=0,o,n;return i;function i(k){return A.enter("characterReference"),A.enter("characterReferenceMarker"),A.consume(k),A.exit("characterReferenceMarker"),a}function a(k){return k===35?(A.enter("characterReferenceMarkerNumeric"),A.consume(k),A.exit("characterReferenceMarkerNumeric"),s):(A.enter("characterReferenceValue"),o=31,n=iA,l(k))}function s(k){return k===88||k===120?(A.enter("characterReferenceMarkerHexadecimal"),A.consume(k),A.exit("characterReferenceMarkerHexadecimal"),A.enter("characterReferenceValue"),o=6,n=O7,l):(A.enter("characterReferenceValue"),o=7,n=He,l(k))}function l(k){if(k===59&&r){let c=A.exit("characterReferenceValue");return n===iA&&!je(t.sliceSerialize(c))?j(k):(A.enter("characterReferenceMarker"),A.consume(k),A.exit("characterReferenceMarker"),A.exit("characterReference"),e)}return n(k)&&r++<o?(A.consume(k),l):j(k)}}var Y7={tokenize:X$,partial:!0},zt={name:"codeFenced",tokenize:V$,concrete:!0};function V$(A,e,j){let t=this,r={tokenize:b,partial:!0},o=0,n=0,i;return a;function a(G){return s(G)}function s(G){let v=t.events[t.events.length-1];return o=v&&v[1].type==="linePrefix"?v[2].sliceSerialize(v[1],!0).length:0,i=G,A.enter("codeFenced"),A.enter("codeFencedFence"),A.enter("codeFencedFenceSequence"),l(G)}function l(G){return G===i?(n++,A.consume(G),l):n<3?j(G):(A.exit("codeFencedFenceSequence"),q(G)?D(A,k,"whitespace")(G):k(G))}function k(G){return G===null||O(G)?(A.exit("codeFencedFence"),t.interrupt?e(G):A.check(Y7,B,g)(G)):(A.enter("codeFencedFenceInfo"),A.enter("chunkString",{contentType:"string"}),c(G))}function c(G){return G===null||O(G)?(A.exit("chunkString"),A.exit("codeFencedFenceInfo"),k(G)):q(G)?(A.exit("chunkString"),A.exit("codeFencedFenceInfo"),D(A,d,"whitespace")(G)):G===96&&G===i?j(G):(A.consume(G),c)}function d(G){return G===null||O(G)?k(G):(A.enter("codeFencedFenceMeta"),A.enter("chunkString",{contentType:"string"}),$(G))}function $(G){return G===null||O(G)?(A.exit("chunkString"),A.exit("codeFencedFenceMeta"),k(G)):G===96&&G===i?j(G):(A.consume(G),$)}function B(G){return A.attempt(r,g,u)(G)}function u(G){return A.enter("lineEnding"),A.consume(G),A.exit("lineEnding"),E}function E(G){return o>0&&q(G)?D(A,f,"linePrefix",o+1)(G):f(G)}function f(G){return G===null||O(G)?A.check(Y7,B,g)(G):(A.enter("codeFlowValue"),F(G))}function F(G){return G===null||O(G)?(A.exit("codeFlowValue"),f(G)):(A.consume(G),F)}function g(G){return A.exit("codeFenced"),e(G)}function b(G,v,N){let C=0;return R;function R(P){return G.enter("lineEnding"),G.consume(P),G.exit("lineEnding"),K}function K(P){return G.enter("codeFencedFence"),q(P)?D(G,w,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(P):w(P)}function w(P){return P===i?(G.enter("codeFencedFenceSequence"),y(P)):N(P)}function y(P){return P===i?(C++,G.consume(P),y):C>=n?(G.exit("codeFencedFenceSequence"),q(P)?D(G,S,"whitespace")(P):S(P)):N(P)}function S(P){return P===null||O(P)?(G.exit("codeFencedFence"),v(P)):N(P)}}}function X$(A,e,j){let t=this;return r;function r(n){return n===null?j(n):(A.enter("lineEnding"),A.consume(n),A.exit("lineEnding"),o)}function o(n){return t.parser.lazy[t.now().line]?j(n):e(n)}}var Ue={name:"codeIndented",tokenize:W$},z$={tokenize:Y$,partial:!0};function W$(A,e,j){let t=this;return r;function r(s){return A.enter("codeIndented"),D(A,o,"linePrefix",5)(s)}function o(s){let l=t.events[t.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?n(s):j(s)}function n(s){return s===null?a(s):O(s)?A.attempt(z$,n,a)(s):(A.enter("codeFlowValue"),i(s))}function i(s){return s===null||O(s)?(A.exit("codeFlowValue"),n(s)):(A.consume(s),i)}function a(s){return A.exit("codeIndented"),e(s)}}function Y$(A,e,j){let t=this;return r;function r(n){return t.parser.lazy[t.now().line]?j(n):O(n)?(A.enter("lineEnding"),A.consume(n),A.exit("lineEnding"),r):D(A,o,"linePrefix",5)(n)}function o(n){let i=t.events[t.events.length-1];return i&&i[1].type==="linePrefix"&&i[2].sliceSerialize(i[1],!0).length>=4?e(n):O(n)?r(n):j(n)}}var rn={name:"codeText",tokenize:jE,resolve:Z$,previous:AE};function Z$(A){let e=A.length-4,j=3,t,r;if((A[j][1].type==="lineEnding"||A[j][1].type==="space")&&(A[e][1].type==="lineEnding"||A[e][1].type==="space")){for(t=j;++t<e;)if(A[t][1].type==="codeTextData"){A[j][1].type="codeTextPadding",A[e][1].type="codeTextPadding",j+=2,e-=2;break}}for(t=j-1,e++;++t<=e;)r===void 0?t!==e&&A[t][1].type!=="lineEnding"&&(r=t):(t===e||A[t][1].type==="lineEnding")&&(A[r][1].type="codeTextData",t!==r+2&&(A[r][1].end=A[t-1][1].end,A.splice(r+2,t-r-2),e-=t-r-2,t=r+2),r=void 0);return A}function AE(A){return A!==96||this.events[this.events.length-1][1].type==="characterEscape"}function jE(A,e,j){let t=this,r=0,o,n;return i;function i(c){return A.enter("codeText"),A.enter("codeTextSequence"),a(c)}function a(c){return c===96?(A.consume(c),r++,a):(A.exit("codeTextSequence"),s(c))}function s(c){return c===null?j(c):c===32?(A.enter("space"),A.consume(c),A.exit("space"),s):c===96?(n=A.enter("codeTextSequence"),o=0,k(c)):O(c)?(A.enter("lineEnding"),A.consume(c),A.exit("lineEnding"),s):(A.enter("codeTextData"),l(c))}function l(c){return c===null||c===32||c===96||O(c)?(A.exit("codeTextData"),s(c)):(A.consume(c),l)}function k(c){return c===96?(A.consume(c),o++,k):o===r?(A.exit("codeTextSequence"),A.exit("codeText"),e(c)):(n.type="codeTextData",l(c))}}var Wt=class{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,j){let t=j??Number.POSITIVE_INFINITY;return t<this.left.length?this.left.slice(e,t):e>this.left.length?this.right.slice(this.right.length-t+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-t+this.left.length).reverse())}splice(e,j,t){let r=j||0;this.setCursor(Math.trunc(e));let o=this.right.splice(this.right.length-r,Number.POSITIVE_INFINITY);return t&&Ve(this.left,t),o.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),Ve(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),Ve(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){let j=this.left.splice(e,Number.POSITIVE_INFINITY);Ve(this.right,j.reverse())}else{let j=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);Ve(this.left,j.reverse())}}};function Ve(A,e){let j=0;if(e.length<1e4)A.push(...e);else for(;j<e.length;)A.push(...e.slice(j,j+1e4)),j+=1e4}function Yt(A){let e={},j=-1,t,r,o,n,i,a,s,l=new Wt(A);for(;++j<l.length;){for(;j in e;)j=e[j];if(t=l.get(j),j&&t[1].type==="chunkFlow"&&l.get(j-1)[1].type==="listItemPrefix"&&(a=t[1]._tokenizer.events,o=0,o<a.length&&a[o][1].type==="lineEndingBlank"&&(o+=2),o<a.length&&a[o][1].type==="content"))for(;++o<a.length&&a[o][1].type!=="content";)a[o][1].type==="chunkText"&&(a[o][1]._isInFirstContentOfListItem=!0,o++);if(t[0]==="enter")t[1].contentType&&(Object.assign(e,eE(l,j)),j=e[j],s=!0);else if(t[1]._container){for(o=j,r=void 0;o--&&(n=l.get(o),n[1].type==="lineEnding"||n[1].type==="lineEndingBlank");)n[0]==="enter"&&(r&&(l.get(r)[1].type="lineEndingBlank"),n[1].type="lineEnding",r=o);r&&(t[1].end=Object.assign({},l.get(r)[1].start),i=l.slice(r,j),i.unshift(t),l.splice(r,j-r+1,i))}}return cA(A,0,Number.POSITIVE_INFINITY,l.slice(0)),!s}function eE(A,e){let j=A.get(e)[1],t=A.get(e)[2],r=e-1,o=[],n=j._tokenizer||t.parser[j.contentType](j.start),i=n.events,a=[],s={},l,k,c=-1,d=j,$=0,B=0,u=[B];for(;d;){for(;A.get(++r)[1]!==d;);o.push(r),d._tokenizer||(l=t.sliceStream(d),d.next||l.push(null),k&&n.defineSkip(d.start),d._isInFirstContentOfListItem&&(n._gfmTasklistFirstContentOfListItem=!0),n.write(l),d._isInFirstContentOfListItem&&(n._gfmTasklistFirstContentOfListItem=void 0)),k=d,d=d.next}for(d=j;++c<i.length;)i[c][0]==="exit"&&i[c-1][0]==="enter"&&i[c][1].type===i[c-1][1].type&&i[c][1].start.line!==i[c][1].end.line&&(B=c+1,u.push(B),d._tokenizer=void 0,d.previous=void 0,d=d.next);for(n.events=[],d?(d._tokenizer=void 0,d.previous=void 0):u.pop(),c=u.length;c--;){let E=i.slice(u[c],u[c+1]),f=o.pop();a.push([f,f+E.length-1]),A.splice(f,2,E)}for(a.reverse(),c=-1;++c<a.length;)s[$+a[c][0]]=$+a[c][1],$+=a[c][1]-a[c][0]-1;return s}var nn={tokenize:nE,resolve:rE},tE={tokenize:oE,partial:!0};function rE(A){return Yt(A),A}function nE(A,e){let j;return t;function t(i){return A.enter("content"),j=A.enter("chunkContent",{contentType:"content"}),r(i)}function r(i){return i===null?o(i):O(i)?A.check(tE,n,o)(i):(A.consume(i),r)}function o(i){return A.exit("chunkContent"),A.exit("content"),e(i)}function n(i){return A.consume(i),A.exit("chunkContent"),j.next=A.enter("chunkContent",{contentType:"content",previous:j}),j=j.next,r}}function oE(A,e,j){let t=this;return r;function r(n){return A.exit("chunkContent"),A.enter("lineEnding"),A.consume(n),A.exit("lineEnding"),D(A,o,"linePrefix")}function o(n){if(n===null||O(n))return j(n);let i=t.events[t.events.length-1];return!t.parser.constructs.disable.null.includes("codeIndented")&&i&&i[1].type==="linePrefix"&&i[2].sliceSerialize(i[1],!0).length>=4?e(n):A.interrupt(t.parser.constructs.flow,j,e)(n)}}function Zt(A,e,j,t,r,o,n,i,a){let s=a||Number.POSITIVE_INFINITY,l=0;return k;function k(E){return E===60?(A.enter(t),A.enter(r),A.enter(o),A.consume(E),A.exit(o),c):E===null||E===32||E===41||Pj(E)?j(E):(A.enter(t),A.enter(n),A.enter(i),A.enter("chunkString",{contentType:"string"}),B(E))}function c(E){return E===62?(A.enter(o),A.consume(E),A.exit(o),A.exit(r),A.exit(t),e):(A.enter(i),A.enter("chunkString",{contentType:"string"}),d(E))}function d(E){return E===62?(A.exit("chunkString"),A.exit(i),c(E)):E===null||E===60||O(E)?j(E):(A.consume(E),E===92?$:d)}function $(E){return E===60||E===62||E===92?(A.consume(E),d):d(E)}function B(E){return!l&&(E===null||E===41||Q(E))?(A.exit("chunkString"),A.exit(i),A.exit(n),A.exit(t),e(E)):l<s&&E===40?(A.consume(E),l++,B):E===41?(A.consume(E),l--,B):E===null||E===32||E===40||Pj(E)?j(E):(A.consume(E),E===92?u:B)}function u(E){return E===40||E===41||E===92?(A.consume(E),B):B(E)}}function Ar(A,e,j,t,r,o){let n=this,i=0,a;return s;function s(d){return A.enter(t),A.enter(r),A.consume(d),A.exit(r),A.enter(o),l}function l(d){return i>999||d===null||d===91||d===93&&!a||d===94&&!i&&"_hiddenFootnoteSupport"in n.parser.constructs?j(d):d===93?(A.exit(o),A.enter(r),A.consume(d),A.exit(r),A.exit(t),e):O(d)?(A.enter("lineEnding"),A.consume(d),A.exit("lineEnding"),l):(A.enter("chunkString",{contentType:"string"}),k(d))}function k(d){return d===null||d===91||d===93||O(d)||i++>999?(A.exit("chunkString"),l(d)):(A.consume(d),a||(a=!q(d)),d===92?c:k)}function c(d){return d===91||d===92||d===93?(A.consume(d),i++,k):k(d)}}function jr(A,e,j,t,r,o){let n;return i;function i(c){return c===34||c===39||c===40?(A.enter(t),A.enter(r),A.consume(c),A.exit(r),n=c===40?41:c,a):j(c)}function a(c){return c===n?(A.enter(r),A.consume(c),A.exit(r),A.exit(t),e):(A.enter(o),s(c))}function s(c){return c===n?(A.exit(o),a(n)):c===null?j(c):O(c)?(A.enter("lineEnding"),A.consume(c),A.exit("lineEnding"),D(A,s,"linePrefix")):(A.enter("chunkString",{contentType:"string"}),l(c))}function l(c){return c===n||c===null||O(c)?(A.exit("chunkString"),s(c)):(A.consume(c),c===92?k:l)}function k(c){return c===n||c===92?(A.consume(c),l):l(c)}}function Cj(A,e){let j;return t;function t(r){return O(r)?(A.enter("lineEnding"),A.consume(r),A.exit("lineEnding"),j=!0,t):q(r)?D(A,t,j?"linePrefix":"lineSuffix")(r):e(r)}}var on={name:"definition",tokenize:aE},iE={tokenize:sE,partial:!0};function aE(A,e,j){let t=this,r;return o;function o(d){return A.enter("definition"),n(d)}function n(d){return Ar.call(t,A,i,j,"definitionLabel","definitionLabelMarker","definitionLabelString")(d)}function i(d){return r=RA(t.sliceSerialize(t.events[t.events.length-1][1]).slice(1,-1)),d===58?(A.enter("definitionMarker"),A.consume(d),A.exit("definitionMarker"),a):j(d)}function a(d){return Q(d)?Cj(A,s)(d):s(d)}function s(d){return Zt(A,l,j,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(d)}function l(d){return A.attempt(iE,k,k)(d)}function k(d){return q(d)?D(A,c,"whitespace")(d):c(d)}function c(d){return d===null||O(d)?(A.exit("definition"),t.parser.defined.push(r),e(d)):j(d)}}function sE(A,e,j){return t;function t(i){return Q(i)?Cj(A,r)(i):j(i)}function r(i){return jr(A,o,j,"definitionTitle","definitionTitleMarker","definitionTitleString")(i)}function o(i){return q(i)?D(A,n,"whitespace")(i):n(i)}function n(i){return i===null||O(i)?e(i):j(i)}}var an={name:"hardBreakEscape",tokenize:lE};function lE(A,e,j){return t;function t(o){return A.enter("hardBreakEscape"),A.consume(o),r}function r(o){return O(o)?(A.exit("hardBreakEscape"),e(o)):j(o)}}var sn={name:"headingAtx",tokenize:cE,resolve:kE};function kE(A,e){let j=A.length-2,t=3,r,o;return A[t][1].type==="whitespace"&&(t+=2),j-2>t&&A[j][1].type==="whitespace"&&(j-=2),A[j][1].type==="atxHeadingSequence"&&(t===j-1||j-4>t&&A[j-2][1].type==="whitespace")&&(j-=t+1===j?2:4),j>t&&(r={type:"atxHeadingText",start:A[t][1].start,end:A[j][1].end},o={type:"chunkText",start:A[t][1].start,end:A[j][1].end,contentType:"text"},cA(A,t,j-t+1,[["enter",r,e],["enter",o,e],["exit",o,e],["exit",r,e]])),A}function cE(A,e,j){let t=0;return r;function r(l){return A.enter("atxHeading"),o(l)}function o(l){return A.enter("atxHeadingSequence"),n(l)}function n(l){return l===35&&t++<6?(A.consume(l),n):l===null||Q(l)?(A.exit("atxHeadingSequence"),i(l)):j(l)}function i(l){return l===35?(A.enter("atxHeadingSequence"),a(l)):l===null||O(l)?(A.exit("atxHeading"),e(l)):q(l)?D(A,i,"whitespace")(l):(A.enter("atxHeadingText"),s(l))}function a(l){return l===35?(A.consume(l),a):(A.exit("atxHeadingSequence"),i(l))}function s(l){return l===null||l===35||Q(l)?(A.exit("atxHeadingText"),i(l)):(A.consume(l),s)}}var Z7=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],ln=["pre","script","style","textarea"];var kn={name:"htmlFlow",tokenize:BE,resolveTo:EE,concrete:!0},dE={tokenize:pE,partial:!0},$E={tokenize:uE,partial:!0};function EE(A){let e=A.length;for(;e--&&!(A[e][0]==="enter"&&A[e][1].type==="htmlFlow"););return e>1&&A[e-2][1].type==="linePrefix"&&(A[e][1].start=A[e-2][1].start,A[e+1][1].start=A[e-2][1].start,A.splice(e-2,2)),A}function BE(A,e,j){let t=this,r,o,n,i,a;return s;function s(m){return l(m)}function l(m){return A.enter("htmlFlow"),A.enter("htmlFlowData"),A.consume(m),k}function k(m){return m===33?(A.consume(m),c):m===47?(A.consume(m),o=!0,B):m===63?(A.consume(m),r=3,t.interrupt?e:p):$A(m)?(A.consume(m),n=String.fromCharCode(m),u):j(m)}function c(m){return m===45?(A.consume(m),r=2,d):m===91?(A.consume(m),r=5,i=0,$):$A(m)?(A.consume(m),r=4,t.interrupt?e:p):j(m)}function d(m){return m===45?(A.consume(m),t.interrupt?e:p):j(m)}function $(m){let aA="CDATA[";return m===aA.charCodeAt(i++)?(A.consume(m),i===aA.length?t.interrupt?e:w:$):j(m)}function B(m){return $A(m)?(A.consume(m),n=String.fromCharCode(m),u):j(m)}function u(m){if(m===null||m===47||m===62||Q(m)){let aA=m===47,bA=n.toLowerCase();return!aA&&!o&&ln.includes(bA)?(r=1,t.interrupt?e(m):w(m)):Z7.includes(n.toLowerCase())?(r=6,aA?(A.consume(m),E):t.interrupt?e(m):w(m)):(r=7,t.interrupt&&!t.parser.lazy[t.now().line]?j(m):o?f(m):F(m))}return m===45||iA(m)?(A.consume(m),n+=String.fromCharCode(m),u):j(m)}function E(m){return m===62?(A.consume(m),t.interrupt?e:w):j(m)}function f(m){return q(m)?(A.consume(m),f):R(m)}function F(m){return m===47?(A.consume(m),R):m===58||m===95||$A(m)?(A.consume(m),g):q(m)?(A.consume(m),F):R(m)}function g(m){return m===45||m===46||m===58||m===95||iA(m)?(A.consume(m),g):b(m)}function b(m){return m===61?(A.consume(m),G):q(m)?(A.consume(m),b):F(m)}function G(m){return m===null||m===60||m===61||m===62||m===96?j(m):m===34||m===39?(A.consume(m),a=m,v):q(m)?(A.consume(m),G):N(m)}function v(m){return m===a?(A.consume(m),a=null,C):m===null||O(m)?j(m):(A.consume(m),v)}function N(m){return m===null||m===34||m===39||m===47||m===60||m===61||m===62||m===96||Q(m)?b(m):(A.consume(m),N)}function C(m){return m===47||m===62||q(m)?F(m):j(m)}function R(m){return m===62?(A.consume(m),K):j(m)}function K(m){return m===null||O(m)?w(m):q(m)?(A.consume(m),K):j(m)}function w(m){return m===45&&r===2?(A.consume(m),H):m===60&&r===1?(A.consume(m),V):m===62&&r===4?(A.consume(m),Y):m===63&&r===3?(A.consume(m),p):m===93&&r===5?(A.consume(m),eA):O(m)&&(r===6||r===7)?(A.exit("htmlFlowData"),A.check(dE,tA,y)(m)):m===null||O(m)?(A.exit("htmlFlowData"),y(m)):(A.consume(m),w)}function y(m){return A.check($E,S,tA)(m)}function S(m){return A.enter("lineEnding"),A.consume(m),A.exit("lineEnding"),P}function P(m){return m===null||O(m)?y(m):(A.enter("htmlFlowData"),w(m))}function H(m){return m===45?(A.consume(m),p):w(m)}function V(m){return m===47?(A.consume(m),n="",rA):w(m)}function rA(m){if(m===62){let aA=n.toLowerCase();return ln.includes(aA)?(A.consume(m),Y):w(m)}return $A(m)&&n.length<8?(A.consume(m),n+=String.fromCharCode(m),rA):w(m)}function eA(m){return m===93?(A.consume(m),p):w(m)}function p(m){return m===62?(A.consume(m),Y):m===45&&r===2?(A.consume(m),p):w(m)}function Y(m){return m===null||O(m)?(A.exit("htmlFlowData"),tA(m)):(A.consume(m),Y)}function tA(m){return A.exit("htmlFlow"),e(m)}}function uE(A,e,j){let t=this;return r;function r(n){return O(n)?(A.enter("lineEnding"),A.consume(n),A.exit("lineEnding"),o):j(n)}function o(n){return t.parser.lazy[t.now().line]?j(n):e(n)}}function pE(A,e,j){return t;function t(r){return A.enter("lineEnding"),A.consume(r),A.exit("lineEnding"),A.attempt(zA,e,j)}}var cn={name:"htmlText",tokenize:mE};function mE(A,e,j){let t=this,r,o,n;return i;function i(p){return A.enter("htmlText"),A.enter("htmlTextData"),A.consume(p),a}function a(p){return p===33?(A.consume(p),s):p===47?(A.consume(p),b):p===63?(A.consume(p),F):$A(p)?(A.consume(p),N):j(p)}function s(p){return p===45?(A.consume(p),l):p===91?(A.consume(p),o=0,$):$A(p)?(A.consume(p),f):j(p)}function l(p){return p===45?(A.consume(p),d):j(p)}function k(p){return p===null?j(p):p===45?(A.consume(p),c):O(p)?(n=k,V(p)):(A.consume(p),k)}function c(p){return p===45?(A.consume(p),d):k(p)}function d(p){return p===62?H(p):p===45?c(p):k(p)}function $(p){let Y="CDATA[";return p===Y.charCodeAt(o++)?(A.consume(p),o===Y.length?B:$):j(p)}function B(p){return p===null?j(p):p===93?(A.consume(p),u):O(p)?(n=B,V(p)):(A.consume(p),B)}function u(p){return p===93?(A.consume(p),E):B(p)}function E(p){return p===62?H(p):p===93?(A.consume(p),E):B(p)}function f(p){return p===null||p===62?H(p):O(p)?(n=f,V(p)):(A.consume(p),f)}function F(p){return p===null?j(p):p===63?(A.consume(p),g):O(p)?(n=F,V(p)):(A.consume(p),F)}function g(p){return p===62?H(p):F(p)}function b(p){return $A(p)?(A.consume(p),G):j(p)}function G(p){return p===45||iA(p)?(A.consume(p),G):v(p)}function v(p){return O(p)?(n=v,V(p)):q(p)?(A.consume(p),v):H(p)}function N(p){return p===45||iA(p)?(A.consume(p),N):p===47||p===62||Q(p)?C(p):j(p)}function C(p){return p===47?(A.consume(p),H):p===58||p===95||$A(p)?(A.consume(p),R):O(p)?(n=C,V(p)):q(p)?(A.consume(p),C):H(p)}function R(p){return p===45||p===46||p===58||p===95||iA(p)?(A.consume(p),R):K(p)}function K(p){return p===61?(A.consume(p),w):O(p)?(n=K,V(p)):q(p)?(A.consume(p),K):C(p)}function w(p){return p===null||p===60||p===61||p===62||p===96?j(p):p===34||p===39?(A.consume(p),r=p,y):O(p)?(n=w,V(p)):q(p)?(A.consume(p),w):(A.consume(p),S)}function y(p){return p===r?(A.consume(p),r=void 0,P):p===null?j(p):O(p)?(n=y,V(p)):(A.consume(p),y)}function S(p){return p===null||p===34||p===39||p===60||p===61||p===96?j(p):p===47||p===62||Q(p)?C(p):(A.consume(p),S)}function P(p){return p===47||p===62||Q(p)?C(p):j(p)}function H(p){return p===62?(A.consume(p),A.exit("htmlTextData"),A.exit("htmlText"),e):j(p)}function V(p){return A.exit("htmlTextData"),A.enter("lineEnding"),A.consume(p),A.exit("lineEnding"),rA}function rA(p){return q(p)?D(A,eA,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(p):eA(p)}function eA(p){return A.enter("htmlTextData"),n(p)}}var Tj={name:"labelEnd",tokenize:hE,resolveTo:IE,resolveAll:FE},fE={tokenize:gE},GE={tokenize:bE},RE={tokenize:_E};function FE(A){let e=-1;for(;++e<A.length;){let j=A[e][1];(j.type==="labelImage"||j.type==="labelLink"||j.type==="labelEnd")&&(A.splice(e+1,j.type==="labelImage"?4:2),j.type="data",e++)}return A}function IE(A,e){let j=A.length,t=0,r,o,n,i;for(;j--;)if(r=A[j][1],o){if(r.type==="link"||r.type==="labelLink"&&r._inactive)break;A[j][0]==="enter"&&r.type==="labelLink"&&(r._inactive=!0)}else if(n){if(A[j][0]==="enter"&&(r.type==="labelImage"||r.type==="labelLink")&&!r._balanced&&(o=j,r.type!=="labelLink")){t=2;break}}else r.type==="labelEnd"&&(n=j);let a={type:A[o][1].type==="labelLink"?"link":"image",start:Object.assign({},A[o][1].start),end:Object.assign({},A[A.length-1][1].end)},s={type:"label",start:Object.assign({},A[o][1].start),end:Object.assign({},A[n][1].end)},l={type:"labelText",start:Object.assign({},A[o+t+2][1].end),end:Object.assign({},A[n-2][1].start)};return i=[["enter",a,e],["enter",s,e]],i=IA(i,A.slice(o+1,o+t+3)),i=IA(i,[["enter",l,e]]),i=IA(i,Bj(e.parser.constructs.insideSpan.null,A.slice(o+t+4,n-3),e)),i=IA(i,[["exit",l,e],A[n-2],A[n-1],["exit",s,e]]),i=IA(i,A.slice(n+1)),i=IA(i,[["exit",a,e]]),cA(A,o,A.length,i),A}function hE(A,e,j){let t=this,r=t.events.length,o,n;for(;r--;)if((t.events[r][1].type==="labelImage"||t.events[r][1].type==="labelLink")&&!t.events[r][1]._balanced){o=t.events[r][1];break}return i;function i(c){return o?o._inactive?k(c):(n=t.parser.defined.includes(RA(t.sliceSerialize({start:o.end,end:t.now()}))),A.enter("labelEnd"),A.enter("labelMarker"),A.consume(c),A.exit("labelMarker"),A.exit("labelEnd"),a):j(c)}function a(c){return c===40?A.attempt(fE,l,n?l:k)(c):c===91?A.attempt(GE,l,n?s:k)(c):n?l(c):k(c)}function s(c){return A.attempt(RE,l,k)(c)}function l(c){return e(c)}function k(c){return o._balanced=!0,j(c)}}function gE(A,e,j){return t;function t(k){return A.enter("resource"),A.enter("resourceMarker"),A.consume(k),A.exit("resourceMarker"),r}function r(k){return Q(k)?Cj(A,o)(k):o(k)}function o(k){return k===41?l(k):Zt(A,n,i,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(k)}function n(k){return Q(k)?Cj(A,a)(k):l(k)}function i(k){return j(k)}function a(k){return k===34||k===39||k===40?jr(A,s,j,"resourceTitle","resourceTitleMarker","resourceTitleString")(k):l(k)}function s(k){return Q(k)?Cj(A,l)(k):l(k)}function l(k){return k===41?(A.enter("resourceMarker"),A.consume(k),A.exit("resourceMarker"),A.exit("resource"),e):j(k)}}function bE(A,e,j){let t=this;return r;function r(i){return Ar.call(t,A,o,n,"reference","referenceMarker","referenceString")(i)}function o(i){return t.parser.defined.includes(RA(t.sliceSerialize(t.events[t.events.length-1][1]).slice(1,-1)))?e(i):j(i)}function n(i){return j(i)}}function _E(A,e,j){return t;function t(o){return A.enter("reference"),A.enter("referenceMarker"),A.consume(o),A.exit("referenceMarker"),r}function r(o){return o===93?(A.enter("referenceMarker"),A.consume(o),A.exit("referenceMarker"),A.exit("reference"),e):j(o)}}var dn={name:"labelStartImage",tokenize:yE,resolveAll:Tj.resolveAll};function yE(A,e,j){let t=this;return r;function r(i){return A.enter("labelImage"),A.enter("labelImageMarker"),A.consume(i),A.exit("labelImageMarker"),o}function o(i){return i===91?(A.enter("labelMarker"),A.consume(i),A.exit("labelMarker"),A.exit("labelImage"),n):j(i)}function n(i){return i===94&&"_hiddenFootnoteSupport"in t.parser.constructs?j(i):e(i)}}var $n={name:"labelStartLink",tokenize:SE,resolveAll:Tj.resolveAll};function SE(A,e,j){let t=this;return r;function r(n){return A.enter("labelLink"),A.enter("labelMarker"),A.consume(n),A.exit("labelMarker"),A.exit("labelLink"),o}function o(n){return n===94&&"_hiddenFootnoteSupport"in t.parser.constructs?j(n):e(n)}}var Xe={name:"lineEnding",tokenize:ME};function ME(A,e){return j;function j(t){return A.enter("lineEnding"),A.consume(t),A.exit("lineEnding"),D(A,e,"linePrefix")}}var Dj={name:"thematicBreak",tokenize:OE};function OE(A,e,j){let t=0,r;return o;function o(s){return A.enter("thematicBreak"),n(s)}function n(s){return r=s,i(s)}function i(s){return s===r?(A.enter("thematicBreakSequence"),a(s)):t>=3&&(s===null||O(s))?(A.exit("thematicBreak"),e(s)):j(s)}function a(s){return s===r?(A.consume(s),t++,a):(A.exit("thematicBreakSequence"),q(s)?D(A,i,"whitespace")(s):i(s))}}var FA={name:"list",tokenize:xE,continuation:{tokenize:CE},exit:DE},PE={tokenize:wE,partial:!0},vE={tokenize:TE,partial:!0};function xE(A,e,j){let t=this,r=t.events[t.events.length-1],o=r&&r[1].type==="linePrefix"?r[2].sliceSerialize(r[1],!0).length:0,n=0;return i;function i(d){let $=t.containerState.type||(d===42||d===43||d===45?"listUnordered":"listOrdered");if($==="listUnordered"?!t.containerState.marker||d===t.containerState.marker:He(d)){if(t.containerState.type||(t.containerState.type=$,A.enter($,{_container:!0})),$==="listUnordered")return A.enter("listItemPrefix"),d===42||d===45?A.check(Dj,j,s)(d):s(d);if(!t.interrupt||d===49)return A.enter("listItemPrefix"),A.enter("listItemValue"),a(d)}return j(d)}function a(d){return He(d)&&++n<10?(A.consume(d),a):(!t.interrupt||n<2)&&(t.containerState.marker?d===t.containerState.marker:d===41||d===46)?(A.exit("listItemValue"),s(d)):j(d)}function s(d){return A.enter("listItemMarker"),A.consume(d),A.exit("listItemMarker"),t.containerState.marker=t.containerState.marker||d,A.check(zA,t.interrupt?j:l,A.attempt(PE,c,k))}function l(d){return t.containerState.initialBlankLine=!0,o++,c(d)}function k(d){return q(d)?(A.enter("listItemPrefixWhitespace"),A.consume(d),A.exit("listItemPrefixWhitespace"),c):j(d)}function c(d){return t.containerState.size=o+t.sliceSerialize(A.exit("listItemPrefix"),!0).length,e(d)}}function CE(A,e,j){let t=this;return t.containerState._closeFlow=void 0,A.check(zA,r,o);function r(i){return t.containerState.furtherBlankLines=t.containerState.furtherBlankLines||t.containerState.initialBlankLine,D(A,e,"listItemIndent",t.containerState.size+1)(i)}function o(i){return t.containerState.furtherBlankLines||!q(i)?(t.containerState.furtherBlankLines=void 0,t.containerState.initialBlankLine=void 0,n(i)):(t.containerState.furtherBlankLines=void 0,t.containerState.initialBlankLine=void 0,A.attempt(vE,e,n)(i))}function n(i){return t.containerState._closeFlow=!0,t.interrupt=void 0,D(A,A.attempt(FA,e,j),"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(i)}}function TE(A,e,j){let t=this;return D(A,r,"listItemIndent",t.containerState.size+1);function r(o){let n=t.events[t.events.length-1];return n&&n[1].type==="listItemIndent"&&n[2].sliceSerialize(n[1],!0).length===t.containerState.size?e(o):j(o)}}function DE(A){A.exit(this.containerState.type)}function wE(A,e,j){let t=this;return D(A,r,"listItemPrefixWhitespace",t.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function r(o){let n=t.events[t.events.length-1];return!q(o)&&n&&n[1].type==="listItemPrefixWhitespace"?e(o):j(o)}}var er={name:"setextUnderline",tokenize:NE,resolveTo:qE};function qE(A,e){let j=A.length,t,r,o;for(;j--;)if(A[j][0]==="enter"){if(A[j][1].type==="content"){t=j;break}A[j][1].type==="paragraph"&&(r=j)}else A[j][1].type==="content"&&A.splice(j,1),!o&&A[j][1].type==="definition"&&(o=j);let n={type:"setextHeading",start:Object.assign({},A[r][1].start),end:Object.assign({},A[A.length-1][1].end)};return A[r][1].type="setextHeadingText",o?(A.splice(r,0,["enter",n,e]),A.splice(o+1,0,["exit",A[t][1],e]),A[t][1].end=Object.assign({},A[o][1].end)):A[t][1]=n,A.push(["exit",n,e]),A}function NE(A,e,j){let t=this,r;return o;function o(s){let l=t.events.length,k;for(;l--;)if(t.events[l][1].type!=="lineEnding"&&t.events[l][1].type!=="linePrefix"&&t.events[l][1].type!=="content"){k=t.events[l][1].type==="paragraph";break}return!t.parser.lazy[t.now().line]&&(t.interrupt||k)?(A.enter("setextHeadingLine"),r=s,n(s)):j(s)}function n(s){return A.enter("setextHeadingLineSequence"),i(s)}function i(s){return s===r?(A.consume(s),i):(A.exit("setextHeadingLineSequence"),q(s)?D(A,a,"lineSuffix")(s):a(s))}function a(s){return s===null||O(s)?(A.exit("setextHeadingLine"),e(s)):j(s)}}var KE={tokenize:XE,partial:!0};function En(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:QE,continuation:{tokenize:UE},exit:VE}},text:{91:{name:"gfmFootnoteCall",tokenize:HE},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:LE,resolveTo:JE}}}}function LE(A,e,j){let t=this,r=t.events.length,o=t.parser.gfmFootnotes||(t.parser.gfmFootnotes=[]),n;for(;r--;){let a=t.events[r][1];if(a.type==="labelImage"){n=a;break}if(a.type==="gfmFootnoteCall"||a.type==="labelLink"||a.type==="label"||a.type==="image"||a.type==="link")break}return i;function i(a){if(!n||!n._balanced)return j(a);let s=RA(t.sliceSerialize({start:n.end,end:t.now()}));return s.codePointAt(0)!==94||!o.includes(s.slice(1))?j(a):(A.enter("gfmFootnoteCallLabelMarker"),A.consume(a),A.exit("gfmFootnoteCallLabelMarker"),e(a))}}function JE(A,e){let j=A.length,t;for(;j--;)if(A[j][1].type==="labelImage"&&A[j][0]==="enter"){t=A[j][1];break}A[j+1][1].type="data",A[j+3][1].type="gfmFootnoteCallLabelMarker";let r={type:"gfmFootnoteCall",start:Object.assign({},A[j+3][1].start),end:Object.assign({},A[A.length-1][1].end)},o={type:"gfmFootnoteCallMarker",start:Object.assign({},A[j+3][1].end),end:Object.assign({},A[j+3][1].end)};o.end.column++,o.end.offset++,o.end._bufferIndex++;let n={type:"gfmFootnoteCallString",start:Object.assign({},o.end),end:Object.assign({},A[A.length-1][1].start)},i={type:"chunkString",contentType:"string",start:Object.assign({},n.start),end:Object.assign({},n.end)},a=[A[j+1],A[j+2],["enter",r,e],A[j+3],A[j+4],["enter",o,e],["exit",o,e],["enter",n,e],["enter",i,e],["exit",i,e],["exit",n,e],A[A.length-2],A[A.length-1],["exit",r,e]];return A.splice(j,A.length-j+1,...a),A}function HE(A,e,j){let t=this,r=t.parser.gfmFootnotes||(t.parser.gfmFootnotes=[]),o=0,n;return i;function i(k){return A.enter("gfmFootnoteCall"),A.enter("gfmFootnoteCallLabelMarker"),A.consume(k),A.exit("gfmFootnoteCallLabelMarker"),a}function a(k){return k!==94?j(k):(A.enter("gfmFootnoteCallMarker"),A.consume(k),A.exit("gfmFootnoteCallMarker"),A.enter("gfmFootnoteCallString"),A.enter("chunkString").contentType="string",s)}function s(k){if(o>999||k===93&&!n||k===null||k===91||Q(k))return j(k);if(k===93){A.exit("chunkString");let c=A.exit("gfmFootnoteCallString");return r.includes(RA(t.sliceSerialize(c)))?(A.enter("gfmFootnoteCallLabelMarker"),A.consume(k),A.exit("gfmFootnoteCallLabelMarker"),A.exit("gfmFootnoteCall"),e):j(k)}return Q(k)||(n=!0),o++,A.consume(k),k===92?l:s}function l(k){return k===91||k===92||k===93?(A.consume(k),o++,s):s(k)}}function QE(A,e,j){let t=this,r=t.parser.gfmFootnotes||(t.parser.gfmFootnotes=[]),o,n=0,i;return a;function a($){return A.enter("gfmFootnoteDefinition")._container=!0,A.enter("gfmFootnoteDefinitionLabel"),A.enter("gfmFootnoteDefinitionLabelMarker"),A.consume($),A.exit("gfmFootnoteDefinitionLabelMarker"),s}function s($){return $===94?(A.enter("gfmFootnoteDefinitionMarker"),A.consume($),A.exit("gfmFootnoteDefinitionMarker"),A.enter("gfmFootnoteDefinitionLabelString"),A.enter("chunkString").contentType="string",l):j($)}function l($){if(n>999||$===93&&!i||$===null||$===91||Q($))return j($);if($===93){A.exit("chunkString");let B=A.exit("gfmFootnoteDefinitionLabelString");return o=RA(t.sliceSerialize(B)),A.enter("gfmFootnoteDefinitionLabelMarker"),A.consume($),A.exit("gfmFootnoteDefinitionLabelMarker"),A.exit("gfmFootnoteDefinitionLabel"),c}return Q($)||(i=!0),n++,A.consume($),$===92?k:l}function k($){return $===91||$===92||$===93?(A.consume($),n++,l):l($)}function c($){return $===58?(A.enter("definitionMarker"),A.consume($),A.exit("definitionMarker"),r.includes(o)||r.push(o),D(A,d,"gfmFootnoteDefinitionWhitespace")):j($)}function d($){return e($)}}function UE(A,e,j){return A.check(zA,e,A.attempt(KE,e,j))}function VE(A){A.exit("gfmFootnoteDefinition")}function XE(A,e,j){let t=this;return D(A,r,"gfmFootnoteDefinitionIndent",5);function r(o){let n=t.events[t.events.length-1];return n&&n[1].type==="gfmFootnoteDefinitionIndent"&&n[2].sliceSerialize(n[1],!0).length===4?e(o):j(o)}}function Bn(A){let j=(A||{}).singleTilde,t={name:"strikethrough",tokenize:o,resolveAll:r};return j==null&&(j=!0),{text:{126:t},insideSpan:{null:[t]},attentionMarkers:{null:[126]}};function r(n,i){let a=-1;for(;++a<n.length;)if(n[a][0]==="enter"&&n[a][1].type==="strikethroughSequenceTemporary"&&n[a][1]._close){let s=a;for(;s--;)if(n[s][0]==="exit"&&n[s][1].type==="strikethroughSequenceTemporary"&&n[s][1]._open&&n[a][1].end.offset-n[a][1].start.offset===n[s][1].end.offset-n[s][1].start.offset){n[a][1].type="strikethroughSequence",n[s][1].type="strikethroughSequence";let l={type:"strikethrough",start:Object.assign({},n[s][1].start),end:Object.assign({},n[a][1].end)},k={type:"strikethroughText",start:Object.assign({},n[s][1].end),end:Object.assign({},n[a][1].start)},c=[["enter",l,i],["enter",n[s][1],i],["exit",n[s][1],i],["enter",k,i]],d=i.parser.constructs.insideSpan.null;d&&cA(c,c.length,0,Bj(d,n.slice(s+1,a),i)),cA(c,c.length,0,[["exit",k,i],["enter",n[a][1],i],["exit",n[a][1],i],["exit",l,i]]),cA(n,s-1,a-s+3,c),a=s+c.length-2;break}}for(a=-1;++a<n.length;)n[a][1].type==="strikethroughSequenceTemporary"&&(n[a][1].type="data");return n}function o(n,i,a){let s=this.previous,l=this.events,k=0;return c;function c($){return s===126&&l[l.length-1][1].type!=="characterEscape"?a($):(n.enter("strikethroughSequenceTemporary"),d($))}function d($){let B=te(s);if($===126)return k>1?a($):(n.consume($),k++,d);if(k<2&&!j)return a($);let u=n.exit("strikethroughSequenceTemporary"),E=te($);return u._open=!E||E===2&&!!B,u._close=!B||B===2&&!!E,i($)}}}var tr=class{constructor(){this.map=[]}add(e,j,t){zE(this,e,j,t)}consume(e){if(this.map.sort(function(o,n){return o[0]-n[0]}),this.map.length===0)return;let j=this.map.length,t=[];for(;j>0;)j-=1,t.push(e.slice(this.map[j][0]+this.map[j][1]),this.map[j][2]),e.length=this.map[j][0];t.push(e.slice()),e.length=0;let r=t.pop();for(;r;){for(let o of r)e.push(o);r=t.pop()}this.map.length=0}};function zE(A,e,j,t){let r=0;if(!(j===0&&t.length===0)){for(;r<A.map.length;){if(A.map[r][0]===e){A.map[r][1]+=j,A.map[r][2].push(...t);return}r+=1}A.map.push([e,j,t])}}function Al(A,e){let j=!1,t=[];for(;e<A.length;){let r=A[e];if(j){if(r[0]==="enter")r[1].type==="tableContent"&&t.push(A[e+1][1].type==="tableDelimiterMarker"?"left":"none");else if(r[1].type==="tableContent"){if(A[e-1][1].type==="tableDelimiterMarker"){let o=t.length-1;t[o]=t[o]==="left"?"center":"right"}}else if(r[1].type==="tableDelimiterRow")break}else r[0]==="enter"&&r[1].type==="tableDelimiterRow"&&(j=!0);e+=1}return t}function un(){return{flow:{null:{name:"table",tokenize:WE,resolveAll:YE}}}}function WE(A,e,j){let t=this,r=0,o=0,n;return i;function i(R){let K=t.events.length-1;for(;K>-1;){let S=t.events[K][1].type;if(S==="lineEnding"||S==="linePrefix")K--;else break}let w=K>-1?t.events[K][1].type:null,y=w==="tableHead"||w==="tableRow"?G:a;return y===G&&t.parser.lazy[t.now().line]?j(R):y(R)}function a(R){return A.enter("tableHead"),A.enter("tableRow"),s(R)}function s(R){return R===124||(n=!0,o+=1),l(R)}function l(R){return R===null?j(R):O(R)?o>1?(o=0,t.interrupt=!0,A.exit("tableRow"),A.enter("lineEnding"),A.consume(R),A.exit("lineEnding"),d):j(R):q(R)?D(A,l,"whitespace")(R):(o+=1,n&&(n=!1,r+=1),R===124?(A.enter("tableCellDivider"),A.consume(R),A.exit("tableCellDivider"),n=!0,l):(A.enter("data"),k(R)))}function k(R){return R===null||R===124||Q(R)?(A.exit("data"),l(R)):(A.consume(R),R===92?c:k)}function c(R){return R===92||R===124?(A.consume(R),k):k(R)}function d(R){return t.interrupt=!1,t.parser.lazy[t.now().line]?j(R):(A.enter("tableDelimiterRow"),n=!1,q(R)?D(A,$,"linePrefix",t.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(R):$(R))}function $(R){return R===45||R===58?u(R):R===124?(n=!0,A.enter("tableCellDivider"),A.consume(R),A.exit("tableCellDivider"),B):b(R)}function B(R){return q(R)?D(A,u,"whitespace")(R):u(R)}function u(R){return R===58?(o+=1,n=!0,A.enter("tableDelimiterMarker"),A.consume(R),A.exit("tableDelimiterMarker"),E):R===45?(o+=1,E(R)):R===null||O(R)?g(R):b(R)}function E(R){return R===45?(A.enter("tableDelimiterFiller"),f(R)):b(R)}function f(R){return R===45?(A.consume(R),f):R===58?(n=!0,A.exit("tableDelimiterFiller"),A.enter("tableDelimiterMarker"),A.consume(R),A.exit("tableDelimiterMarker"),F):(A.exit("tableDelimiterFiller"),F(R))}function F(R){return q(R)?D(A,g,"whitespace")(R):g(R)}function g(R){return R===124?$(R):R===null||O(R)?!n||r!==o?b(R):(A.exit("tableDelimiterRow"),A.exit("tableHead"),e(R)):b(R)}function b(R){return j(R)}function G(R){return A.enter("tableRow"),v(R)}function v(R){return R===124?(A.enter("tableCellDivider"),A.consume(R),A.exit("tableCellDivider"),v):R===null||O(R)?(A.exit("tableRow"),e(R)):q(R)?D(A,v,"whitespace")(R):(A.enter("data"),N(R))}function N(R){return R===null||R===124||Q(R)?(A.exit("data"),v(R)):(A.consume(R),R===92?C:N)}function C(R){return R===92||R===124?(A.consume(R),N):N(R)}}function YE(A,e){let j=-1,t=!0,r=0,o=[0,0,0,0],n=[0,0,0,0],i=!1,a=0,s,l,k,c=new tr;for(;++j<A.length;){let d=A[j],$=d[1];d[0]==="enter"?$.type==="tableHead"?(i=!1,a!==0&&(jl(c,e,a,s,l),l=void 0,a=0),s={type:"table",start:Object.assign({},$.start),end:Object.assign({},$.end)},c.add(j,0,[["enter",s,e]])):$.type==="tableRow"||$.type==="tableDelimiterRow"?(t=!0,k=void 0,o=[0,0,0,0],n=[0,j+1,0,0],i&&(i=!1,l={type:"tableBody",start:Object.assign({},$.start),end:Object.assign({},$.end)},c.add(j,0,[["enter",l,e]])),r=$.type==="tableDelimiterRow"?2:l?3:1):r&&($.type==="data"||$.type==="tableDelimiterMarker"||$.type==="tableDelimiterFiller")?(t=!1,n[2]===0&&(o[1]!==0&&(n[0]=n[1],k=rr(c,e,o,r,void 0,k),o=[0,0,0,0]),n[2]=j)):$.type==="tableCellDivider"&&(t?t=!1:(o[1]!==0&&(n[0]=n[1],k=rr(c,e,o,r,void 0,k)),o=n,n=[o[1],j,0,0])):$.type==="tableHead"?(i=!0,a=j):$.type==="tableRow"||$.type==="tableDelimiterRow"?(a=j,o[1]!==0?(n[0]=n[1],k=rr(c,e,o,r,j,k)):n[1]!==0&&(k=rr(c,e,n,r,j,k)),r=0):r&&($.type==="data"||$.type==="tableDelimiterMarker"||$.type==="tableDelimiterFiller")&&(n[3]=j)}for(a!==0&&jl(c,e,a,s,l),c.consume(e.events),j=-1;++j<e.events.length;){let d=e.events[j];d[0]==="enter"&&d[1].type==="table"&&(d[1]._align=Al(e.events,j))}return A}function rr(A,e,j,t,r,o){let n=t===1?"tableHeader":t===2?"tableDelimiter":"tableData",i="tableContent";j[0]!==0&&(o.end=Object.assign({},re(e.events,j[0])),A.add(j[0],0,[["exit",o,e]]));let a=re(e.events,j[1]);if(o={type:n,start:Object.assign({},a),end:Object.assign({},a)},A.add(j[1],0,[["enter",o,e]]),j[2]!==0){let s=re(e.events,j[2]),l=re(e.events,j[3]),k={type:i,start:Object.assign({},s),end:Object.assign({},l)};if(A.add(j[2],0,[["enter",k,e]]),t!==2){let c=e.events[j[2]],d=e.events[j[3]];if(c[1].end=Object.assign({},d[1].end),c[1].type="chunkText",c[1].contentType="text",j[3]>j[2]+1){let $=j[2]+1,B=j[3]-j[2]-1;A.add($,B,[])}}A.add(j[3]+1,0,[["exit",k,e]])}return r!==void 0&&(o.end=Object.assign({},re(e.events,r)),A.add(r,0,[["exit",o,e]]),o=void 0),o}function jl(A,e,j,t,r){let o=[],n=re(e.events,j);r&&(r.end=Object.assign({},n),o.push(["exit",r,e])),t.end=Object.assign({},n),o.push(["exit",t,e]),A.add(j+1,0,o)}function re(A,e){let j=A[e],t=j[0]==="enter"?"start":"end";return j[1][t]}var ZE={name:"tasklistCheck",tokenize:AB};function pn(){return{text:{91:ZE}}}function AB(A,e,j){let t=this;return r;function r(a){return t.previous!==null||!t._gfmTasklistFirstContentOfListItem?j(a):(A.enter("taskListCheck"),A.enter("taskListCheckMarker"),A.consume(a),A.exit("taskListCheckMarker"),o)}function o(a){return Q(a)?(A.enter("taskListCheckValueUnchecked"),A.consume(a),A.exit("taskListCheckValueUnchecked"),n):a===88||a===120?(A.enter("taskListCheckValueChecked"),A.consume(a),A.exit("taskListCheckValueChecked"),n):j(a)}function n(a){return a===93?(A.enter("taskListCheckMarker"),A.consume(a),A.exit("taskListCheckMarker"),A.exit("taskListCheck"),i):j(a)}function i(a){return O(a)?e(a):q(a)?A.check({tokenize:jB},e,j)(a):j(a)}}function jB(A,e,j){return D(A,t,"whitespace");function t(r){return r===null?j(r):e(r)}}function el(A){return Qt([jn(),En(),Bn(A),un(),pn()])}var eB={};function ze(A){let e=this,j=A||eB,t=e.data(),r=t.micromarkExtensions||(t.micromarkExtensions=[]),o=t.fromMarkdownExtensions||(t.fromMarkdownExtensions=[]),n=t.toMarkdownExtensions||(t.toMarkdownExtensions=[]);r.push(el(j)),o.push(Y6()),n.push(Z6(j))}var tl={tokenize:tB};function tB(A){let e=A.attempt(this.parser.constructs.contentInitial,t,r),j;return e;function t(i){if(i===null){A.consume(i);return}return A.enter("lineEnding"),A.consume(i),A.exit("lineEnding"),D(A,e,"linePrefix")}function r(i){return A.enter("paragraph"),o(i)}function o(i){let a=A.enter("chunkText",{contentType:"text",previous:j});return j&&(j.next=a),j=a,n(i)}function n(i){if(i===null){A.exit("chunkText"),A.exit("paragraph"),A.consume(i);return}return O(i)?(A.consume(i),A.exit("chunkText"),o):(A.consume(i),n)}}var nl={tokenize:rB},rl={tokenize:nB};function rB(A){let e=this,j=[],t=0,r,o,n;return i;function i(F){if(t<j.length){let g=j[t];return e.containerState=g[1],A.attempt(g[0].continuation,a,s)(F)}return s(F)}function a(F){if(t++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,r&&f();let g=e.events.length,b=g,G;for(;b--;)if(e.events[b][0]==="exit"&&e.events[b][1].type==="chunkFlow"){G=e.events[b][1].end;break}E(t);let v=g;for(;v<e.events.length;)e.events[v][1].end=Object.assign({},G),v++;return cA(e.events,b+1,0,e.events.slice(g)),e.events.length=v,s(F)}return i(F)}function s(F){if(t===j.length){if(!r)return c(F);if(r.currentConstruct&&r.currentConstruct.concrete)return $(F);e.interrupt=!!(r.currentConstruct&&!r._gfmTableDynamicInterruptHack)}return e.containerState={},A.check(rl,l,k)(F)}function l(F){return r&&f(),E(t),c(F)}function k(F){return e.parser.lazy[e.now().line]=t!==j.length,n=e.now().offset,$(F)}function c(F){return e.containerState={},A.attempt(rl,d,$)(F)}function d(F){return t++,j.push([e.currentConstruct,e.containerState]),c(F)}function $(F){if(F===null){r&&f(),E(0),A.consume(F);return}return r=r||e.parser.flow(e.now()),A.enter("chunkFlow",{contentType:"flow",previous:o,_tokenizer:r}),B(F)}function B(F){if(F===null){u(A.exit("chunkFlow"),!0),E(0),A.consume(F);return}return O(F)?(A.consume(F),u(A.exit("chunkFlow")),t=0,e.interrupt=void 0,i):(A.consume(F),B)}function u(F,g){let b=e.sliceStream(F);if(g&&b.push(null),F.previous=o,o&&(o.next=F),o=F,r.defineSkip(F.start),r.write(b),e.parser.lazy[F.start.line]){let G=r.events.length;for(;G--;)if(r.events[G][1].start.offset<n&&(!r.events[G][1].end||r.events[G][1].end.offset>n))return;let v=e.events.length,N=v,C,R;for(;N--;)if(e.events[N][0]==="exit"&&e.events[N][1].type==="chunkFlow"){if(C){R=e.events[N][1].end;break}C=!0}for(E(t),G=v;G<e.events.length;)e.events[G][1].end=Object.assign({},R),G++;cA(e.events,N+1,0,e.events.slice(v)),e.events.length=G}}function E(F){let g=j.length;for(;g-- >F;){let b=j[g];e.containerState=b[1],b[0].exit.call(e,A)}j.length=F}function f(){r.write([null]),o=void 0,r=void 0,e.containerState._closeFlow=void 0}}function nB(A,e,j){return D(A,A.attempt(this.parser.constructs.document,e,j),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}var ol={tokenize:oB};function oB(A){let e=this,j=A.attempt(zA,t,A.attempt(this.parser.constructs.flowInitial,r,D(A,A.attempt(this.parser.constructs.flow,r,A.attempt(nn,r)),"linePrefix")));return j;function t(o){if(o===null){A.consume(o);return}return A.enter("lineEndingBlank"),A.consume(o),A.exit("lineEndingBlank"),e.currentConstruct=void 0,j}function r(o){if(o===null){A.consume(o);return}return A.enter("lineEnding"),A.consume(o),A.exit("lineEnding"),e.currentConstruct=void 0,j}}var il={resolveAll:kl()},al=ll("string"),sl=ll("text");function ll(A){return{tokenize:e,resolveAll:kl(A==="text"?iB:void 0)};function e(j){let t=this,r=this.parser.constructs[A],o=j.attempt(r,n,i);return n;function n(l){return s(l)?o(l):i(l)}function i(l){if(l===null){j.consume(l);return}return j.enter("data"),j.consume(l),a}function a(l){return s(l)?(j.exit("data"),o(l)):(j.consume(l),a)}function s(l){if(l===null)return!0;let k=r[l],c=-1;if(k)for(;++c<k.length;){let d=k[c];if(!d.previous||d.previous.call(t,t.previous))return!0}return!1}}}function kl(A){return e;function e(j,t){let r=-1,o;for(;++r<=j.length;)o===void 0?j[r]&&j[r][1].type==="data"&&(o=r,r++):(!j[r]||j[r][1].type!=="data")&&(r!==o+2&&(j[o][1].end=j[r-1][1].end,j.splice(o+2,r-o-2),r=o+2),o=void 0);return A?A(j,t):j}}function iB(A,e){let j=0;for(;++j<=A.length;)if((j===A.length||A[j][1].type==="lineEnding")&&A[j-1][1].type==="data"){let t=A[j-1][1],r=e.sliceStream(t),o=r.length,n=-1,i=0,a;for(;o--;){let s=r[o];if(typeof s=="string"){for(n=s.length;s.charCodeAt(n-1)===32;)i++,n--;if(n)break;n=-1}else if(s===-2)a=!0,i++;else if(s!==-1){o++;break}}if(i){let s={type:j===A.length||a||i<2?"lineSuffix":"hardBreakTrailing",start:{line:t.end.line,column:t.end.column-i,offset:t.end.offset-i,_index:t.start._index+o,_bufferIndex:o?n:t.start._bufferIndex+n},end:Object.assign({},t.end)};t.end=Object.assign({},s.start),t.start.offset===t.end.offset?Object.assign(t,s):(A.splice(j,0,["enter",s,e],["exit",s,e]),j+=2)}j++}return A}function cl(A,e,j){let t=Object.assign(j?Object.assign({},j):{line:1,column:1,offset:0},{_index:0,_bufferIndex:-1}),r={},o=[],n=[],i=[],a=!0,s={consume:g,enter:b,exit:G,attempt:C(v),check:C(N),interrupt:C(N,{interrupt:!0})},l={previous:null,code:null,containerState:{},events:[],parser:A,sliceStream:B,sliceSerialize:$,now:u,defineSkip:E,write:d},k=e.tokenize.call(l,s),c;return e.resolveAll&&o.push(e),l;function d(y){return n=IA(n,y),f(),n[n.length-1]!==null?[]:(R(e,0),l.events=Bj(o,l.events,l),l.events)}function $(y,S){return sB(B(y),S)}function B(y){return aB(n,y)}function u(){let{line:y,column:S,offset:P,_index:H,_bufferIndex:V}=t;return{line:y,column:S,offset:P,_index:H,_bufferIndex:V}}function E(y){r[y.line]=y.column,w()}function f(){let y;for(;t._index<n.length;){let S=n[t._index];if(typeof S=="string")for(y=t._index,t._bufferIndex<0&&(t._bufferIndex=0);t._index===y&&t._bufferIndex<S.length;)F(S.charCodeAt(t._bufferIndex));else F(S)}}function F(y){a=void 0,c=y,k=k(y)}function g(y){O(y)?(t.line++,t.column=1,t.offset+=y===-3?2:1,w()):y!==-1&&(t.column++,t.offset++),t._bufferIndex<0?t._index++:(t._bufferIndex++,t._bufferIndex===n[t._index].length&&(t._bufferIndex=-1,t._index++)),l.previous=y,a=!0}function b(y,S){let P=S||{};return P.type=y,P.start=u(),l.events.push(["enter",P,l]),i.push(P),P}function G(y){let S=i.pop();return S.end=u(),l.events.push(["exit",S,l]),S}function v(y,S){R(y,S.from)}function N(y,S){S.restore()}function C(y,S){return P;function P(H,V,rA){let eA,p,Y,tA;return Array.isArray(H)?aA(H):"tokenize"in H?aA([H]):m(H);function m(dA){return pj;function pj(OA){let TA=OA!==null&&dA[OA],WA=OA!==null&&dA.null,wj=[...Array.isArray(TA)?TA:TA?[TA]:[],...Array.isArray(WA)?WA:WA?[WA]:[]];return aA(wj)(OA)}}function aA(dA){return eA=dA,p=0,dA.length===0?rA:bA(dA[p])}function bA(dA){return pj;function pj(OA){return tA=K(),Y=dA,dA.partial||(l.currentConstruct=dA),dA.name&&l.parser.constructs.disable.null.includes(dA.name)?NA(OA):dA.tokenize.call(S?Object.assign(Object.create(l),S):l,s,CA,NA)(OA)}}function CA(dA){return a=!0,y(Y,tA),V}function NA(dA){return a=!0,tA.restore(),++p<eA.length?bA(eA[p]):rA}}}function R(y,S){y.resolveAll&&!o.includes(y)&&o.push(y),y.resolve&&cA(l.events,S,l.events.length-S,y.resolve(l.events.slice(S),l)),y.resolveTo&&(l.events=y.resolveTo(l.events,l))}function K(){let y=u(),S=l.previous,P=l.currentConstruct,H=l.events.length,V=Array.from(i);return{restore:rA,from:H};function rA(){t=y,l.previous=S,l.currentConstruct=P,l.events.length=H,i=V,w()}}function w(){t.line in r&&t.column<2&&(t.column=r[t.line],t.offset+=r[t.line]-1)}}function aB(A,e){let j=e.start._index,t=e.start._bufferIndex,r=e.end._index,o=e.end._bufferIndex,n;if(j===r)n=[A[j].slice(t,o)];else{if(n=A.slice(j,r),t>-1){let i=n[0];typeof i=="string"?n[0]=i.slice(t):n.shift()}o>0&&n.push(A[r].slice(0,o))}return n}function sB(A,e){let j=-1,t=[],r;for(;++j<A.length;){let o=A[j],n;if(typeof o=="string")n=o;else switch(o){case-5:{n="\r";break}case-4:{n=`
`;break}case-3:{n=`\r
`;break}case-2:{n=e?" ":"	";break}case-1:{if(!e&&r)continue;n=" ";break}default:n=String.fromCharCode(o)}r=o===-2,t.push(n)}return t.join("")}var mn={};Kn(mn,{attentionMarkers:()=>uB,contentInitial:()=>kB,disable:()=>pB,document:()=>lB,flow:()=>dB,flowInitial:()=>cB,insideSpan:()=>BB,string:()=>$B,text:()=>EB});var lB={42:FA,43:FA,45:FA,48:FA,49:FA,50:FA,51:FA,52:FA,53:FA,54:FA,55:FA,56:FA,57:FA,62:Ut},kB={91:on},cB={[-2]:Ue,[-1]:Ue,32:Ue},dB={35:sn,42:Dj,45:[er,Dj],60:kn,61:er,95:Dj,96:zt,126:zt},$B={38:Xt,92:Vt},EB={[-5]:Xe,[-4]:Xe,[-3]:Xe,33:dn,38:Xt,42:Qe,60:[tn,cn],91:$n,92:[an,Vt],93:Tj,95:Qe,96:rn},BB={null:[Qe,il]},uB={null:[42,95]},pB={null:[]};function fn(A){let j=Qt([mn,...(A||{}).extensions||[]]),t={defined:[],lazy:{},constructs:j,content:r(tl),document:r(nl),flow:r(ol),string:r(al),text:r(sl)};return t;function r(o){return n;function n(i){return cl(t,o,i)}}}function Gn(A){for(;!Yt(A););return A}var dl=/[\0\t\n\r]/g;function Rn(){let A=1,e="",j=!0,t;return r;function r(o,n,i){let a=[],s,l,k,c,d;for(o=e+(typeof o=="string"?o.toString():new TextDecoder(n||void 0).decode(o)),k=0,e="",j&&(o.charCodeAt(0)===65279&&k++,j=void 0);k<o.length;){if(dl.lastIndex=k,s=dl.exec(o),c=s&&s.index!==void 0?s.index:o.length,d=o.charCodeAt(c),!s){e=o.slice(k);break}if(d===10&&k===c&&t)a.push(-3),t=void 0;else switch(t&&(a.push(-5),t=void 0),k<c&&(a.push(o.slice(k,c)),A+=c-k),d){case 0:{a.push(65533),A++;break}case 9:{for(l=Math.ceil(A/4)*4,a.push(-2);A++<l;)a.push(-1);break}case 10:{a.push(-4),A=1;break}default:t=!0,A=1}k=c+1}return i&&(t&&a.push(-5),e&&a.push(e),a.push(null)),a}}var El={}.hasOwnProperty;function Fn(A,e,j){return typeof e!="string"&&(j=e,e=void 0),mB(j)(Gn(fn(j).document().write(Rn()(A,e,!0))))}function mB(A){let e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:o(qn),autolinkProtocol:C,autolinkEmail:C,atxHeading:o(Tn),blockQuote:o(OA),characterEscape:C,characterReference:C,codeFenced:o(TA),codeFencedFenceInfo:n,codeFencedFenceMeta:n,codeIndented:o(TA,n),codeText:o(WA,n),codeTextData:C,data:C,codeFlowValue:C,definition:o(wj),definitionDestinationString:n,definitionLabelString:n,definitionTitleString:n,emphasis:o(ie),hardBreakEscape:o(Dn),hardBreakTrailing:o(Dn),htmlFlow:o(wn,n),htmlFlowData:C,htmlText:o(wn,n),htmlTextData:C,image:o(ik),label:n,link:o(qn),listItem:o(ak),listItemValue:c,listOrdered:o(Nn,k),listUnordered:o(Nn),paragraph:o(sk),reference:m,referenceString:n,resourceDestinationString:n,resourceTitleString:n,setextHeading:o(Tn),strong:o(lk),thematicBreak:o(ck)},exit:{atxHeading:a(),atxHeadingSequence:b,autolink:a(),autolinkEmail:pj,autolinkProtocol:dA,blockQuote:a(),characterEscapeValue:R,characterReferenceMarkerHexadecimal:bA,characterReferenceMarkerNumeric:bA,characterReferenceValue:CA,characterReference:NA,codeFenced:a(u),codeFencedFence:B,codeFencedFenceInfo:d,codeFencedFenceMeta:$,codeFlowValue:R,codeIndented:a(E),codeText:a(P),codeTextData:R,data:R,definition:a(),definitionDestinationString:g,definitionLabelString:f,definitionTitleString:F,emphasis:a(),hardBreakEscape:a(w),hardBreakTrailing:a(w),htmlFlow:a(y),htmlFlowData:R,htmlText:a(S),htmlTextData:R,image:a(V),label:eA,labelText:rA,lineEnding:K,link:a(H),listItem:a(),listOrdered:a(),listUnordered:a(),paragraph:a(),referenceString:aA,resourceDestinationString:p,resourceTitleString:Y,resource:tA,setextHeading:a(N),setextHeadingLineSequence:v,setextHeadingText:G,strong:a(),thematicBreak:a()}};Bl(e,(A||{}).mdastExtensions||[]);let j={};return t;function t(h){let M={type:"root",children:[]},L={stack:[M],tokenStack:[],config:e,enter:i,exit:s,buffer:n,resume:l,data:j},U=[],Z=-1;for(;++Z<h.length;)if(h[Z][1].type==="listOrdered"||h[Z][1].type==="listUnordered")if(h[Z][0]==="enter")U.push(Z);else{let DA=U.pop();Z=r(h,DA,Z)}for(Z=-1;++Z<h.length;){let DA=e[h[Z][0]];El.call(DA,h[Z][1].type)&&DA[h[Z][1].type].call(Object.assign({sliceSerialize:h[Z][2].sliceSerialize},L),h[Z][1])}if(L.tokenStack.length>0){let DA=L.tokenStack[L.tokenStack.length-1];(DA[1]||$l).call(L,void 0,DA[0])}for(M.position={start:uj(h.length>0?h[0][1].start:{line:1,column:1,offset:0}),end:uj(h.length>0?h[h.length-2][1].end:{line:1,column:1,offset:0})},Z=-1;++Z<e.transforms.length;)M=e.transforms[Z](M)||M;return M}function r(h,M,L){let U=M-1,Z=-1,DA=!1,mj,YA,ae,se;for(;++U<=L;){let _A=h[U];switch(_A[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{_A[0]==="enter"?Z++:Z--,se=void 0;break}case"lineEndingBlank":{_A[0]==="enter"&&(mj&&!se&&!Z&&!ae&&(ae=U),se=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:se=void 0}if(!Z&&_A[0]==="enter"&&_A[1].type==="listItemPrefix"||Z===-1&&_A[0]==="exit"&&(_A[1].type==="listUnordered"||_A[1].type==="listOrdered")){if(mj){let qj=U;for(YA=void 0;qj--;){let ZA=h[qj];if(ZA[1].type==="lineEnding"||ZA[1].type==="lineEndingBlank"){if(ZA[0]==="exit")continue;YA&&(h[YA][1].type="lineEndingBlank",DA=!0),ZA[1].type="lineEnding",YA=qj}else if(!(ZA[1].type==="linePrefix"||ZA[1].type==="blockQuotePrefix"||ZA[1].type==="blockQuotePrefixWhitespace"||ZA[1].type==="blockQuoteMarker"||ZA[1].type==="listItemIndent"))break}ae&&(!YA||ae<YA)&&(mj._spread=!0),mj.end=Object.assign({},YA?h[YA][1].start:_A[1].end),h.splice(YA||U,0,["exit",mj,_A[2]]),U++,L++}if(_A[1].type==="listItemPrefix"){let qj={type:"listItem",_spread:!1,start:Object.assign({},_A[1].start),end:void 0};mj=qj,h.splice(U,0,["enter",qj,_A[2]]),U++,L++,ae=void 0,se=!0}}}return h[M][1]._spread=DA,L}function o(h,M){return L;function L(U){i.call(this,h(U),U),M&&M.call(this,U)}}function n(){this.stack.push({type:"fragment",children:[]})}function i(h,M,L){this.stack[this.stack.length-1].children.push(h),this.stack.push(h),this.tokenStack.push([M,L]),h.position={start:uj(M.start),end:void 0}}function a(h){return M;function M(L){h&&h.call(this,L),s.call(this,L)}}function s(h,M){let L=this.stack.pop(),U=this.tokenStack.pop();if(U)U[0].type!==h.type&&(M?M.call(this,h,U[0]):(U[1]||$l).call(this,h,U[0]));else throw new Error("Cannot close `"+h.type+"` ("+cj({start:h.start,end:h.end})+"): it\u2019s not open");L.position.end=uj(h.end)}function l(){return Sj(this.stack.pop())}function k(){this.data.expectingFirstListItemValue=!0}function c(h){if(this.data.expectingFirstListItemValue){let M=this.stack[this.stack.length-2];M.start=Number.parseInt(this.sliceSerialize(h),10),this.data.expectingFirstListItemValue=void 0}}function d(){let h=this.resume(),M=this.stack[this.stack.length-1];M.lang=h}function $(){let h=this.resume(),M=this.stack[this.stack.length-1];M.meta=h}function B(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function u(){let h=this.resume(),M=this.stack[this.stack.length-1];M.value=h.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function E(){let h=this.resume(),M=this.stack[this.stack.length-1];M.value=h.replace(/(\r?\n|\r)$/g,"")}function f(h){let M=this.resume(),L=this.stack[this.stack.length-1];L.label=M,L.identifier=RA(this.sliceSerialize(h)).toLowerCase()}function F(){let h=this.resume(),M=this.stack[this.stack.length-1];M.title=h}function g(){let h=this.resume(),M=this.stack[this.stack.length-1];M.url=h}function b(h){let M=this.stack[this.stack.length-1];if(!M.depth){let L=this.sliceSerialize(h).length;M.depth=L}}function G(){this.data.setextHeadingSlurpLineEnding=!0}function v(h){let M=this.stack[this.stack.length-1];M.depth=this.sliceSerialize(h).codePointAt(0)===61?1:2}function N(){this.data.setextHeadingSlurpLineEnding=void 0}function C(h){let L=this.stack[this.stack.length-1].children,U=L[L.length-1];(!U||U.type!=="text")&&(U=kk(),U.position={start:uj(h.start),end:void 0},L.push(U)),this.stack.push(U)}function R(h){let M=this.stack.pop();M.value+=this.sliceSerialize(h),M.position.end=uj(h.end)}function K(h){let M=this.stack[this.stack.length-1];if(this.data.atHardBreak){let L=M.children[M.children.length-1];L.position.end=uj(h.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(M.type)&&(C.call(this,h),R.call(this,h))}function w(){this.data.atHardBreak=!0}function y(){let h=this.resume(),M=this.stack[this.stack.length-1];M.value=h}function S(){let h=this.resume(),M=this.stack[this.stack.length-1];M.value=h}function P(){let h=this.resume(),M=this.stack[this.stack.length-1];M.value=h}function H(){let h=this.stack[this.stack.length-1];if(this.data.inReference){let M=this.data.referenceType||"shortcut";h.type+="Reference",h.referenceType=M,delete h.url,delete h.title}else delete h.identifier,delete h.label;this.data.referenceType=void 0}function V(){let h=this.stack[this.stack.length-1];if(this.data.inReference){let M=this.data.referenceType||"shortcut";h.type+="Reference",h.referenceType=M,delete h.url,delete h.title}else delete h.identifier,delete h.label;this.data.referenceType=void 0}function rA(h){let M=this.sliceSerialize(h),L=this.stack[this.stack.length-2];L.label=Dt(M),L.identifier=RA(M).toLowerCase()}function eA(){let h=this.stack[this.stack.length-1],M=this.resume(),L=this.stack[this.stack.length-1];if(this.data.inReference=!0,L.type==="link"){let U=h.children;L.children=U}else L.alt=M}function p(){let h=this.resume(),M=this.stack[this.stack.length-1];M.url=h}function Y(){let h=this.resume(),M=this.stack[this.stack.length-1];M.title=h}function tA(){this.data.inReference=void 0}function m(){this.data.referenceType="collapsed"}function aA(h){let M=this.resume(),L=this.stack[this.stack.length-1];L.label=M,L.identifier=RA(this.sliceSerialize(h)).toLowerCase(),this.data.referenceType="full"}function bA(h){this.data.characterReferenceType=h.type}function CA(h){let M=this.sliceSerialize(h),L=this.data.characterReferenceType,U;L?(U=Tt(M,L==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):U=je(M);let Z=this.stack[this.stack.length-1];Z.value+=U}function NA(h){let M=this.stack.pop();M.position.end=uj(h.end)}function dA(h){R.call(this,h);let M=this.stack[this.stack.length-1];M.url=this.sliceSerialize(h)}function pj(h){R.call(this,h);let M=this.stack[this.stack.length-1];M.url="mailto:"+this.sliceSerialize(h)}function OA(){return{type:"blockquote",children:[]}}function TA(){return{type:"code",lang:null,meta:null,value:""}}function WA(){return{type:"inlineCode",value:""}}function wj(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ie(){return{type:"emphasis",children:[]}}function Tn(){return{type:"heading",depth:0,children:[]}}function Dn(){return{type:"break"}}function wn(){return{type:"html",value:""}}function ik(){return{type:"image",title:null,url:"",alt:null}}function qn(){return{type:"link",title:null,url:"",children:[]}}function Nn(h){return{type:"list",ordered:h.type==="listOrdered",start:null,spread:h._spread,children:[]}}function ak(h){return{type:"listItem",spread:h._spread,checked:null,children:[]}}function sk(){return{type:"paragraph",children:[]}}function lk(){return{type:"strong",children:[]}}function kk(){return{type:"text",value:""}}function ck(){return{type:"thematicBreak"}}}function uj(A){return{line:A.line,column:A.column,offset:A.offset}}function Bl(A,e){let j=-1;for(;++j<e.length;){let t=e[j];Array.isArray(t)?Bl(A,t):fB(A,t)}}function fB(A,e){let j;for(j in e)if(El.call(e,j))switch(j){case"canContainEols":{let t=e[j];t&&A[j].push(...t);break}case"transforms":{let t=e[j];t&&A[j].push(...t);break}case"enter":case"exit":{let t=e[j];t&&Object.assign(A[j],t);break}}}function $l(A,e){throw A?new Error("Cannot close `"+A.type+"` ("+cj({start:A.start,end:A.end})+"): a different token (`"+e.type+"`, "+cj({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+cj({start:e.start,end:e.end})+") is still open")}function nr(A){let e=this;e.parser=j;function j(t){return Fn(t,{...e.data("settings"),...A,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function ul(A,e){let j={type:"element",tagName:"blockquote",properties:{},children:A.wrap(A.all(e),!0)};return A.patch(e,j),A.applyData(e,j)}function pl(A,e){let j={type:"element",tagName:"br",properties:{},children:[]};return A.patch(e,j),[A.applyData(e,j),{type:"text",value:`
`}]}function ml(A,e){let j=e.value?e.value+`
`:"",t={},r=e.lang?e.lang.split(/\s+/):[];r.length>0&&(t.className=["language-"+r[0]]);let o={type:"element",tagName:"code",properties:t,children:[{type:"text",value:j}]};return e.meta&&(o.data={meta:e.meta}),A.patch(e,o),o=A.applyData(e,o),o={type:"element",tagName:"pre",properties:{},children:[o]},A.patch(e,o),o}function fl(A,e){let j={type:"element",tagName:"del",properties:{},children:A.all(e)};return A.patch(e,j),A.applyData(e,j)}function Gl(A,e){let j={type:"element",tagName:"em",properties:{},children:A.all(e)};return A.patch(e,j),A.applyData(e,j)}function Rl(A,e){let j=typeof A.options.clobberPrefix=="string"?A.options.clobberPrefix:"user-content-",t=String(e.identifier).toUpperCase(),r=xA(t.toLowerCase()),o=A.footnoteOrder.indexOf(t),n,i=A.footnoteCounts.get(t);i===void 0?(i=0,A.footnoteOrder.push(t),n=A.footnoteOrder.length):n=o+1,i+=1,A.footnoteCounts.set(t,i);let a={type:"element",tagName:"a",properties:{href:"#"+j+"fn-"+r,id:j+"fnref-"+r+(i>1?"-"+i:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(n)}]};A.patch(e,a);let s={type:"element",tagName:"sup",properties:{},children:[a]};return A.patch(e,s),A.applyData(e,s)}function Fl(A,e){let j={type:"element",tagName:"h"+e.depth,properties:{},children:A.all(e)};return A.patch(e,j),A.applyData(e,j)}function Il(A,e){if(A.options.allowDangerousHtml){let j={type:"raw",value:e.value};return A.patch(e,j),A.applyData(e,j)}}function or(A,e){let j=e.referenceType,t="]";if(j==="collapsed"?t+="[]":j==="full"&&(t+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+t}];let r=A.all(e),o=r[0];o&&o.type==="text"?o.value="["+o.value:r.unshift({type:"text",value:"["});let n=r[r.length-1];return n&&n.type==="text"?n.value+=t:r.push({type:"text",value:t}),r}function hl(A,e){let j=String(e.identifier).toUpperCase(),t=A.definitionById.get(j);if(!t)return or(A,e);let r={src:xA(t.url||""),alt:e.alt};t.title!==null&&t.title!==void 0&&(r.title=t.title);let o={type:"element",tagName:"img",properties:r,children:[]};return A.patch(e,o),A.applyData(e,o)}function gl(A,e){let j={src:xA(e.url)};e.alt!==null&&e.alt!==void 0&&(j.alt=e.alt),e.title!==null&&e.title!==void 0&&(j.title=e.title);let t={type:"element",tagName:"img",properties:j,children:[]};return A.patch(e,t),A.applyData(e,t)}function bl(A,e){let j={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};A.patch(e,j);let t={type:"element",tagName:"code",properties:{},children:[j]};return A.patch(e,t),A.applyData(e,t)}function _l(A,e){let j=String(e.identifier).toUpperCase(),t=A.definitionById.get(j);if(!t)return or(A,e);let r={href:xA(t.url||"")};t.title!==null&&t.title!==void 0&&(r.title=t.title);let o={type:"element",tagName:"a",properties:r,children:A.all(e)};return A.patch(e,o),A.applyData(e,o)}function yl(A,e){let j={href:xA(e.url)};e.title!==null&&e.title!==void 0&&(j.title=e.title);let t={type:"element",tagName:"a",properties:j,children:A.all(e)};return A.patch(e,t),A.applyData(e,t)}function Sl(A,e,j){let t=A.all(e),r=j?GB(j):Ml(e),o={},n=[];if(typeof e.checked=="boolean"){let l=t[0],k;l&&l.type==="element"&&l.tagName==="p"?k=l:(k={type:"element",tagName:"p",properties:{},children:[]},t.unshift(k)),k.children.length>0&&k.children.unshift({type:"text",value:" "}),k.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),o.className=["task-list-item"]}let i=-1;for(;++i<t.length;){let l=t[i];(r||i!==0||l.type!=="element"||l.tagName!=="p")&&n.push({type:"text",value:`
`}),l.type==="element"&&l.tagName==="p"&&!r?n.push(...l.children):n.push(l)}let a=t[t.length-1];a&&(r||a.type!=="element"||a.tagName!=="p")&&n.push({type:"text",value:`
`});let s={type:"element",tagName:"li",properties:o,children:n};return A.patch(e,s),A.applyData(e,s)}function GB(A){let e=!1;if(A.type==="list"){e=A.spread||!1;let j=A.children,t=-1;for(;!e&&++t<j.length;)e=Ml(j[t])}return e}function Ml(A){let e=A.spread;return e??A.children.length>1}function Ol(A,e){let j={},t=A.all(e),r=-1;for(typeof e.start=="number"&&e.start!==1&&(j.start=e.start);++r<t.length;){let n=t[r];if(n.type==="element"&&n.tagName==="li"&&n.properties&&Array.isArray(n.properties.className)&&n.properties.className.includes("task-list-item")){j.className=["contains-task-list"];break}}let o={type:"element",tagName:e.ordered?"ol":"ul",properties:j,children:A.wrap(t,!0)};return A.patch(e,o),A.applyData(e,o)}function Pl(A,e){let j={type:"element",tagName:"p",properties:{},children:A.all(e)};return A.patch(e,j),A.applyData(e,j)}function vl(A,e){let j={type:"root",children:A.wrap(A.all(e))};return A.patch(e,j),A.applyData(e,j)}function xl(A,e){let j={type:"element",tagName:"strong",properties:{},children:A.all(e)};return A.patch(e,j),A.applyData(e,j)}var ir=Cl("end"),ar=Cl("start");function Cl(A){return e;function e(j){let t=j&&j.position&&j.position[A]||{};if(typeof t.line=="number"&&t.line>0&&typeof t.column=="number"&&t.column>0)return{line:t.line,column:t.column,offset:typeof t.offset=="number"&&t.offset>-1?t.offset:void 0}}}function In(A){let e=ar(A),j=ir(A);if(e&&j)return{start:e,end:j}}function Tl(A,e){let j=A.all(e),t=j.shift(),r=[];if(t){let n={type:"element",tagName:"thead",properties:{},children:A.wrap([t],!0)};A.patch(e.children[0],n),r.push(n)}if(j.length>0){let n={type:"element",tagName:"tbody",properties:{},children:A.wrap(j,!0)},i=ar(e.children[1]),a=ir(e.children[e.children.length-1]);i&&a&&(n.position={start:i,end:a}),r.push(n)}let o={type:"element",tagName:"table",properties:{},children:A.wrap(r,!0)};return A.patch(e,o),A.applyData(e,o)}function Dl(A,e,j){let t=j?j.children:void 0,o=(t?t.indexOf(e):1)===0?"th":"td",n=j&&j.type==="table"?j.align:void 0,i=n?n.length:e.children.length,a=-1,s=[];for(;++a<i;){let k=e.children[a],c={},d=n?n[a]:void 0;d&&(c.align=d);let $={type:"element",tagName:o,properties:c,children:[]};k&&($.children=A.all(k),A.patch(k,$),$=A.applyData(k,$)),s.push($)}let l={type:"element",tagName:"tr",properties:{},children:A.wrap(s,!0)};return A.patch(e,l),A.applyData(e,l)}function wl(A,e){let j={type:"element",tagName:"td",properties:{},children:A.all(e)};return A.patch(e,j),A.applyData(e,j)}function ql(A,e){let j={type:"text",value:ho(String(e.value))};return A.patch(e,j),A.applyData(e,j)}function Nl(A,e){let j={type:"element",tagName:"hr",properties:{},children:[]};return A.patch(e,j),A.applyData(e,j)}var Kl={blockquote:ul,break:pl,code:ml,delete:fl,emphasis:Gl,footnoteReference:Rl,heading:Fl,html:Il,imageReference:hl,image:gl,inlineCode:bl,linkReference:_l,link:yl,listItem:Sl,list:Ol,paragraph:Pl,root:vl,strong:xl,table:Tl,tableCell:wl,tableRow:Dl,text:ql,thematicBreak:Nl,toml:sr,yaml:sr,definition:sr,footnoteDefinition:sr};function sr(){}var Ll=typeof self=="object"?self:globalThis,RB=(A,e)=>{let j=(r,o)=>(A.set(o,r),r),t=r=>{if(A.has(r))return A.get(r);let[o,n]=e[r];switch(o){case 0:case-1:return j(n,r);case 1:{let i=j([],r);for(let a of n)i.push(t(a));return i}case 2:{let i=j({},r);for(let[a,s]of n)i[t(a)]=t(s);return i}case 3:return j(new Date(n),r);case 4:{let{source:i,flags:a}=n;return j(new RegExp(i,a),r)}case 5:{let i=j(new Map,r);for(let[a,s]of n)i.set(t(a),t(s));return i}case 6:{let i=j(new Set,r);for(let a of n)i.add(t(a));return i}case 7:{let{name:i,message:a}=n;return j(new Ll[i](a),r)}case 8:return j(BigInt(n),r);case"BigInt":return j(Object(BigInt(n)),r)}return j(new Ll[o](n),r)};return t},_n=A=>RB(new Map,A)(0);var ne="",{toString:FB}={},{keys:IB}=Object,At=A=>{let e=typeof A;if(e!=="object"||!A)return[0,e];let j=FB.call(A).slice(8,-1);switch(j){case"Array":return[1,ne];case"Object":return[2,ne];case"Date":return[3,ne];case"RegExp":return[4,ne];case"Map":return[5,ne];case"Set":return[6,ne]}return j.includes("Array")?[1,j]:j.includes("Error")?[7,j]:[2,j]},$r=([A,e])=>A===0&&(e==="function"||e==="symbol"),hB=(A,e,j,t)=>{let r=(n,i)=>{let a=t.push(n)-1;return j.set(i,a),a},o=n=>{if(j.has(n))return j.get(n);let[i,a]=At(n);switch(i){case 0:{let l=n;switch(a){case"bigint":i=8,l=n.toString();break;case"function":case"symbol":if(A)throw new TypeError("unable to serialize "+a);l=null;break;case"undefined":return r([-1],n)}return r([i,l],n)}case 1:{if(a)return r([a,[...n]],n);let l=[],k=r([i,l],n);for(let c of n)l.push(o(c));return k}case 2:{if(a)switch(a){case"BigInt":return r([a,n.toString()],n);case"Boolean":case"Number":case"String":return r([a,n.valueOf()],n)}if(e&&"toJSON"in n)return o(n.toJSON());let l=[],k=r([i,l],n);for(let c of IB(n))(A||!$r(At(n[c])))&&l.push([o(c),o(n[c])]);return k}case 3:return r([i,n.toISOString()],n);case 4:{let{source:l,flags:k}=n;return r([i,{source:l,flags:k}],n)}case 5:{let l=[],k=r([i,l],n);for(let[c,d]of n)(A||!($r(At(c))||$r(At(d))))&&l.push([o(c),o(d)]);return k}case 6:{let l=[],k=r([i,l],n);for(let c of n)(A||!$r(At(c)))&&l.push(o(c));return k}}let{message:s}=n;return r([i,{name:a,message:s}],n)};return o},yn=(A,{json:e,lossy:j}={})=>{let t=[];return hB(!(e||j),!!e,new Map,t)(A),t};var oe=typeof structuredClone=="function"?(A,e)=>e&&("json"in e||"lossy"in e)?_n(yn(A,e)):structuredClone(A):(A,e)=>_n(yn(A,e));function gB(A,e){let j=[{type:"text",value:"\u21A9"}];return e>1&&j.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),j}function bB(A,e){return"Back to reference "+(A+1)+(e>1?"-"+e:"")}function Jl(A){let e=typeof A.options.clobberPrefix=="string"?A.options.clobberPrefix:"user-content-",j=A.options.footnoteBackContent||gB,t=A.options.footnoteBackLabel||bB,r=A.options.footnoteLabel||"Footnotes",o=A.options.footnoteLabelTagName||"h2",n=A.options.footnoteLabelProperties||{className:["sr-only"]},i=[],a=-1;for(;++a<A.footnoteOrder.length;){let s=A.footnoteById.get(A.footnoteOrder[a]);if(!s)continue;let l=A.all(s),k=String(s.identifier).toUpperCase(),c=xA(k.toLowerCase()),d=0,$=[],B=A.footnoteCounts.get(k);for(;B!==void 0&&++d<=B;){$.length>0&&$.push({type:"text",value:" "});let f=typeof j=="string"?j:j(a,d);typeof f=="string"&&(f={type:"text",value:f}),$.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+c+(d>1?"-"+d:""),dataFootnoteBackref:"",ariaLabel:typeof t=="string"?t:t(a,d),className:["data-footnote-backref"]},children:Array.isArray(f)?f:[f]})}let u=l[l.length-1];if(u&&u.type==="element"&&u.tagName==="p"){let f=u.children[u.children.length-1];f&&f.type==="text"?f.value+=" ":u.children.push({type:"text",value:" "}),u.children.push(...$)}else l.push(...$);let E={type:"element",tagName:"li",properties:{id:e+"fn-"+c},children:A.wrap(l,!0)};A.patch(s,E),i.push(E)}if(i.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:o,properties:{...oe(n),id:"footnote-label"},children:[{type:"text",value:r}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:A.wrap(i,!0)},{type:"text",value:`
`}]}}var Sn={}.hasOwnProperty,_B={};function Ql(A,e){let j=e||_B,t=new Map,r=new Map,o=new Map,n={...Kl,...j.handlers},i={all:s,applyData:SB,definitionById:t,footnoteById:r,footnoteCounts:o,footnoteOrder:[],handlers:n,one:a,options:j,patch:yB,wrap:OB};return nt(A,function(l){if(l.type==="definition"||l.type==="footnoteDefinition"){let k=l.type==="definition"?t:r,c=String(l.identifier).toUpperCase();k.has(c)||k.set(c,l)}}),i;function a(l,k){let c=l.type,d=i.handlers[c];if(Sn.call(i.handlers,c)&&d)return d(i,l,k);if(i.options.passThrough&&i.options.passThrough.includes(c)){if("children"in l){let{children:B,...u}=l,E=oe(u);return E.children=i.all(l),E}return oe(l)}return(i.options.unknownHandler||MB)(i,l,k)}function s(l){let k=[];if("children"in l){let c=l.children,d=-1;for(;++d<c.length;){let $=i.one(c[d],l);if($){if(d&&c[d-1].type==="break"&&(!Array.isArray($)&&$.type==="text"&&($.value=Hl($.value)),!Array.isArray($)&&$.type==="element")){let B=$.children[0];B&&B.type==="text"&&(B.value=Hl(B.value))}Array.isArray($)?k.push(...$):k.push($)}}}return k}}function yB(A,e){A.position&&(e.position=In(A))}function SB(A,e){let j=e;if(A&&A.data){let t=A.data.hName,r=A.data.hChildren,o=A.data.hProperties;if(typeof t=="string")if(j.type==="element")j.tagName=t;else{let n="children"in j?j.children:[j];j={type:"element",tagName:t,properties:{},children:n}}j.type==="element"&&o&&Object.assign(j.properties,oe(o)),"children"in j&&j.children&&r!==null&&r!==void 0&&(j.children=r)}return j}function MB(A,e){let j=e.data||{},t="value"in e&&!(Sn.call(j,"hProperties")||Sn.call(j,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:A.all(e)};return A.patch(e,t),A.applyData(e,t)}function OB(A,e){let j=[],t=-1;for(e&&j.push({type:"text",value:`
`});++t<A.length;)t&&j.push({type:"text",value:`
`}),j.push(A[t]);return e&&A.length>0&&j.push({type:"text",value:`
`}),j}function Hl(A){let e=0,j=A.charCodeAt(e);for(;j===9||j===32;)e++,j=A.charCodeAt(e);return A.slice(e)}function Er(A,e){let j=Ql(A,e),t=j.one(A,void 0),r=Jl(j),o=Array.isArray(t)?{type:"root",children:t}:t||{type:"root",children:[]};return r&&("children"in o,o.children.push({type:"text",value:`
`},r)),o}function Br(A,e){return A&&"run"in A?async function(j,t){let r=Er(j,{file:t,...e});await A.run(r,t)}:function(j,t){return Er(j,{file:t,...A||e})}}function ur(A){let e=this;e.compiler=j;function j(t){return M6(t,{...e.data("settings"),...A,extensions:e.data("toMarkdownExtensions")||[]})}}function Mn(A){if(A)throw A}var fr=Rr(jk(),1);function jt(A){if(typeof A!="object"||A===null)return!1;let e=Object.getPrototypeOf(A);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in A)&&!(Symbol.iterator in A)}function On(){let A=[],e={run:j,use:t};return e;function j(...r){let o=-1,n=r.pop();if(typeof n!="function")throw new TypeError("Expected function as last argument, not "+n);i(null,...r);function i(a,...s){let l=A[++o],k=-1;if(a){n(a);return}for(;++k<r.length;)(s[k]===null||s[k]===void 0)&&(s[k]=r[k]);r=s,l?ek(l,i)(...s):n(null,...s)}}function t(r){if(typeof r!="function")throw new TypeError("Expected `middelware` to be a function, not "+r);return A.push(r),e}}function ek(A,e){let j;return t;function t(...n){let i=A.length>n.length,a;i&&n.push(r);try{a=A.apply(this,n)}catch(s){let l=s;if(i&&j)throw l;return r(l)}i||(a&&a.then&&typeof a.then=="function"?a.then(o,r):a instanceof Error?r(a):o(a))}function r(n,...i){j||(j=!0,e(n,...i))}function o(n){r(null,n)}}var tk=function(A){let t=this.constructor.prototype,r=t[A],o=function(){return r.apply(o,arguments)};return Object.setPrototypeOf(o,t),o};var PB={}.hasOwnProperty,Cn=class A extends tk{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=On()}copy(){let e=new A,j=-1;for(;++j<this.attachers.length;){let t=this.attachers[j];e.use(...t)}return e.data((0,fr.default)(!0,{},this.namespace)),e}data(e,j){return typeof e=="string"?arguments.length===2?(xn("data",this.frozen),this.namespace[e]=j,this):PB.call(this.namespace,e)&&this.namespace[e]||void 0:e?(xn("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;let e=this;for(;++this.freezeIndex<this.attachers.length;){let[j,...t]=this.attachers[this.freezeIndex];if(t[0]===!1)continue;t[0]===!0&&(t[0]=void 0);let r=j.call(e,...t);typeof r=="function"&&this.transformers.use(r)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();let j=mr(e),t=this.parser||this.Parser;return Pn("parse",t),t(String(j),j)}process(e,j){let t=this;return this.freeze(),Pn("process",this.parser||this.Parser),vn("process",this.compiler||this.Compiler),j?r(void 0,j):new Promise(r);function r(o,n){let i=mr(e),a=t.parse(i);t.run(a,i,function(l,k,c){if(l||!k||!c)return s(l);let d=k,$=t.stringify(d,c);xB($)?c.value=$:c.result=$,s(l,c)});function s(l,k){l||!k?n(l):o?o(k):j(void 0,k)}}}processSync(e){let j=!1,t;return this.freeze(),Pn("processSync",this.parser||this.Parser),vn("processSync",this.compiler||this.Compiler),this.process(e,r),nk("processSync","process",j),t;function r(o,n){j=!0,Mn(o),t=n}}run(e,j,t){rk(e),this.freeze();let r=this.transformers;return!t&&typeof j=="function"&&(t=j,j=void 0),t?o(void 0,t):new Promise(o);function o(n,i){let a=mr(j);r.run(e,a,s);function s(l,k,c){let d=k||e;l?i(l):n?n(d):t(void 0,d,c)}}}runSync(e,j){let t=!1,r;return this.run(e,j,o),nk("runSync","run",t),r;function o(n,i){Mn(n),r=i,t=!0}}stringify(e,j){this.freeze();let t=mr(j),r=this.compiler||this.Compiler;return vn("stringify",r),rk(e),r(e,t)}use(e,...j){let t=this.attachers,r=this.namespace;if(xn("use",this.frozen),e!=null)if(typeof e=="function")a(e,j);else if(typeof e=="object")Array.isArray(e)?i(e):n(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function o(s){if(typeof s=="function")a(s,[]);else if(typeof s=="object")if(Array.isArray(s)){let[l,...k]=s;a(l,k)}else n(s);else throw new TypeError("Expected usable value, not `"+s+"`")}function n(s){if(!("plugins"in s)&&!("settings"in s))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");i(s.plugins),s.settings&&(r.settings=(0,fr.default)(!0,r.settings,s.settings))}function i(s){let l=-1;if(s!=null)if(Array.isArray(s))for(;++l<s.length;){let k=s[l];o(k)}else throw new TypeError("Expected a list of plugins, not `"+s+"`")}function a(s,l){let k=-1,c=-1;for(;++k<t.length;)if(t[k][0]===s){c=k;break}if(c===-1)t.push([s,...l]);else if(l.length>0){let[d,...$]=l,B=t[c][1];jt(B)&&jt(d)&&(d=(0,fr.default)(!0,B,d)),t[c]=[s,d,...$]}}}},Gr=new Cn().freeze();function Pn(A,e){if(typeof e!="function")throw new TypeError("Cannot `"+A+"` without `parser`")}function vn(A,e){if(typeof e!="function")throw new TypeError("Cannot `"+A+"` without `compiler`")}function xn(A,e){if(e)throw new Error("Cannot call `"+A+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function rk(A){if(!jt(A)||typeof A.type!="string")throw new TypeError("Expected node, got `"+A+"`")}function nk(A,e,j){if(!j)throw new Error("`"+A+"` finished async. Use `"+e+"` instead")}function mr(A){return vB(A)?A:new Pe(A)}function vB(A){return!!(A&&typeof A=="object"&&"message"in A&&"messages"in A)}function xB(A){return typeof A=="string"||CB(A)}function CB(A){return!!(A&&typeof A=="object"&&"byteLength"in A&&"byteOffset"in A)}var TB=/^(#{1,6})\s+(.+)$/m,DB=/\*\*(.*?)\*\*/,wB=/\*(.*?)\*/,qB=/^\s*[-*+]\s+(.+)$/m,NB=/^\s*(\d+)\.\s+(.+)$/m,KB=/^>\s+(.+)$/m,LB=/\[([^\]]+)\]\((https?:\/\/[^)]+)\)/,JB=/`([^`]+)`/,HB=/```[\s\S]*?```/,QB=/^\s*\|(.+\|)+\s*$/m,UB=/~~(.*?)~~/,VB=/^\s*[-*+]\s+\[[ x]\]\s+\S/m,XB=/^(-{3,}|_{3,})\s*$/m,zB=/!\[([^\]]*)\]\((https?:\/\/[^)]+)\)/,WB=/<(https?:\/\/[^>]+)>/;function lO(A){return!A||A.length===0?!1:[TB,DB,wB,qB,NB,KB,LB,JB,HB,QB,UB,VB,XB,zB,WB].some(j=>j.test(A))}function YB(A){return Gr().use(nr).use(Ht).use(ze).use(Br,{allowDangerousHtml:!0,handlers:{break:function(j,t){let r={type:"element",tagName:"br",properties:{},children:[]};return j.patch(t,r),[j.applyData(t,r)]}}}).use(Jt,{allowDangerousHtml:!0}).processSync(A).toString()}function kO(A,e){let j=YB(A),t=document.createElement("div");return t.innerHTML=j,Io.fromSchema(e).parseSlice(t,{preserveWhitespace:!0})}function cO(A,e,j){let t={},r;for(r in j.nodes){let a=j.nodes[r].spec.toMarkdown;t[r]=(...s)=>a(...s,e)}let o={},n;for(n in j.marks){let a=j.marks[n].spec.toMarkdown;o[n]=(...s)=>a(...s,e)}let i=yo(A,{schema:j,nodeHandlers:t,markHandlers:o});return Gr().use(ze).use(ur,{handlers:{text(...a){let[s]=a;return s.data?.avoidEscaping?s.value:oj.text(...a)}},bullet:"-",emphasis:"_"}).stringify(i)}function ok(A){return A.type==="existing"||A.type==="temporary"}function GO({stackElement:A,tree:e}){return A?A.type==="arrayItem"?e.getNodeWithTrait(A.collectionId,Lj):e.getNodeWithTrait(A.type==="temporary"?A.collectionId:e.getParent(A.itemId)?.id,Lj):null}function RO({treeStore:A,contentManagementStore:e,stackElement:j}){if(!j)return null;if(j.type==="existing")return A.tree.getNodeWithTrait(j.itemId,Gj);if(j.type==="temporary")return e.temporaryItemCache.get(j.itemId)??null;if(j.type==="arrayItem"){let t=A.tree.getNodeWithTrait(j.collectionItemId,Gj);return t||(e.temporaryItemCache.get(j.collectionItemId)??null)}fj(j)}function FO(A){return A.findLast(ok)??null}function IO(A){return A.reduce((e,j)=>ok(j)?e+1:e,0)}function hO(A,e=[]){let j=A.stores.selectionStore.ids.length===1?A.stores.selectionStore.ids.at(0):void 0,t=Au(A,e),r=t.at(0),o=A.tree.getNodeWithTrait(j,Gj);if(o){if(!r)return[{itemId:o.id,type:"existing"}];if(r.type==="existing")return r.itemId===o.id?t:(I(t.length===1,"Must dismiss overlay stack before changing selection"),[{itemId:o.id,type:"existing"}]);if(r.type==="temporary")throw new Error("Must save temporary item stack before selecting a collection item");if(r.type==="arrayItem")return t;fj(r)}if(!r||r.type==="temporary")return t;if(r.type==="existing")return A.stores.chromeStore.mainView!==2?t:(I(t.length===1,"Must dismiss overlay stack before de-selecting collection item"),[]);if(r.type==="arrayItem")return t;fj(r)}function Au(A,e){let j=[];for(let t=0;t<e.length;t++){let r=e[t];if(!r)continue;r.type==="temporary"&&A.tree.has(r.itemId)&&(r={type:"existing",itemId:r.itemId});let o=j.at(-1)??null;if(!ju(A,r,o))break;j.push(r),t>0&&r.type==="temporary"&&I(!!r.saveAction,"Temporary items in the stack must have saveAction, except when they are the first")}return j}function ju(A,e,j){if(e.type==="temporary")return I(!A.tree.has(e.itemId),"Temporary stack element must not exist in the tree. It should be turned existing before passing it to validateOverlayStackElement."),A.tree.has(e.collectionId)&&A.stores.contentManagementStore.temporaryItemCache.has(e.itemId);if(e.type==="existing")return A.tree.has(e.itemId);if(e.type==="arrayItem"){if(!j||j.type!=="existing"&&j.type!=="temporary"||j.itemId!==e.collectionItemId||j.type==="temporary"&&j.collectionId!==e.collectionId)return!1;let t=A.tree.getNodeWithTrait(e.collectionId,Lj);if(!t)return!1;let r=A.tree.getNodeWithTrait(e.collectionItemId,Gj)??A.stores.contentManagementStore.temporaryItemCache.get(e.collectionItemId);if(!r||r.parentid&&r.parentid!==e.collectionId)return!1;let o=t.getVariable(e.arrayFieldId);if(!o||!Go(o))return!1;let n=r.getControlProp(e.arrayFieldId);return!n||!po(n)||!eo(n.value)?!1:n.value.some(({type:i,id:a})=>i==="object"&&a===e.arrayItemId)}fj(e)}function bO(A,e){let j=e.getItemIds(A.id);if(j)return j[0]}function yO(A){return Object.entries(A)}function*SO(A){let e=Object.keys(A);for(let j of e)yield[j,A[j]]}export{ha as a,ga as b,pA as c,Pe as d,$s as e,$c as f,E6 as g,fs as h,Gs as i,bO as j,Oa as k,Wp as l,Pa as m,ru as n,sa as o,la as p,nu as q,t6 as r,Tk as s,Z0 as t,Ru as u,Fu as v,ua as w,os as x,jc as y,ec as z,ma as A,B6 as B,mc as C,Fs as D,Gc as E,Is as F,hs as G,gs as H,hc as I,p6 as J,gc as K,nR as L,oR as M,fR as N,_c as O,yc as P,Ss as Q,Oj as R,Ht as S,nr as T,Br as U,Gr as V,lO as W,YB as X,kO as Y,cO as Z,GO as _,RO as $,FO as aa,IO as ba,hO as ca,Au as da,yO as ea,SO as fa};
//# sourceMappingURL=chunk-4RGTL7HF.mjs.map
