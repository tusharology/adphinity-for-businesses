import{b as xa,c as va,d as Sa,r as no}from"chunk-IORK7F2P.mjs";import{G as ca,H as ro,I as da,J as pa,K as ua,L as ma,M as fa,O as ha,Q as et,W as ga,Y as ya,e as Zi,f as Qi,g as Ji,h as ea,i as ta,j as Be}from"chunk-ZJPKS7U6.mjs";import{Bd as ra,Be as la,Ld as rr,Md as na,O as Oi,Od as nr,P as Gi,Qd as ir,Uc as Xi,Wa as Hi,_b as ji,ed as oa,g as Wn,gc as Ui,i as jn,j as Un,k as $n,l as tr,la as eo,ra as to,v as Vi}from"chunk-TO3PG6NS.mjs";import{ca as $i,da as Yi,ea as qi,o as Wi}from"chunk-UZULDITV.mjs";import{a as _i,b as Ki,f as vt}from"chunk-PW3UNOS6.mjs";import{i as aa}from"chunk-YE4QPCYK.mjs";import{k as ar}from"chunk-EDICM4ZE.mjs";import{g as Ca,h as tt,i as Ia,k as Ra}from"chunk-4J3SNVLD.mjs";import{b as Ce,c as zi}from"chunk-YQXRHNKK.mjs";import{b as oo,f as Ta}from"chunk-ZOR27MRK.mjs";import{b as ia,d as sa}from"chunk-K2O2DWCZ.mjs";import{e as or}from"chunk-WPFEDOJI.mjs";import{Ag as Bi,Ca as ci,Eb as Ti,N as Qn,O as Yo,Ob as Ri,P as Jn,Pb as Mi,Te as Zo,U as oi,Ue as Qo,Yd as Fi,Zd as Di,_c as Pi,ci as Jo,ja as qo,je as Ai,ji as Ei,ke as Li,md as wi,oa as si,oc as ki,oi as er,wb as Ii,xb as Ni,ya as yt,za as li}from"chunk-NYFEUS7P.mjs";import{f as be}from"chunk-6Z2W7ESM.mjs";import{c as Xn}from"chunk-75ILXMIH.mjs";import{b as Na,d as sr}from"chunk-DMH54IDO.mjs";import{dh as xt}from"chunk-BMVMSSVG.mjs";import{a as ba}from"chunk-JKSD67ZU.mjs";import{Ag as ni,Cb as Vn,Cg as ii,D as wn,Dl as Ko,Ed as qt,Eg as ai,H as Eo,Hb as Wo,Lf as Uo,Md as zn,O as Vo,Rd as Hn,Rf as $o,Sd as jo,Sl as vi,Zd as _n,_j as Xo,an as Si,b as Qe,ba as Oo,ca as $t,dk as gi,fg as ei,ga as te,gg as ti,ha as An,i as gt,k as Ut,mb as zo,me as Kn,mg as ri,mj as hi,nb as Ho,ob as Bn,oh as _t,pb as En,qo as Ci,sn as Je,t as _,vd as On,vf as Xt,wh as di,wl as Zt,x as kn,xl as _o,y as Pn,zd as Gn,zl as Se}from"chunk-G5CI4O4F.mjs";import{a as Ln,b as Go}from"chunk-6C6VSETA.mjs";import{c as In,g as jt,i as Nn,r as Tn,u as Q,v as Rn,w as Ae,y as ve,z as Mn}from"chunk-KYPY4QS7.mjs";import{b as Qt,c as Jt}from"chunk-N42NUTZC.mjs";import{i as U,k as Yn,p as qn}from"chunk-26DHASNB.mjs";import{$c as $r,Ad as he,Ae as en,Ak as Bo,As as Kt,Bc as Wr,Bd as Ze,Br as Dn,Cc as jr,Cd as Kr,Dd as Gt,E as P,Gj as Ao,Gk as ye,Hj as nn,Ir as Le,J as Ro,Jj as Lo,Jk as cn,K as A,Ke as tn,L as T,Nh as ht,Od as Zr,Sm as dn,Th as L,Uh as O,Ur as Yt,Vh as De,Vm as xe,Vn as fn,Vo as xn,Wa as Dt,Wp as Cn,Xc as Ur,Xd as Qr,Xg as ft,Y as zr,Yd as zt,Ys as yi,Z as Mo,Zc as Ye,Zp as Wt,_c as qe,ak as an,cc as At,cr as Fn,dt as xi,ed as Lt,fd as wo,fs as Zn,g as Or,gd as mt,hc as Y,hd as Yr,he as Jr,id as qr,jp as vn,kd as Bt,ld as Xe,mc as $e,md as Et,nd as Vt,ne as Fo,od as X,of as Ht,oi as ge,os as pi,pi as ee,pp as Sn,qd as _e,qs as ui,rd as Ke,rn as pn,rs as mi,sn as un,td as Xr,tn as mn,tp as bn,ts as fi,uh as Do,vd as fe,wb as Hr,wk as sn,wt as bi,xd as Ot,xi as on,xj as rn,yk as ln,zc as Po,zd as _r}from"chunk-LIUGL3AW.mjs";import{V as To,ca as hn,da as gn,f as No,fa as yn,ka as kc}from"chunk-RT6MD2HE.mjs";import{a as se}from"chunk-B7SOVHNX.mjs";import{p as Z}from"chunk-OBUCKN56.mjs";import{b as ut,e as j,j as J,k as ko,m as Fe}from"chunk-CMAEAGWD.mjs";import{b as Vr}from"chunk-AUNF3KWQ.mjs";import{Ha as Ft}from"chunk-NNG7ZAML.mjs";import{a as Mc,b as Gr}from"chunk-JB2N3EQZ.mjs";import{e as Io,f as Br,j as Er}from"chunk-6E4TUQ3S.mjs";import{Ra as Lr,W as E,Z as Dr,da as pe,ha as M,ia as V,j as pt,la as je,ma as ue,na as wt,pa as bo,qa as Ar,ra as Co,ta as Ue,ua as me,w as Fr}from"chunk-EEV263O3.mjs";import{a as I,b as we}from"chunk-YOOGIIWU.mjs";import{c as ct,d as Rc,e as dt,j as N,k as ae,l as So}from"chunk-AHQIRSXG.mjs";var bt=ct(Ne=>{"use strict";Ne.removeLeadingAndTrailingHTTPWhitespace=e=>e.replace(/^[ \t\n\r]+/u,"").replace(/[ \t\n\r]+$/u,"");Ne.removeTrailingHTTPWhitespace=e=>e.replace(/[ \t\n\r]+$/u,"");Ne.isHTTPWhitespaceChar=e=>e===" "||e==="	"||e===`
`||e==="\r";Ne.solelyContainsHTTPTokenCodePoints=e=>/^[-!#$%&'*+.^_`|~A-Za-z0-9]*$/u.test(e);Ne.soleyContainsHTTPQuotedStringTokenCodePoints=e=>/^[\t\u0020-\u007E\u0080-\u00FF]*$/u.test(e);Ne.asciiLowercase=e=>e.replace(/[A-Z]/ug,t=>t.toLowerCase());Ne.collectAnHTTPQuotedString=(e,t)=>{let o="";for(t++;;){for(;t<e.length&&e[t]!=='"'&&e[t]!=="\\";)o+=e[t],++t;if(t>=e.length)break;let r=e[t];if(++t,r==="\\"){if(t>=e.length){o+="\\";break}o+=e[t],++t}else break}return[o,t]}});var Qs=ct((Cx,Zs)=>{"use strict";var{asciiLowercase:lo,solelyContainsHTTPTokenCodePoints:Vp,soleyContainsHTTPQuotedStringTokenCodePoints:Op}=bt();Zs.exports=class{constructor(t){this._map=t}get size(){return this._map.size}get(t){return t=lo(String(t)),this._map.get(t)}has(t){return t=lo(String(t)),this._map.has(t)}set(t,o){if(t=lo(String(t)),o=String(o),!Vp(t))throw new Error(`Invalid MIME type parameter name "${t}": only HTTP token code points are valid.`);if(!Op(o))throw new Error(`Invalid MIME type parameter value "${o}": only HTTP quoted-string token code points are valid.`);return this._map.set(t,o)}clear(){this._map.clear()}delete(t){return t=lo(String(t)),this._map.delete(t)}forEach(t,o){this._map.forEach(t,o)}keys(){return this._map.keys()}values(){return this._map.values()}entries(){return this._map.entries()}[Symbol.iterator](){return this._map[Symbol.iterator]()}}});var tl=ct((Ix,el)=>{"use strict";var{removeLeadingAndTrailingHTTPWhitespace:Gp,removeTrailingHTTPWhitespace:Js,isHTTPWhitespaceChar:zp,solelyContainsHTTPTokenCodePoints:Sr,soleyContainsHTTPQuotedStringTokenCodePoints:Hp,asciiLowercase:br,collectAnHTTPQuotedString:Wp}=bt();el.exports=e=>{e=Gp(e);let t=0,o="";for(;t<e.length&&e[t]!=="/";)o+=e[t],++t;if(o.length===0||!Sr(o)||t>=e.length)return null;++t;let r="";for(;t<e.length&&e[t]!==";";)r+=e[t],++t;if(r=Js(r),r.length===0||!Sr(r))return null;let n={type:br(o),subtype:br(r),parameters:new Map};for(;t<e.length;){for(++t;zp(e[t]);)++t;let i="";for(;t<e.length&&e[t]!==";"&&e[t]!=="=";)i+=e[t],++t;if(i=br(i),t<e.length){if(e[t]===";")continue;++t}let a=null;if(e[t]==='"')for([a,t]=Wp(e,t);t<e.length&&e[t]!==";";)++t;else{for(a="";t<e.length&&e[t]!==";";)a+=e[t],++t;if(a=Js(a),a==="")continue}i.length>0&&Sr(i)&&Hp(a)&&!n.parameters.has(i)&&n.parameters.set(i,a)}return n}});var rl=ct((Nx,ol)=>{"use strict";var{solelyContainsHTTPTokenCodePoints:jp}=bt();ol.exports=e=>{let t=`${e.type}/${e.subtype}`;if(e.parameters.size===0)return t;for(let[o,r]of e.parameters)t+=";",t+=o,t+="=",(!jp(r)||r.length===0)&&(r=r.replace(/(["\\])/ug,"\\$1"),r=`"${r}"`),t+=r;return t}});var sl=ct((Rx,al)=>{"use strict";var Up=Qs(),$p=tl(),Yp=rl(),{asciiLowercase:nl,solelyContainsHTTPTokenCodePoints:il}=bt();al.exports=class{constructor(t){t=String(t);let o=$p(t);if(o===null)throw new Error(`Could not parse MIME type string "${t}"`);this._type=o.type,this._subtype=o.subtype,this._parameters=new Up(o.parameters)}static parse(t){try{return new this(t)}catch{return null}}get essence(){return`${this.type}/${this.subtype}`}get type(){return this._type}set type(t){if(t=nl(String(t)),t.length===0)throw new Error("Invalid type: must be a non-empty string");if(!il(t))throw new Error(`Invalid type ${t}: must contain only HTTP token code points`);this._type=t}get subtype(){return this._subtype}set subtype(t){if(t=nl(String(t)),t.length===0)throw new Error("Invalid subtype: must be a non-empty string");if(!il(t))throw new Error(`Invalid subtype ${t}: must contain only HTTP token code points`);this._subtype=t}get parameters(){return this._parameters}toString(){return Yp(this)}isJavaScript({prohibitParameters:t=!1}={}){switch(this._type){case"text":switch(this._subtype){case"ecmascript":case"javascript":case"javascript1.0":case"javascript1.1":case"javascript1.2":case"javascript1.3":case"javascript1.4":case"javascript1.5":case"jscript":case"livescript":case"x-ecmascript":case"x-javascript":return!t||this._parameters.size===0;default:return!1}case"application":switch(this._subtype){case"ecmascript":case"javascript":case"x-ecmascript":case"x-javascript":return!t||this._parameters.size===0;default:return!1}default:return!1}}isXML(){return this._subtype==="xml"&&(this._type==="text"||this._type==="application")||this._subtype.endsWith("+xml")}isHTML(){return this._subtype==="html"&&this._type==="text"}}});function Ma(e){return e.homeNodeId}function Pc(e,t){let o=Ma(t);return o?e.getNode(o):null}function ka(e,t,o){let r=Dc(e,t);return!!r&&r.id===o.id}function St(e,t){return t?.parentid===e.id&&!Xr(t)}function Pa(e,t){let o=e.get(t.homeNodeId);return St(t,o)}function wc(e,t,o){if(o&&!St(t,o))return;let r=Ma(t);o&&o.id===r||o===r||t.set({homeNodeId:o?o.id:null})}function wa(e,t){let o=e.get(t.homeNodeId);if(o){let r=e.getGroundNodeFor(o);if(St(t,r))return r}if(!t.isLoaded())return null;for(let r=t.children.length-1;r>=0;r--){let n=t.children[r];if(n&&Fc(t,n))return n}return null}function Fc(e,t){return!(!t||!St(e,t)||Ze(t)||fe(t)&&!on(t))}function Dc(e,t){let o=Pc(e,t);return St(t,o)?o:wa(e,t)}function Fa(e,t){let o=wa(e,t);wc(e,t,o)}function Da(e,t,o){!(o&&o.enum===10)&&!Pa(e,t)&&(Fa(e,t),pe("app").debug("updated home node:",t.id,t.homeNodeId))}var{onewayMethodTemplate:Wm,voidMethodTemplate:jm,valueMethodTemplate:Ac,streamMethodTemplate:Um}=Er,cr;(t=>t.service={id:"__ColorSampler__",fingerprint:"2f07b191423077f3239a93a5dec7e417",methods:{sampleColor:{}},newOutgoingWrapper:o=>({sampleColor:Ac.bind(-1,"sampleColor",!1,o)})})(cr||={});var dr;(r=>{r.service=cr.service;function t(n){let i=Io.shared();return{expect:()=>i.expectWithoutDiscovery(r.service,n),discover:a=>i.discover(r.service,n,a),register:a=>i.register({channel:n,service:r.service,implementation:a})}}r.on=t;async function o(n){Io.shared().unregister(n)}r.unregister=o})(dr||={});var Lc={track:!0};function Aa(e){let t={...e,event:"preview_shown"};Vr(t,Lc)}var io=class extends Dt("VekterTool"){constructor(o,r){super();N(this,"enum",54);N(this,"wantsAutoscrolling",!1);N(this,"engine");N(this,"onKeyDown");N(this,"onKeyPress");N(this,"onKeyUp");N(this,"displaySelectionBox",!1);N(this,"displaySelectionHandles",!1);N(this,"displayPaddingHandles",!1);N(this,"displayGapHandles",!1);N(this,"displayViewportHandle",!1);N(this,"displayViewportLabel",!1);N(this,"cmsBadge","hidden");N(this,"fromTool");this.engine=o}start(){}stop(){}cancel(){}update(){}};function La(e,t){if(e===t)return!0;if(e.constructor!==t.constructor)return!1;let o=e.keys();for(let r of o){switch(r){case"id":case"left":case"right":case"top":case"bottom":case"widthFactor":case"heightFactor":case"centerAnchorX":case"centerAnchorY":case"children":case"parentid":case"styledText":case"cache":case"update":case"mutable":case"isMaster":case"originalid":case"replicaInfo":case"duplicatedFrom":continue}if(r.startsWith("_"))continue;let n=e[r],i=t[r];if(r==="rotation"&&(n=n??0,i=i??0),!se(n,i))return!1}return!0}var Ba="https://app.framerstatic.com/cursor-add-IHXMK5V3.png";var Ea="https://app.framerstatic.com/cursor-add@2x-WG7RHQ23.png";var Va="https://app.framerstatic.com/cursor-comment-QGQDR57U.png";var Oa="https://app.framerstatic.com/cursor-comment@2x-PP6ZCJLC.png";var Ga="https://app.framerstatic.com/cursor-disconnect-722HITSN.png";var za="https://app.framerstatic.com/cursor-disconnect@2x-M4OU4BU4.png";var Ha="https://app.framerstatic.com/cursor-feedback-BOBWQH3Z.png";var Wa="https://app.framerstatic.com/cursor-feedback@2x-6D4B4MBW.png";var ja="https://app.framerstatic.com/cursor-grab-JYEIMIFP.png";var Ua="https://app.framerstatic.com/cursor-grab@2x-4B6OJX4Y.png";var $a="https://app.framerstatic.com/cursor-grabbing-CCTK7ER7.png";var Ya="https://app.framerstatic.com/cursor-grabbing@2x-ZOANBS36.png";var qa="https://app.framerstatic.com/cursor-insert-KYQDIEGK.png";var Xa="https://app.framerstatic.com/cursor-insert@2x-PM53FSGF.png";var _a="https://app.framerstatic.com/cursor-remove-XCWM6E2X.png";var Ka="https://app.framerstatic.com/cursor-remove@2x-BFMFKNIR.png";var Za="https://app.framerstatic.com/cursor-swap-A6ZB67AX.png";var Qa="https://app.framerstatic.com/cursor-swap@2x-5RC3LPB5.png";var Ja="https://app.framerstatic.com/cursor-vector-add-L3563YFF.png";var es="https://app.framerstatic.com/cursor-vector-add@2x-24A2HJDM.png";var ts="https://app.framerstatic.com/cursor-vector-point-6OWAA3FG.png";var os="https://app.framerstatic.com/cursor-vector-point@2x-4OEKRKH6.png";var rs="https://app.framerstatic.com/cursor-vector-OLHKU4LP.png";var ns="https://app.framerstatic.com/cursor-vector@2x-YFL4EEVU.png";var is="https://app.framerstatic.com/cursor-zoom-in-OM3BVHOO.png";var as="https://app.framerstatic.com/cursor-zoom-in@2x-P6ATI4AM.png";var ss="https://app.framerstatic.com/cursor-zoom-out-GBEPMY25.png";var ls="https://app.framerstatic.com/cursor-zoom-out@2x-KTAPS6BT.png";var cs="https://app.framerstatic.com/resize-east-west-BDB3IO5W.png";var ds="https://app.framerstatic.com/resize-east-west@2x-P2ESOE6Y.png";var ps="https://app.framerstatic.com/resize-east-JAX5DWRA.png";var us="https://app.framerstatic.com/resize-east@2x-TJVB6UZL.png";var ms="https://app.framerstatic.com/resize-nesw-3PXP4DUS.png";var fs="https://app.framerstatic.com/resize-nesw@2x-YELXUNDJ.png";var hs="https://app.framerstatic.com/resize-north-east-MRZ4X3CM.png";var gs="https://app.framerstatic.com/resize-north-east@2x-X5R3JQXW.png";var ys="https://app.framerstatic.com/resize-north-south-LLKELU2V.png";var xs="https://app.framerstatic.com/resize-north-south@2x-MGGC2Q54.png";var vs="https://app.framerstatic.com/resize-north-west-AUOA2P6A.png";var Ss="https://app.framerstatic.com/resize-north-west@2x-KGEAKVUC.png";var bs="https://app.framerstatic.com/resize-north-RJIYLK2K.png";var Cs="https://app.framerstatic.com/resize-north@2x-ML7ZK43B.png";var Is="https://app.framerstatic.com/resize-nwse-UIUNGWH6.png";var Ns="https://app.framerstatic.com/resize-nwse@2x-SD7XXHBC.png";var Ts="https://app.framerstatic.com/resize-south-east-MDTJVKO2.png";var Rs="https://app.framerstatic.com/resize-south-east@2x-PUMM4W7M.png";var Ms="https://app.framerstatic.com/resize-south-west-6RR44G4U.png";var ks="https://app.framerstatic.com/resize-south-west@2x-RZWPHIGU.png";var Ps="https://app.framerstatic.com/resize-south-5AJIAZZQ.png";var ws="https://app.framerstatic.com/resize-south@2x-LMAF42C5.png";var Fs="https://app.framerstatic.com/resize-west-5JWNMNHP.png";var Ds="https://app.framerstatic.com/resize-west@2x-533X6C2X.png";var As="https://app.framerstatic.com/touch-active-CQT44XON.png";var Ls="https://app.framerstatic.com/touch-active@2x-N44WHZVB.png";var Bs="https://app.framerstatic.com/touch-K4JGV3WE.png";var Es="https://app.framerstatic.com/touch@2x-M3Y2EBTW.png";var Vs={"cursor-add":[Ba,Ea],"cursor-disconnect":[Ga,za],"cursor-comment":[Va,Oa],"cursor-feedback":[Ha,Wa],"cursor-grab":[ja,Ua],"cursor-grabbing":[$a,Ya],"cursor-insert":[qa,Xa],"cursor-remove":[_a,Ka],"cursor-swap":[Za,Qa],"cursor-vector-add":[Ja,es],"cursor-vector-point":[ts,os],"cursor-vector":[rs,ns],"cursor-zoom-in":[is,as],"cursor-zoom-out":[ss,ls],"resize-nesw":[ms,fs],"resize-nwse":[Is,Ns],"resize-north-east":[hs,gs],"resize-north-west":[vs,Ss],"resize-south-east":[Ts,Rs],"resize-south-west":[Ms,ks],"resize-east-west":[cs,ds],"resize-west":[Fs,Ds],"resize-east":[ps,us],"resize-north-south":[ys,xs],"resize-north":[bs,Cs],"resize-south":[Ps,ws],"touch-active":[As,Ls],touch:[Bs,Es]};var q=(e,t=16)=>{let o=j(t)?t:t.x,r=j(t)?t:t.y,[n,i]=Vs[e];return Fr()?`url(${n}) ${o} ${r}, auto`:`-webkit-image-set(url(${n}) 1x, url(${i}) 2x) ${o} ${r}, default`},ur={x:6,y:2},vg=q("cursor-vector",ur),Sg=q("cursor-vector-add",ur),bg=q("cursor-vector-point",ur),Cg=q("cursor-disconnect",{x:5,y:5}),Ig=q("cursor-add",{x:5,y:5}),Ng=q("cursor-remove",{x:5,y:5}),Tg=q("cursor-swap",{x:5,y:5}),Rg=q("cursor-feedback",{x:15,y:15}),Mg=q("cursor-comment",{x:15,y:15}),ao={x:16,y:16},kg=q("cursor-insert",ao),Pg=q("cursor-zoom-in",ao),wg=q("cursor-zoom-out",ao),Os=q("cursor-grabbing",ao),Vd=(e,t)=>{switch(e){case 0:{if(t.x&&t.y)return 8;if(t.x)return 6;if(t.y)return 2;break}case 1:{if(t.x)return 7;break}case 2:{if(t.x&&t.y)return 6;if(t.x)return 8;if(t.y)return 0;break}case 3:{if(t.y)return 5;break}case 5:{if(t.y)return 3;break}case 6:{if(t.x&&t.y)return 2;if(t.x)return 0;if(t.y)return 8;break}case 7:{if(t.x)return 1;break}case 8:{if(t.x&&t.y)return 0;if(t.x)return 2;if(t.y)return 6;break}default:break}return e},Od=e=>8-e,Gd=(e,t,o)=>{let{fx:r,fy:n}=e,i=t.findIndex(d=>d.fx===r&&d.fy===n),a=Vd(i,o),s=t[a];I(s,"handle must be defined",s,t);let l=Od(a),c=t[l];return I(c,"handle must be defined",c,t),P.angleFromX(c,s)},zd=e=>{switch(e){case 0:return 15;case 1:return 8;case 2:return 9;case 3:return 14;case 5:return 10;case 6:return 13;case 7:return 12;case 8:return 11}},ot=e=>`url("data:image/svg+xml,<svg width='32' height='32' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><defs><path fill-rule='evenodd' clip-rule='evenodd' d='M16 9C17.103 9 18 9.897 18 11V21C18 22.103 17.103 23 16 23C14.897 23 14 22.103 14 21V11C14 9.897 14.897 9 16 9ZM21.3564 12.2148C21.5684 12.2148 21.7824 12.2658 21.9734 12.3608L26.7354 14.7438C27.2064 14.9788 27.4994 15.4518 27.5004 15.9788C27.5004 16.5068 27.2074 16.9808 26.7364 17.2158L21.9744 19.5988C21.7834 19.6948 21.5694 19.7458 21.3564 19.7458C20.5934 19.7458 19.9734 19.1248 19.9734 18.3618V13.5978C19.9734 13.2188 20.1234 12.8648 20.3964 12.6028C20.6554 12.3528 20.9974 12.2148 21.3564 12.2148Z' id='b'/><filter x='-50%25' y='-50%25' width='200%25' height='200%25' filterUnits='objectBoundingBox' id='a'><feGaussianBlur stdDeviation='1' in='SourceAlpha' result='shadowBlurOuter1'/><feColorMatrix values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0' in='shadowBlurOuter1'/></filter></defs><g fill='none' fill-rule='evenodd'><g transform='translate(0, 1)'><use fill='%23000' filter='url(%23a)' xlink:href='%23b' transform='rotate(${e} 0 0)' transform-origin='center center'/></g><g transform='rotate(${e} 0 0)' transform-origin='center center'><use fill='%23FFF' xlink:href='%23b'/><path fill-rule='evenodd' clip-rule='evenodd' d='M16 10C16.552 10 17 10.448 17 11V21C17 21.552 16.552 22 16 22C15.448 22 15 21.552 15 21V11C15 10.448 15.448 10 16 10ZM26.2884 15.638L21.5274 13.256C21.2734 13.129 20.9734 13.314 20.9734 13.598V18.362C20.9734 18.647 21.2734 18.832 21.5274 18.705L26.2884 16.322C26.5704 16.181 26.5704 15.779 26.2884 15.638Z' fill='%23000'/></g></g></svg>") 16 16, pointer`,Hd=e=>`url("data:image/svg+xml,<svg width='32' height='32' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><defs><path d='m20.252 20.196 5.006-2.898a1.5 1.5 0 0 0 0-2.596l-5.006-2.898A1.5 1.5 0 0 0 18 13.102v5.796a1.5 1.5 0 0 0 2.252 1.298Zm-8.504 0-5.006-2.898a1.5 1.5 0 0 1 0-2.596l5.006-2.898A1.5 1.5 0 0 1 14 13.102v5.796a1.5 1.5 0 0 1-2.111 1.37l-.14-.072Z' id='b'/><filter x='-50%25' y='-50%25' width='200%25' height='200%25' filterUnits='objectBoundingBox' id='a'><feGaussianBlur stdDeviation='1' in='SourceAlpha' result='shadowBlurOuter1'/><feColorMatrix values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0' in='shadowBlurOuter1'/></filter></defs><g fill='none' fill-rule='evenodd'><g transform='translate(0, 1)'><use fill='%23000' filter='url(%23a)' xlink:href='%23b' transform='rotate(${e} 0 0)' transform-origin='center center'/></g><g transform='rotate(${e} 0 0)' transform-origin='center center'><use fill='%23FFF' xlink:href='%23b'/><path d='m19.75 19.317 5-2.884a.5.5 0 0 0 0-.866l-5-2.884a.5.5 0 0 0-.75.433v5.768a.5.5 0 0 0 .67.47l.08-.037Zm-7.5 0-5-2.884a.5.5 0 0 1 0-.866l5-2.884a.5.5 0 0 1 .75.433v5.768a.5.5 0 0 1-.75.433Z' fill='%23000'/></g></g></svg>") 16 16, pointer`,pr=e=>e+180,Wd=(e,t,o)=>{if(t){let r=t.x.max&&t.x.min,n=t.y.max&&t.y.min,i=zd(e),a=i===8||i===12,s=i===14||i===10;if(a&&n||s&&r)return;if(s&&t.x.max)return ot(pr(o));if(s&&t.x.min)return ot(o);if(a&&t.y.max)return ot(pr(o));if(a&&t.y.min)return ot(o);let l=i===15||i===13||i===9||i===11;if(l&&t.x.max&&t.y.max)return ot(pr(o));if(l&&t.x.min&&t.y.min)return ot(o)}return Hd(o)},Fg=(e,t,o,r={})=>{let n=t.findIndex(i=>i.fx===e.fx&&i.fy===e.fy);if(!(n<-1))return Wd(n,o,Gd(e,t,r))},jd=e=>{switch(e){case 0:return[6,2];case 2:return[0,8];case 8:return[2,6];case 6:return[8,0];default:return[8,0]}},Ud=(e,t)=>{let{fx:o,fy:r}=e,n=t.findIndex(f=>f.fx===o&&f.fy===r),i=t[n];I(i,"handle must be defined",i,t);let[a,s]=jd(n),l=t[a],c=t[s];I(l&&c,"handle must be defined",a,s,t);let d=P.angleFromX(i,l),u=P.angleFromX(i,c),p=Math.abs(d-u),m=(p>180?360-p:p)/2,g=[t[0],t[4],t[2]];return(Ht.isClockwise(g)?d:u)+m-180},$d=e=>`url("data:image/svg+xml,<svg width='32' height='32' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'><defs><path d='M13.6614 7.0093L13.8655 7.04543L18.2004 8.12942C19.3315 8.41227 19.7211 9.82063 18.8967 10.645L18.2864 11.2544C20.3261 13.9396 20.3266 17.6871 18.2873 20.3726L18.8967 20.982C19.7212 21.8064 19.3315 23.2158 18.2004 23.4986L13.8655 24.5816C12.767 24.8562 11.7719 23.8616 12.0461 22.7632L13.1301 18.4282L13.1955 18.2251C13.586 17.2529 14.8727 16.9582 15.6457 17.731L16.1321 18.2173C17.0452 16.7509 17.0457 14.8749 16.1321 13.4087L15.6457 13.896C14.8213 14.7204 13.413 14.3308 13.1301 13.1997L12.0461 8.86477C11.7887 7.83475 12.6477 6.89604 13.6614 7.0093Z' id='b'/><filter x='-50%25' y='-50%25' width='200%25' height='200%25' filterUnits='objectBoundingBox' id='a'><feGaussianBlur stdDeviation='1' in='SourceAlpha' result='shadowBlurOuter1'/><feColorMatrix values='0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.4 0' in='shadowBlurOuter1'/></filter></defs><g fill='none' fill-rule='evenodd'><g transform='translate(0, 1)'><use fill='%23000' filter='url(%23a)' xlink:href='%23b' transform='rotate(${e} 0 0)' transform-origin='center center'/></g><g transform='rotate(${e} 0 0)' transform-origin='center center'><use fill='%23FFF' xlink:href='%23b'/><path d='M14.1003 12.957L13.0166 8.62221C12.9251 8.25602 13.2568 7.92432 13.6229 8.01587L17.9578 9.09958C18.3348 9.19384 18.4649 9.66339 18.19 9.9382L14.9389 13.1893C14.6641 13.4641 14.1946 13.3341 14.1003 12.957Z' fill='%23000'/><path d='M16.6495 10.9417C19.5422 13.5453 19.5422 18.0823 16.6495 20.6858L15.9795 19.9417C18.431 17.7354 18.431 13.8922 15.9795 11.6858L16.6495 10.9417Z' fill='%23000'/><path d='M14.1003 18.6705L13.0166 23.0053C12.9251 23.3715 13.2568 23.7032 13.6229 23.6116L17.9578 22.5279C18.3348 22.4337 18.4649 21.9641 18.19 21.6893L14.9389 18.4382C14.6641 18.1634 14.1946 18.2934 14.1003 18.6705Z' fill='%23000'/></g></g></svg>") 16 16, pointer`,Dg=(e,t)=>$d(Ud(e,t));var mr=e=>Math.max(.5,4/e),qd=e=>Math.max(.5,16/e),fr=(e,t,o)=>{let r=new Set,n=new Set;return e.forEach(i=>{if(t!==void 0){let m=i.width*t,g=i.height*t;if(m<12&&g<12)return}let a=o?.5:1,{x:s,y:l}=to({x:i.x,y:i.y},a),{x:c,y:d}=to({x:i.x+i.width/2,y:i.y+i.height/2},a),{x:u,y:p}=to({x:i.x+i.width,y:i.y+i.height},a);r.add(s).add(c).add(u),n.add(l).add(d).add(p)}),{x:r,y:n}},Gs=(e,t,o,r)=>{let n=new Map,i=t?o.x:o.y,a=null,s=null;if(typeof o.width=="number"&&typeof o.height=="number"){let{width:l,height:c}=o;a=t?o.x+l/2:o.y+c/2,s=t?o.x+l:o.y+c}return e.forEach(l=>{let c=Math.abs(i-l),d=Math.abs((a||0)-l),u=Math.abs((s||0)-l),p=null;if(c<r?p=l:a!==null&&d<r?p=l-Math.abs(a-i):s!==null&&u<r&&(p=l-Math.abs(s-i)),p!==null){let m=new Set,g=n.get(p)??m;n=n.set(p,g.add(l))}}),n},Ws=(e,t,o)=>{let r=Gs(e.x,!0,t,o),n=Gs(e.y,!1,t,o);return{x:r,y:n}},zs=(e,t)=>{let o=0,r;return e.forEach((n,i)=>{t!==void 0&&i===t||n.size>o&&(o=n.size,r=[i,n])}),r},Xd=(e,t)=>{let o=zs(e.x,t?t.x:void 0),r=zs(e.y,t?t.y:void 0);return{x:o,y:r}},js=(e,t)=>{if(!t)return e;let o=fr(t);return{x:new Set([...e.x,...o.x]),y:new Set([...e.y,...o.y])}},Us=(e,t,o,r,n)=>{e=js(e,n);let i=mr(t),a=Ws(e,o,i),s=Xd(a,r),[l,c]=s.x?s.x:[void 0,new Set],[d,u]=s.y?s.y:[void 0,new Set];return{point:{x:l,y:d},snapLines:{x:c,y:u}}},Hs=(e,t,o,r,n,i)=>{let a=null;return e.forEach(s=>{let l=i(s);if(a=A.intersection(l,r),a===null)return;if(n||P.distance(a,o)<=t)return!1;a=null}),a},$s=(e,t,o,r,n,i=!1)=>{e=js(e,n);let a=mr(t),s=Ws(e,o,a),l=A.isOrthogonal(r)||i,c=qd(t),d=null,u=new Set,p=new Set;if(d=Hs(Array.from(s.x.keys()),c,o,r,l,g=>A({x:g,y:0},{x:g,y:100})),d!==null)return{point:d,snapLines:{x:u.add(d.x),y:p}};if(d=Hs(Array.from(s.y.keys()),c,o,r,l,g=>A({x:0,y:g},{x:100,y:g})),d!==null)return{point:d,snapLines:{x:u,y:p.add(d.y)}};let m=A.perpendicular(r,o);return d=A.intersection(r,m),d===null&&(d=o),{point:d,snapLines:{x:u,y:p}}},Ys=(e,t,o,r)=>{let n={...t},i=[],a=[],s=[],l=[],c=mr(r),{x:d,y:u}=o,p="height"in o?o.height:0,m="width"in o?o.width:0,g=d+m,v=u+p,S={x:d,y:u,width:m,height:p};return e.siblingFrames.forEach(h=>{e.horizontalDistances.forEach((f,y)=>{let x=f.filter(b=>T.overlapVertically(S,b));if(x.length!==0&&T.overlapVertically(S,h)){if(Math.abs(h.x-y-g)<c){let b={x:h.x-y,y:h.y,width:y,height:h.height};if(x=x.filter(C=>!T.overlapHorizontally(C,b)),x.length===0)return;if(T.doesNotIntersect(b,e.siblingFrames)){let C=h.x-y-m;(n.x===void 0||n.x===C)&&(i.push(...x),s.push(b),n.x=C)}}else if(Math.abs(T.maxX(h)+y-d)<c){let b={x:T.maxX(h),y:h.y,width:y,height:h.height};if(x=x.filter(C=>!T.overlapHorizontally(C,b)),x.length===0)return;if(T.doesNotIntersect(b,e.siblingFrames)){let C=T.maxX(h)+y;(n.x===void 0||n.x===C)&&(i.push(...x),s.push(b),n.x=C)}}}}),e.verticalDistances.forEach((f,y)=>{let x=f.filter(b=>T.overlapHorizontally(S,b));if(x.length!==0&&T.overlapHorizontally(S,h)){if(Math.abs(h.y-y-v)<c){let b={y:h.y-y,x:h.x,height:y,width:h.width};if(x=x.filter(C=>!T.overlapVertically(C,b)),x.length===0)return;if(T.doesNotIntersect(b,e.siblingFrames)){let C=h.y-y-p;(n.y===void 0||n.y===C)&&(a.push(...x),l.push(b),n.y=C)}}else if(Math.abs(T.maxY(h)+y-u)<c){let b={y:T.maxY(h),x:h.x,height:y,width:h.width};if(x=x.filter(C=>!T.overlapVertically(C,b)),x.length===0)return;if(T.doesNotIntersect(b,e.siblingFrames)){let C=T.maxY(h)+y;(n.y===void 0||n.y===C)&&(a.push(...x),l.push(b),n.y=C)}}}})}),{distanceSnap:n,distanceFramesX:i,distanceFramesY:a,horizontalDistanceFrames:s,verticalDistanceFrames:l}};var so=class{constructor(t,o){this.engine=t;this.excludedNodes=o;N(this,"snapX",null);N(this,"snapY",null);N(this,"snapConstraint",null);N(this,"distanceFramesX",[]);N(this,"distanceFramesY",[]);N(this,"snappingZoom",-1);N(this,"snappingFrame",{x:0,y:0,width:0,height:0});N(this,"linesCache",new Map);N(this,"distanceCache",new Map);N(this,"snapForShapes",!1)}start(){this.snapForShapes=this.engine.stores.toolStore.shapeToolActive||this.engine.stores.selectionStore.nodes.every(t=>xe(t))}stop(){this.engine.stores.snapLinesStore.clear()}validateCaches(){let{canvasStore:t}=this.engine.stores,o=t.getCanvasVisibleRect();(this.snappingZoom!==t.zoom||!T.equals(this.snappingFrame,o))&&(this.snappingZoom=t.zoom,this.snappingFrame=o,this.linesCache=new Map,this.distanceCache=new Map)}snap(t,o,r,n,i,a,s,l=!1){let{snapLinesStore:c,canvasStore:d}=this.engine.stores;if(o===!1)return this.snapX=null,this.snapY=null,this.snapConstraint=null,this.distanceFramesX=[],this.distanceFramesY=[],c.clear(),t;this.validateCaches();let u=this.getOrthogonalLines(r,l),p;i?p=$s(u,d.zoom,t,i,s,this.snapForShapes):p=Us(u,d.zoom,t,a,s);let m=Array.from(p.snapLines.y),g=Array.from(p.snapLines.x),v=i!==void 0?i:null,S=null;if(n!==void 0&&i===void 0){let x=this.getSiblingDistances(n);S=Ys(x,p.point,t,d.zoom)}S&&S.distanceSnap.x!==void 0&&(p.point.x=S.distanceSnap.x),S&&S.distanceSnap.y!==void 0&&(p.point.y=S.distanceSnap.y);let h={x:j(p.point.x)?p.point.x:t.x,y:j(p.point.y)?p.point.y:t.y};S!==null&&(S.horizontalDistanceFrames.forEach(x=>{let b="height"in t?t.height:0,C=Math.min(x.y,h.y),w=Math.max(T.maxY(x),h.y+b);S.distanceFramesX.push({...x,y:C,height:w-C})}),S.verticalDistanceFrames.forEach(x=>{let b="width"in t?t.width:0,C=Math.min(x.x,h.x),w=Math.max(T.maxX(x),h.x+b);S.distanceFramesY.push({...x,x:C,width:w-C})}));let f=S?S.distanceFramesX:[],y=S?S.distanceFramesY:[];return this.snapX=g,this.snapY=m,c.x=new Set(g),c.y=new Set(m),this.snapConstraint=v,this.distanceFramesX=f,this.distanceFramesY=y,h}getOrthogonalLines(t,o=!1){let{tree:r}=this.engine,{canvasStore:n,scopeStore:i,persistedUserDefaults:a,overlayStore:s}=this.engine.stores,{active:l}=i,c=n.getCanvasVisibleRect(),d=this.engine.tool.enum===40,u=this.snapForShapes||d,{displayRulers:p}=a,m=p&&li(l)?{x:new Set(l.guidesX),y:new Set(l.guidesY)}:{x:new Set,y:new Set};return t.forEach(g=>{let v={x:new Set,y:new Set},S={x:new Set,y:new Set};if(!this.linesCache.has(g)){let f=[],y=[...this.excludedNodes],x=l.getGroundNodesOfType(ki,R=>!y.includes(R.id));if(!g)y.push(...x.map(R=>R.id)),f.push(...r.getSubtreeNodes(l.id,y)),f.push(...x);else{f.push(...r.getSubtreeNodes(g,y));let R=r.getNode(g);if(p&&R&&ci(R)){let k=R.guidesX.map(z=>yt(r,R,"x",z));v.x=new Set(k);let F=R.guidesY.map(z=>yt(r,R,"y",z));v.y=new Set(F)}if(a.displayGrids&&R&&(!_t(R)||R.resolveValue("rotation")===0)&&Ii(R)&&R.overlayGrid){let k=[],F=[],z=r.convertFrameToCanvas(R);if(!R.overlayGrid)return;let B=Ni(R.overlayGrid,z);R.overlayGrid?.type==="column"&&B.forEach(K=>k.push(yt(r,R,"x",K))),R.overlayGrid?.type==="row"&&B.forEach(K=>F.push(yt(r,R,"y",K))),S.x=new Set(k),S.y=new Set(F)}if(o&&R&&On(R)){let k=T.atOrigin(r.getRect(R));k.height=Gn(R,k);let z=T.cornerPoints(k).map(K=>r.convertPointToCanvas(R,K,!0)),B=T.boundingRectFromPoints(z);v.y.add(B.y+B.height)}}f=f.filter(R=>{if(s.editModeActive){if(s.activeRelativeOverlayTriggers.has(R.id))return!0;if(!zn(R,s.activeOverlays))return!1}return!R.isVisible()||Gt(R)?!1:Ze(R)?!R.sizeToFit:!0});let b=f.map(R=>r.convertFrameToCanvas(R)).filter(R=>T.intersects(R,c)),C=fr(b,n.zoom,u),w={x:new Set([...C.x,...v.x,...S.x]),y:new Set([...C.y,...v.y,...S.y])};this.linesCache=this.linesCache.set(g,w)}let h=this.linesCache.get(g);h&&(m.x=new Set([...m.x,...h.x]),m.y=new Set([...m.y,...h.y]))}),m}getSiblingDistances(t){let{tree:o}=this.engine,r=this.engine.stores.canvasStore.getCanvasVisibleRect();if(!this.distanceCache.has(t)){let i=[];if(t)i=o.getNode(t).children;else{let p=this.engine.stores.scopeStore.active.getGroundNodes();p&&(i=p)}let a=[...this.excludedNodes],s=i.filter(p=>!a.includes(p.id)).map(p=>T.pixelAligned(o.convertFrameToCanvas(p))).filter(p=>T.intersects(r,p)),l=Hi(s),c=new Map,d=new Map,u=(p,m,g)=>{let v=p.get(m)??[];return p.set(m,[...v,g])};l.forEach(([p,m])=>{let g=T.maxY(p),v=T.maxY(m),S=T.maxX(p),h=T.maxX(m);if(T.overlapHorizontally(p,m)){let f=Math.min(p.x,m.x),x=Math.max(S,h)-f;if(g<m.y){let b=m.y-g,C={y:g,x:f,width:x,height:b};T.doesNotIntersect(C,s)&&(c=u(c,b,C))}else if(v<p.y){let b=p.y-v,C={y:v,x:f,width:x,height:b};T.doesNotIntersect(C,s)&&(c=u(c,b,C))}}if(T.overlapVertically(p,m)){let f=Math.min(p.y,m.y),x=Math.max(g,v)-f;if(S<m.x){let b=m.x-S,C={x:S,y:f,width:b,height:x};T.doesNotIntersect(C,s)&&(d=u(d,b,C))}else if(h<p.x){let b=p.x-h,C={x:h,y:f,width:b,height:x};T.doesNotIntersect(C,s)&&(d=u(d,b,C))}}}),this.distanceCache=this.distanceCache.set(t,{verticalDistances:c,horizontalDistances:d,siblingFrames:s})}let n=this.distanceCache.get(t);return Xn(n,"cant read distances"),n}};function qs(e,t){if(t.length!==1)return!1;let o=e.get(t[0]);return!!(o&&Zt(o))}function Jy(e){return e instanceof hr}var hr=class extends Dt("MoveTool",io){constructor(o,r){super(o);this.options=r;N(this,"enum",10);N(this,"wantsAutoscrolling",!0);N(this,"isCancelled",!1);N(this,"nodesBeginState");N(this,"parentsWithPlaceholders");N(this,"startVisualIndexIfSequentialSiblings");N(this,"startVisibleRelativeNodeCount",0);N(this,"startCanvasRect");N(this,"hasMoved",!1);N(this,"maxSize");N(this,"nodesInMoveToolBaseFontSize",{});N(this,"highlightedParents",new Set);N(this,"shouldHighLightParents",!0);N(this,"commonParentAfterLastUpdate");N(this,"topLevelFrameNodesAfterLastUpdate",[]);N(this,"snapper");N(this,"isSkewed");N(this,"cloneCache",new Map);N(this,"renamedIds",new Map);N(this,"canMoveToStackOrGrid",!1);N(this,"activeStackOrGrid",null);N(this,"commonStackOrGridParentAtStart",null);N(this,"activeStackOrGridInsertion");N(this,"stackOrGridInsertionLine",null);N(this,"displaySelectionBox",!0);N(this,"cmsBadge","visible");N(this,"displaySelectionHandles",!0);N(this,"stateToken");N(this,"scopeIdAtStart");N(this,"lastAltKeyDownTime",0);N(this,"updateNodesInMoveToolBaseFontSize",(o,r)=>{if(o===r)return;let n=this.nodesInMoveToolBaseFontSize[o];j(n)&&(this.nodesInMoveToolBaseFontSize={...this.nodesInMoveToolBaseFontSize,[r]:n})});this.displaySelectionHandles=!r?.reorderNode}selectionIds(){return this.options?.reorderNode?[this.options.reorderNode.id]:this.engine.stores.selectionStore.ids}start(){let{engine:o}=this,{tree:r,componentLoader:n}=o,{scopeStore:i,mouseStore:a,modulesStore:s}=o.stores,l=this.selectionIds();this.snapper=new so(o,l);let c=r.withoutDescendants(r.getNodes(l));this.nodesBeginState=Rp(r,n,c,a.latest.canvasMousePosition),this.parentsWithPlaceholders=pp(this.nodesBeginState),this.commonStackOrGridParentAtStart=cp(r,c),this.startVisualIndexIfSequentialSiblings=up(this.nodesBeginState,this.commonStackOrGridParentAtStart),this.startVisibleRelativeNodeCount=mp(this.nodesBeginState),this.maxSize=fp(this.nodesBeginState),this.startCanvasRect=T.merge(...c.map(u=>r.convertFrameToCanvas(u))),this.canMoveToStackOrGrid=lp(c,r),this.nodesInMoveToolBaseFontSize=c.reduce((u,p)=>{let m=bn(i.active,r,s,p.id);return j(m)&&(u[p.id]=m),u},{});let d=c[0];this.isSkewed=c.length===1&&!!d&&Ei(Jo(r,d)),o.beginUndoGroup(),o.stores.treeStore.setHighlight(null),this.scopeIdAtStart=o.stores.scopeStore.activeId,this.stateToken=o.getStateToken(),this.shouldHighLightParents=!c.every(Yt)}cancel(){let{engine:o}=this;this.removePlaceholders(),this.activeStackOrGrid=null,o.discardUndoGroup(),this.isCancelled=!0}stop(){let{engine:o}=this;this.isCancelled||(this.toolUpdate(!0),o.endUndoGroup()),this.hasMoved||this.options?.moveToolDidExitWithoutMoving?.(),this.snapper.stop()}resetToBeginState(){this.engine.resetTreeAndSelectionWithToken(this.stateToken)}update(){let{engine:o}=this,{mouseStore:r,mouseCursorStore:n,scopeStore:i}=o.stores,{canvasMouseDownPosition:a,canvasMiddleMouseButtonDownPosition:s}=r;if(!a||s){o.exitTool();return}if(this.scopeIdAtStart!==i.activeId){this.removePlaceholders(),r.setMouseDown(!1),o.exitTool();return}if(this.toolUpdate(),this.options?.reorderNode&&(n.current=Os),this.nodesBeginState.size===0){o.exitTool();return}}validateNodesBeginState(){let{engine:o}=this;this.nodesBeginState.forEach((r,n)=>{o.tree.has(n.id)||this.nodesBeginState.delete(n)})}validateNodesInMoveToolBaseFontSize(){let{engine:o}=this,r=Object.keys(this.nodesInMoveToolBaseFontSize);r.every(i=>{let a=this.nodesInMoveToolBaseFontSize[i];return o.tree.has(i)&&j(a)})||(this.nodesInMoveToolBaseFontSize=r.reduce((i,a)=>{let s=this.nodesInMoveToolBaseFontSize[a];return!o.tree.has(a)||!j(s)||(i[a]=s),i},{}))}noInputChange(){let{previous:o,latest:r}=this.engine.stores.mouseStore,{altKey:n,cmdKey:i,ctrlKey:a,spacebar:s,canvasMousePosition:l}=r;return l.x===o.canvasMousePosition.x&&l.y===o.canvasMousePosition.y&&n===o.altKey&&i===o.cmdKey&&a===o.ctrlKey&&s===o.spacebar}shouldCopy(o){return this.engine.stores.mouseStore.latest.altKey?(this.lastAltKeyDownTime=performance.now(),!0):o?performance.now()-this.lastAltKeyDownTime<200:!1}addReorderOffsetIfNeeded(o){return this.options?.reorderOffset?P.add(o,this.options.reorderOffset):o}getMouseWithReorderOffset(){return this.addReorderOffsetIfNeeded(this.engine.stores.mouseStore.latest.canvasMousePosition)}getPreviousMouseWithReorderOffset(){return this.addReorderOffsetIfNeeded(this.engine.stores.mouseStore.previous.canvasMousePosition)}toolUpdate(o=!1){let{engine:r}=this,n=!!this.options?.reorderNode;if(o&&!this.hasMoved){this.options?.reorderNode&&r.stores.selectionStore.set(this.options.reorderNode);return}let{tree:i}=r,{scopeStore:a,effectStore:s,mouseStore:l,documentSettingsStore:c,toolStore:d,chromeStore:u,selectionStore:p,canvasStore:m}=r.stores,{previous:g,latest:v}=l,{altKey:S,cmdKey:h,ctrlKey:f,spacebar:y,canvasMousePosition:x}=v;if(this.scopeIdAtStart!==a.activeId||dp(this.nodesBeginState)||eo(r,"canDesign")||u.isPreviewingLocaleOnCanvas)return;let b=Kd(l,this.options?.directionLock);if(!b||!this.hasMoved&&b.x===0&&b.y===0||(this.hasMoved=!0,s.exitPreview(),!o&&this.noInputChange()))return;this.resetToBeginState(),this.validateNodesBeginState(),this.validateNodesInMoveToolBaseFontSize();let C=new Map,w=S&&h;this.displaySelectionHandles=!1,this.highlightedParents.clear(),this.removePlaceholders(!0);let R=this.shouldCopy(o)&&!w,k=Z.isOn("betterStackGridItemMoving");R&&sp(r,this.nodesBeginState,C,this.cloneCache,this.renamedIds);let F=i.getNodes(this.selectionIds()),z=F.every($=>_o($)),B=z||f&&F.every(Xo);k&&(R||B)&&(d.nodesWithPlaceholders=null);let K=T.offset(this.startCanvasRect,b),ne=!!this.commonStackOrGridParentAtStart&&(z||F.every($=>Zt($)||_o($))),{visualInsertionIndex:ie,insertionLine:Ve,activeStackOrGrid:Oe,isLiveSorting:ce,wrap:Ge}=gp(r,this.getMouseWithReorderOffset(),this.getPreviousMouseWithReorderOffset(),F,this.nodesBeginState,this.canMoveToStackOrGrid,n,this.commonStackOrGridParentAtStart,this.maxSize,this.activeStackOrGridInsertion,B,ne,y,h,w);if(this.activeStackOrGridInsertion=ie,this.stackOrGridInsertionLine=Ve,this.activeStackOrGrid=Oe,k){if(R||!this.activeStackOrGrid||!this.commonStackOrGridParentAtStart||this.activeStackOrGrid.id!==this.commonStackOrGridParentAtStart.id||ie===null||this.startVisualIndexIfSequentialSiblings===void 0||ie<this.startVisualIndexIfSequentialSiblings||ie>this.startVisualIndexIfSequentialSiblings+this.startVisibleRelativeNodeCount||(this.activeStackOrGridInsertion=null,this.stackOrGridInsertionLine=null),this.activeStackOrGrid&&this.activeStackOrGridInsertion!==null){let G=new Set(this.selectionIds()),de=0,ke=0,at=0;for(let Pe of this.activeStackOrGrid.getChildrenInVisualOrder()){if(this.activeStackOrGridInsertion===de)break;!Pe.isVisible()||!Se(Pe,this.activeStackOrGrid)?(at+=1,this.activeStackOrGridInsertion+=1):G.has(Pe.id)?ke+=1:at=0,de+=1}!R&&!o&&(this.activeStackOrGridInsertion-=ke),this.activeStackOrGridInsertion-=at}if(!R&&!B&&(d.nodesWithPlaceholders=this.parentsWithPlaceholders),this.parentsWithPlaceholders.length>0&&!o){if(!R&&!B)for(let{id:G,placeholders:de}of this.parentsWithPlaceholders){let ke=i.getNode(G);ke&&(ke.cache.placeholders=de)}this.makeGroundNodes(C)}}else ce&&!o&&this.makeGroundNodes(C),d.updateDragAndDropPlaceholder(this.activeStackOrGrid);let{activeNodes:Re,extraSnapRects:H}=Cp(i,this.nodesBeginState,C,h),W=P.distance(g.canvasMousePosition,x)*m.zoom,ze=!this.isSkewed&&(W<10&&ne?!0:!this.activeStackOrGrid);this.snapper.excludedNodes=this.selectionIds();let He=this.snapper.snap(K,ze,this.topLevelFrameNodesAfterLastUpdate,this.commonParentAfterLastUpdate,void 0,void 0,H,qs(i,this.selectionIds())),it=P.pixelAligned(P.subtract(this.startCanvasRect,He)),Me=new Set(this.selectionIds());if(!o||!this.activeStackOrGrid||ne||B)for(let[$,G]of this.nodesBeginState){let{unableToMove:de,startFromStackOrGrid:ke,disableReparenting:at}=G;if(de)continue;let Pe=C.get($)??$.id,ho=i.get(Pe);if(!ho)continue;let Cc=Pe!==$.id&&Ye($),go=i.current(G.parent),We=G.rect,yo=oo(gr(r.tree,go),G.untransformedPointUnderMouse,P.subtract(G.canvasPointUnderMouse,it)),st={...We,...P.pixelAligned(P.add(We,yo),We)},Ic=Mp(r.tree,go).translate(yo.x,yo.y).multiply(G.matrix),lt=this.getNewParent(ho,go,T.pointsAtOrigin(st).map(vo=>Je.convertPoint(Ic,vo)),st,Cc,ke,at||ne,o),Nc=$.id!==Pe,xo=this.reparentNode(ho,lt,Me,Nc,ce,-1,!0);if(this.shouldHighLightParents&&(this.highlightedParents=op(this.highlightedParents,lt,this.activeStackOrGrid)),lt?.id!==G.parent?.id){let vo=oo(gr(r.tree,lt),G.untransformedPointUnderMouse,P.subtract(G.canvasPointUnderMouse,it));st={...We,...P.pixelAligned(P.add(We,vo),We)}}let Tc=this.getUpdatedNodeConstraints(i,xo,st,G,lt,B);xo.set(Tc),np(r,xo,G,st)}if(o){if(r.tree.beginAllowPartialScopeAccess(),Fp(r,this.nodesBeginState,C),Ap(r,this.nodesBeginState,C),Lp(r,this.nodesBeginState,C),r.tree.endAllowPartialScopeAccess(),this.removePlaceholders(),this.activeStackOrGrid&&!ne&&!B&&this.insertSelectionIntoStackOrGrid(C,Me,ce,Ge),Dp(C,r.tree),n||p.set(Me),C.size>0){let $=new Map;for(let[G,de]of C.entries())$.set(G.id,de);c.lastDuplicationMap=$}this.renamedIds.clear();return}n||p.set(Me),this.commonParentAfterLastUpdate=Qd(i,Re),this.topLevelFrameNodesAfterLastUpdate=i.getTopLevelFrameNodes(Re)}getUpdatedNodeConstraints(o,r,n,i,a,s){let l=i.parent?i.parent.id===a?.id:a===null,c=wp(i,l),u=o.getParentSizeInfo(r,a,!0,!1),p=r.updateForRect({rect:n,parentSizeInfo:u,updateSize:!1,constraintsLocked:tr(r,c),shouldGuessPinToBottom:Zo(o,r),shouldGuessPinToRight:Qo(o,r,a)});return!c&&Qe(r)&&(p.constraintsLocked=!1),s?p.position="absolute":Object.assign(p,Ko(r,a)),p}getNewParent(o,r,n,i,a,s,l,c){let{engine:d}=this;if(l)return r;if(this.activeStackOrGrid)return c?this.activeStackOrGrid:ye;let{tree:u}=d,{mouseStore:p}=d.stores,{cmdKey:m,altKey:g,spacebar:v,canvasMousePosition:S}=p.latest,h=g&&m,f=r&&xe(r),y=o.originalid&&!Ur(o)&&!Ao(o),x=!v&&(!m||h)&&!f&&!y,b=r;if(x||a){if(b=ep(d,o,n,this.selectionIds(),S,g),g&&b&&u.isGroundNode(b)){let C=u.getRect(b.draftOrCurrent());(C.width<=i.width&&C.height<=i.height||b.id===o.duplicatedFrom?.[o.duplicatedFrom.length-1])&&(b=null)}!a&&tp(u,n,r,b,s)&&(b=r)}return b}reparentNode(o,r,n,i,a,s,l){let{engine:c}=this,d=c.tree.getParent(o.id);return er(r,d)&&s===-1&&!i?o:Ye(o)&&r&&qe(r)?this.reparentNodeInsideVariant(o,r,s):Ye(o)?this.moveNodeOutOfVariant(o,r,s,n,a,l):r&&qe(r)?this.moveNodeIntoVariant(o,r,s,n):(c.moveNode(o.id,r?r.id:ye,s),mt(r)&&Wo(o)&&(jr(r)?o.gridItemFillCellHeight===!0&&o.set({gridItemFillCellHeight:void 0}):(o.gridItemFillCellWidth===void 0&&o.set({gridItemFillCellWidth:!0}),o.gridItemFillCellHeight===void 0&&o.set({gridItemFillCellHeight:!0}))),o)}reparentNodeInsideVariant(o,r,n){let{engine:i}=this;return Un(i,o,r),i.moveNode(o.originalid,r.originalid,n),o}moveNodeOutOfVariant(o,r,n,i,a,s){let{engine:l}=this,c=l.tree.getNode(o.originalid);if(I(c,"original node must exist"),!Z.isOn("betterStackGridItemMoving")&&(!Hn(l.tree,o)||a))this.updateNodesInMoveToolBaseFontSize(o.id,c.id),Wn(l,o,c,i),l.moveNode(c.id,r?r.id:ye,n);else if(s){let d=this.cloneCache.get(o.id)??l.cloneNode(o,!1,!1);this.cloneCache.set(o.id,d);let u=d.cloneWithIds();return l.stores.scopeStore.insertNode(u,r?r.id:ye,n),this.updateNodesInMoveToolBaseFontSize(o.id,u.id),l.tree.current(o)?.set({visible:!1}),i.delete(o.id),i.add(u.id),u}return c}moveNodeIntoVariant(o,r,n,i){let{engine:a}=this,s=a.tree.getNode(r.originalid);I(s,"original node of the new parent should exist"),a.moveNode(o.id,s?.id??ye,n);let l=jn(a,o,r,s,i,this.renamedIds);return this.updateNodesInMoveToolBaseFontSize(o.id,l),o}insertSelectionIntoStackOrGrid(o,r,n,i){if(Fe(this.activeStackOrGrid)||!j(this.activeStackOrGridInsertion))return;let{engine:a}=this,s=Array.from(this.nodesBeginState.keys()).map(p=>o.get(p)??p.id),l=this.activeStackOrGrid,c=Z.isOn("betterStackGridItemMoving"),d=c?this.activeStackOrGridInsertion:yp(this.activeStackOrGridInsertion,l,s);if(i&&wo(l)){let p=ta(a,l,i);p&&(l=p)}let u=mt(l);for(let[p,m]of this.nodesBeginState){let g=o.get(p)??p.id,v=a.tree.getNode(g);if(!v)continue;I(!Fe(l),"stackOrGrid must be a valid node");let S=p.id!==g;if(c&&!S&&m.parent&&m.parent.id===l.id&&m.index<this.activeStackOrGridInsertion&&(d-=1),(c?v.parentid===l.id:n)&&!S&&nn(l)&&Yo(v)){Jn(v.getPrimaryId(),l,d),d+=1;continue}let h=this.reparentNode(v,l,r,S,n,d,!0),f=Ko(h,l);if(Xo(h)&&f&&h.set(f),Qe(h)){let y={top:0,left:0,right:null,bottom:null,...m.startSizeProps};if(!m.parent||m.parent.id!==l.id){let b=y.widthType===3||y.widthType===1,C=y.heightType===3||y.heightType===1;b&&(u||l.widthType===2)&&(y.width=m.rect.width,y.widthType=0),C&&(u||l.heightType===2)&&(y.height=m.rect.height,y.heightType=0)}h.set(y)}else h.set(m.startSizeProps);d+=1}}makeGroundNodes(o){for(let[r]of this.nodesBeginState){let n=o.get(r)??r.id,i=this.engine.tree.getNode(n);if(!i)continue;let a=r.id!==n;this.reparentNode(i,null,new Set,a,!1,-1,!1)}}removePlaceholders(o=!1){if(o||(this.engine.stores.toolStore.nodesWithPlaceholders=null),Z.isOn("betterStackGridItemMoving"))for(let{id:r}of this.parentsWithPlaceholders){let n=this.engine.tree.getNode(r);n&&(n.cache.placeholders=null)}else{if(!this.activeStackOrGrid)return;this.activeStackOrGrid.cache.placeholders=null}}};function Kd(e,t){let{canvasMousePosition:o,shiftKey:r}=e.latest,n=e.previous;return n.canvasMouseDownPosition?Zd(n.canvasMouseDownPosition,o,r,t):void 0}function Zd(e,t,o,r){let n=P.pixelAligned(P.subtract(t,e));return r?r==="horizontal"?n.y=0:n.x=0:o&&(Math.abs(n.x)>Math.abs(n.y)?n.y=0:n.x=0),n}function Qd(e,t){let o=t.map(i=>i?e.getParent(i.id):void 0);if(!(new Set(o).size===1))return;let n=o[0];return n?n.id:ye}function Jd(e,t,o,r,n,i){let{tree:a}=e;if(!dn(o)||ri(o)||Yr(o)||!Qn(a,o,t,n,e.componentLoader))return!1;let s=a.getAncestors(o.id);return s.push(o.id),!(Qi(s,r)||s.some(d=>d===t.id)||i&&La(t,o))}function ep(e,t,o,r,n,i){let{tree:a}=e,s=e.stores.scopeStore.active,l=a.getPotentialParents(s,e.stores.overlayStore.activeOverlays,o,n,e.componentLoader,t);return a.sortVisually(l).reverse().find(u=>Jd(e,t,u,r,s.id,i))||ye}function tp(e,t,o,r,n){if(n||!o||!r||!!er(r,o)||!(!r||e.getAncestors(o.id).find(l=>r!==null&&l===r.id)))return!1;let s=Jo(e,o);return Ht.intersects(s,t)}function op(e,t,o){let r=o||t;return!r||xe(r)||Ze(r)&&r.sizeToFit?e:e.add(r.id)}function rp(e,t,o){let r={x:t.rect.x-o.x,y:t.rect.y-o.y};if(_t(e)){let n=e.resolveValue("rotation"),i=new DOMMatrix().rotateSelf(0,0,-n);r=Je.convertPoint(i,r)}return r}function np(e,t,o,r){let{tree:n}=e,{cmdKey:i,altKey:a}=e.stores.mouseStore.latest;!i||a&&i||o.children.forEach((l,c)=>{if(o.startFromStackOrGrid)return;let d=n.getNode(c);if(!d)return;let u=rp(t,o,r),p=T.offset(l.frame,u),m=d.updateForRect({rect:p,parentSizeInfo:n.getParentSizeInfo(d,t),constraintsLocked:tr(d),shouldGuessPinToBottom:Zo(n,d),shouldGuessPinToRight:Qo(n,d,n.getParent(d.id))});ip(d,m),e.tree.get(c)?.set(m)})}function ip(e,t){return Qe(e)&&((e.widthType===2||e.widthType===3)&&(delete t.width,delete t.widthType),(e.heightType===2||e.heightType===3)&&(delete t.height,delete t.heightType)),t}function ap(e){let t=1/0,o=0;for(let r=0,n=e.length;r<n;r++){let i=e[r];i>=t||(t=i,o=r)}return o}function sp(e,t,o,r,n=new Map){t.forEach((a,s)=>{if(Yt(s)||xe(s)&&Ye(s))return;let l=r.get(s.id)??e.cloneNode(s,!1,!1,n);r.set(s.id,l);let c=l.cloneWithIds();e.stores.scopeStore.insertNode(c,s.parentid),n.set(s.id,c.id),o=o.set(s,c.id),$r(s)&&$n(e,s,n)});let i=Array.from(o.values());for(let a of i){let s=e.tree.getNode(a),l=e.tree.getParent(a),c=!!l&&(Ot(l)||qt(l));s&&ji(e.tree,e.componentLoader,s,n,c)}e.stores.selectionStore.set(i)}function lp(e,t){return e.every(o=>!Pp(o,t))}function cp(e,t){let o=null;for(let r=0,n=t.length;r<n;r++){let i=t[r];if(!i)return null;let a=e.getParent(i.id);if(!a)return null;if(o){if(o.id!==a.id)return null}else{if(!wo(a)&&!mt(a))return null;o=a}}return o}function dp(e){for(let t of e.values())if(!t.unableToMove)return!1;return!0}function pp(e){let t=new Map;for(let[,o]of e){if(!o.parent||!o.placeholderAttributes)continue;let r=t.get(o.parent)??[];r.push({index:o.index,attributes:o.placeholderAttributes}),t.set(o.parent,r)}return Array.from(t,([o,r])=>({id:o.id,placeholders:r}))}function up(e,t){if(!t)return;let o=new Set,r;for(let[a,s]of e){if(!s.parent)return;a.isVisible()&&Se(a,t)&&(o.add(s.index),(r===void 0||s.index<r)&&(r=s.index))}if(r===void 0)return;let n=jo(t)?t.getChildrenInVisualOrder():$o(t),i=0;for(let a=0;a<n.length;a+=1){let s=n[a];if(I(s),!s.isVisible()||!Se(s,t)){a<r&&(i+=1);continue}if(!(a<r)){if(!o.has(a))return;if(o.delete(a),o.size===0)return r-i}}}function mp(e){let t=0;for(let[o,r]of e)r.parent&&o.isVisible()&&Se(o,r.parent)&&(t+=1);return t}function fp(e){let t=0,o=0;return e.forEach(r=>{let{width:n,height:i}=r.rect;n>t&&(t=n),i>o&&(o=i)}),{width:t,height:o}}function hp(e,t,o){let r=e.tree.get(o.id);if(!r)return!1;let n=e.tree.getGroundNodeFor(r),i=e.tree.convertFrameToCanvas(n);return T.containsPoint(i,t)}function gp(e,t,o,r,n,i,a,s,l,c,d,u,p,m,g){if(r.length===0)return{visualInsertionIndex:null,insertionLine:null,activeStackOrGrid:null,isLiveSorting:!1};if(u)return{visualInsertionIndex:null,insertionLine:null,activeStackOrGrid:s,isLiveSorting:!1};let v=null,S=Z.isOn("betterStackGridItemMoving");if(a||m&&!g||p||!S&&s&&hp(e,t,s)?v=s:i&&(v=ea(e,t,r,s)),!v||d)return{visualInsertionIndex:null,insertionLine:null,activeStackOrGrid:v,isLiveSorting:!1};let h=!S&&s?.id===v.id;if(h)return{visualInsertionIndex:bp(e.tree,e.stores.layoutCache,t,o,n,v,e.tree.convertPointToNode(v,t),c),insertionLine:null,activeStackOrGrid:v,isLiveSorting:h};{let{insertionIndex:f,insertionLine:y,wrap:x}=Ji(v,e,t,l,{allowWrapping:s?.id!==v.id});return{visualInsertionIndex:f,insertionLine:y,activeStackOrGrid:v,isLiveSorting:h,wrap:x}}}function yp(e,t,o){let r=0,n=0;for(let i of t.getChildrenInVisualOrder()){if(n===e)break;o.includes(i.id)||(i.isVisible()&&n++,r++)}return r}function xp(e,t){let o=[],r=t;for(let n of e.values())n.placeholderAttributes&&(o.push({index:r,attributes:n.placeholderAttributes}),r+=1);return o}function vp(e,t,o,r,n,i,a){let s=t-o;if(s===0)return!0;if(!a)return e?i==="ltr"?Math.sign(n.x)===Math.sign(s):Math.sign(n.x)!==Math.sign(s):Math.sign(n.y)===Math.sign(s);let l=r[o],c=r[t];if(!l||!c)return!0;let d=e?{a:l.y,b:T.maxY(l)}:{a:l.x,b:T.maxX(l)},u=e?{a:c.y,b:T.maxY(c)}:{a:c.x,b:T.maxX(c)};if(d.b-u.a>=0&&u.b-d.a>=0)return!0;let m=u.a>=d.b?1:-1;return e?Math.sign(n.y)===m:Math.sign(n.x)===m}function Sp(e,t){let o=yr(t),r=0;for(let n=0;n<=e;n++){let i=o[n];i&&!Se(i,t)&&r++}return r}function bp(e,t,o,r,n,i,a,s){let l=Zi(i,t);if(!l)return 0;let c=ui(e,i);c&&(l=Bp(i,c,l));let d=l.map(y=>P.distance(T.center(y),a)),u=ap(d);u=u+Sp(u,i);let p=u,m=Wr(i),g=m||i.stackDirection==="horizontal",v=m||!!i.stackWrapEnabled,S=P.subtract(o,r),h=s!==void 0,f=s===null;if(h&&!f){let y=s,x=e.root.getHorizontalLayoutDirection();p=vp(g,u,y,l,S,x,v)?u:y}else if(f){let y=i.children.filter(x=>x.isVisible()).length;(g&&S.x<0||!g&&S.y<0)&&(p=y)}return i.cache.placeholders=xp(n,p),p}function Cp(e,t,o,r){let n=[],i=Array.from(t.keys());if(o.size>0){n.push(...i.map(a=>e.convertFrameToCanvas(a))),i.length=0;for(let[a,s]of o){let l=e.getNode(s);l&&i.push(l)}}if(r){let a=Ip(t);n.push(...a)}return{activeNodes:i,extraSnapRects:n}}function Ip(e){let t=[];return e.forEach(o=>{o.children.forEach(r=>{t.push(r.canvasFrame)})}),t}function yr(e){return jo(e)?e.getChildrenInVisualOrder():$o(e)}function Np(e,t){let o=new Map;if(xe(t))return o;let r=yr(t),n=Po(t);for(let i of r){if(n&&!Se(i,t))continue;let a=e.getRect(i),s=e.convertFrameToCanvas(i);o.set(i.id,{frame:a,canvasFrame:s})}return o}function Tp(e){let t={};return en(e)&&(t.width=e.width,t.height=e.height),Qe(e)&&(t.widthType=e.widthType,t.heightType=e.heightType),t}function Rp(e,t,o,r){let n=e.sortVisually(o),i=new Map;return n.forEach(a=>{let s=kp(e,t,a,r);i.set(a,s)}),i}function gr(e,t){return t?e.transformMatrixToNode(t):Je.identity()}function Mp(e,t){if(t){let o=e.transformMatrixToNode(t);return gi(t)?o:Je.flatProjectionMatrix(o)}return Je.identity()}function kp(e,t,o,r){let n=e.getParent(o.id),i=!!(n&&Po(n)),a=i&&Ye(o)&&!Ao(o)||Jr(o)||!Yo(o),s=e.getRect(o),l;if(Se(o,n)&&(l={width:s.width,height:s.height},mt(n))){let S={};Si(o,S,{componentLoader:t}),Wo(o)&&(o.gridItemFillCellWidth&&(S.width="100%"),o.gridItemFillCellHeight&&(Z.isOn("gridBentoFit")||n.gridRowHeightType!=="fit")&&(S.height="100%")),l.style=S}let c=oo(gr(e,n),{x:0,y:0},r),u=mi(e,o)?pi(e,o):void 0,p=u&&!qe(u)?u.id:void 0,m={rect:s,matrix:o.originAdjustedMatrix(null,s),untransformedPointUnderMouse:c,canvasPointUnderMouse:n?e.convertPointToCanvas(n,c):c,children:Np(e,o),startFromStackOrGrid:i,unableToMove:a,startSizeProps:Tp(o),constraintsLocked:Qe(o)?o.constraintsLocked:!1,placeholderAttributes:l,disableReparenting:Yt(o),repeaterId:p};if(!n)return{...m,parent:null,index:void 0};let v=yr(n).indexOf(o);return{...m,parent:n,index:v===-1?0:v}}function Pp(e,t){if(!xe(e))return!1;let o=t.getParent(e.id);return Gt(o)||Kr(o)}function wp(e,t){return t?e.constraintsLocked:!1}function Fp(e,t,o){t.forEach((r,n)=>{let i=e.tree.getNode(o.get(n)??n.id)||n,a=e.stores.scopeStore.active;Ke(a)&&ka(e.tree,a,i)&&Da(e.tree,a)})}function Dp(e,t){if(!(e.size>0))return;let r=0;for(let n of e.values()){let i=t.getNode(n);if(i)for(let a of i.walk())Lt(a)&&r++}r>0&&be("layout_frame",{source:"duplication",count:r})}function Ap(e,t,o){t.forEach((r,n)=>{let i=e.tree.getNode(o.get(n)??n.id)||n,a=e.tree.getParent(i.id);if(a&&(qt(a)||qt(i)||Ot(a)))for(let{node:s,skipChildren:l}of i.walkWithSkipChildren())Ot(s)&&(e.stores.overlayStore.cleanupOverlay(e.stores.selectionStore,s.id,s.parentid,!1),e.tree.removeNode(s),l())})}function Lp(e,t,o){t.forEach((r,n)=>{let i=e.tree.getNode(o.get(n)??n.id)||n;if(!r.repeaterId||i.parentid===r.repeaterId)return;let a=e.tree.get(r.repeaterId);Bt(a)&&fi(a)})}function Bp(e,t,o){if(o.length===0)return o;let r=e.children.findIndex(a=>a.id===t.id);I(r>=0,"Must have repeated item node as child");let n=o.length-e.children.length+1,i=o[r];return I(i,"Must have a rect"),[...o.slice(0,r),i,...o.slice(r+n)]}var xr=new tn(async()=>{let e=await Promise.all([import("dist-QQ2LXD6V.mjs"),import("dist-EZVESS7Y.mjs"),import("dist-Z5YLEBXY.mjs"),import("dist-7WM25YWQ.mjs"),import("dist-Z2BXEQZM.mjs"),import("dist-GBVMIGFI.mjs"),import("dist-NBGG27WF.mjs"),import("dist-YL6PRWQE.mjs"),import("prosemirror-suggest-HNREWP6R.mjs")]);return Object.assign({},...e)});function rx(){xr.preload()}async function nx(){return xr.readMaybeAsync()}function ix(){return xr.use()}var dx="arpwu8w",px="a1pulxae";var Ep={"3g2":"video/3gpp2","3gp":"video/3gpp","3gpp":"video/3gpp","3mf":"model/3mf",aac:"audio/aac",ac:"application/pkix-attr-cert",adp:"audio/adpcm",adts:"audio/aac",ai:"application/postscript",aml:"application/automationml-aml+xml",amlx:"application/automationml-amlx+zip",amr:"audio/amr",apng:"image/apng",appcache:"text/cache-manifest",appinstaller:"application/appinstaller",appx:"application/appx",appxbundle:"application/appxbundle",asc:"application/pgp-keys",atom:"application/atom+xml",atomcat:"application/atomcat+xml",atomdeleted:"application/atomdeleted+xml",atomsvc:"application/atomsvc+xml",au:"audio/basic",avci:"image/avci",avcs:"image/avcs",avif:"image/avif",aw:"application/applixware",bdoc:"application/bdoc",bin:"application/octet-stream",bmp:"image/bmp",bpk:"application/octet-stream",btf:"image/prs.btif",btif:"image/prs.btif",buffer:"application/octet-stream",ccxml:"application/ccxml+xml",cdfx:"application/cdfx+xml",cdmia:"application/cdmi-capability",cdmic:"application/cdmi-container",cdmid:"application/cdmi-domain",cdmio:"application/cdmi-object",cdmiq:"application/cdmi-queue",cer:"application/pkix-cert",cgm:"image/cgm",cjs:"application/node",class:"application/java-vm",coffee:"text/coffeescript",conf:"text/plain",cpl:"application/cpl+xml",cpt:"application/mac-compactpro",crl:"application/pkix-crl",css:"text/css",csv:"text/csv",cu:"application/cu-seeme",cwl:"application/cwl",cww:"application/prs.cww",davmount:"application/davmount+xml",dbk:"application/docbook+xml",deb:"application/octet-stream",def:"text/plain",deploy:"application/octet-stream",dib:"image/bmp","disposition-notification":"message/disposition-notification",dist:"application/octet-stream",distz:"application/octet-stream",dll:"application/octet-stream",dmg:"application/octet-stream",dms:"application/octet-stream",doc:"application/msword",dot:"application/msword",dpx:"image/dpx",drle:"image/dicom-rle",dsc:"text/prs.lines.tag",dssc:"application/dssc+der",dtd:"application/xml-dtd",dump:"application/octet-stream",dwd:"application/atsc-dwd+xml",ear:"application/java-archive",ecma:"application/ecmascript",elc:"application/octet-stream",emf:"image/emf",eml:"message/rfc822",emma:"application/emma+xml",emotionml:"application/emotionml+xml",eps:"application/postscript",epub:"application/epub+zip",exe:"application/octet-stream",exi:"application/exi",exp:"application/express",exr:"image/aces",ez:"application/andrew-inset",fdf:"application/fdf",fdt:"application/fdt+xml",fits:"image/fits",g3:"image/g3fax",gbr:"application/rpki-ghostbusters",geojson:"application/geo+json",gif:"image/gif",glb:"model/gltf-binary",gltf:"model/gltf+json",gml:"application/gml+xml",gpx:"application/gpx+xml",gram:"application/srgs",grxml:"application/srgs+xml",gxf:"application/gxf",gz:"application/gzip",h261:"video/h261",h263:"video/h263",h264:"video/h264",heic:"image/heic",heics:"image/heic-sequence",heif:"image/heif",heifs:"image/heif-sequence",hej2:"image/hej2k",held:"application/atsc-held+xml",hjson:"application/hjson",hlp:"application/winhlp",hqx:"application/mac-binhex40",hsj2:"image/hsj2",htm:"text/html",html:"text/html",ics:"text/calendar",ief:"image/ief",ifb:"text/calendar",iges:"model/iges",igs:"model/iges",img:"application/octet-stream",in:"text/plain",ini:"text/plain",ink:"application/inkml+xml",inkml:"application/inkml+xml",ipfix:"application/ipfix",iso:"application/octet-stream",its:"application/its+xml",jade:"text/jade",jar:"application/java-archive",jhc:"image/jphc",jls:"image/jls",jp2:"image/jp2",jpe:"image/jpeg",jpeg:"image/jpeg",jpf:"image/jpx",jpg:"image/jpeg",jpg2:"image/jp2",jpgm:"image/jpm",jpgv:"video/jpeg",jph:"image/jph",jpm:"image/jpm",jpx:"image/jpx",js:"text/javascript",json:"application/json",json5:"application/json5",jsonld:"application/ld+json",jsonml:"application/jsonml+json",jsx:"text/jsx",jt:"model/jt",jxl:"image/jxl",jxr:"image/jxr",jxra:"image/jxra",jxrs:"image/jxrs",jxs:"image/jxs",jxsc:"image/jxsc",jxsi:"image/jxsi",jxss:"image/jxss",kar:"audio/midi",ktx:"image/ktx",ktx2:"image/ktx2",less:"text/less",lgr:"application/lgr+xml",list:"text/plain",litcoffee:"text/coffeescript",log:"text/plain",lostxml:"application/lost+xml",lrf:"application/octet-stream",m1v:"video/mpeg",m21:"application/mp21",m2a:"audio/mpeg",m2t:"video/mp2t",m2ts:"video/mp2t",m2v:"video/mpeg",m3a:"audio/mpeg",m4a:"audio/mp4",m4p:"application/mp4",m4s:"video/iso.segment",ma:"application/mathematica",mads:"application/mads+xml",maei:"application/mmt-aei+xml",man:"text/troff",manifest:"text/cache-manifest",map:"application/json",mar:"application/octet-stream",markdown:"text/markdown",mathml:"application/mathml+xml",mb:"application/mathematica",mbox:"application/mbox",md:"text/markdown",mdx:"text/mdx",me:"text/troff",mesh:"model/mesh",meta4:"application/metalink4+xml",metalink:"application/metalink+xml",mets:"application/mets+xml",mft:"application/rpki-manifest",mid:"audio/midi",midi:"audio/midi",mime:"message/rfc822",mj2:"video/mj2",mjp2:"video/mj2",mjs:"text/javascript",mml:"text/mathml",mods:"application/mods+xml",mov:"video/quicktime",mp2:"audio/mpeg",mp21:"application/mp21",mp2a:"audio/mpeg",mp3:"audio/mpeg",mp4:"video/mp4",mp4a:"audio/mp4",mp4s:"application/mp4",mp4v:"video/mp4",mpd:"application/dash+xml",mpe:"video/mpeg",mpeg:"video/mpeg",mpf:"application/media-policy-dataset+xml",mpg:"video/mpeg",mpg4:"video/mp4",mpga:"audio/mpeg",mpp:"application/dash-patch+xml",mrc:"application/marc",mrcx:"application/marcxml+xml",ms:"text/troff",mscml:"application/mediaservercontrol+xml",msh:"model/mesh",msi:"application/octet-stream",msix:"application/msix",msixbundle:"application/msixbundle",msm:"application/octet-stream",msp:"application/octet-stream",mtl:"model/mtl",mts:"video/mp2t",musd:"application/mmt-usd+xml",mxf:"application/mxf",mxmf:"audio/mobile-xmf",mxml:"application/xv+xml",n3:"text/n3",nb:"application/mathematica",nq:"application/n-quads",nt:"application/n-triples",obj:"model/obj",oda:"application/oda",oga:"audio/ogg",ogg:"audio/ogg",ogv:"video/ogg",ogx:"application/ogg",omdoc:"application/omdoc+xml",onepkg:"application/onenote",onetmp:"application/onenote",onetoc:"application/onenote",onetoc2:"application/onenote",opf:"application/oebps-package+xml",opus:"audio/ogg",otf:"font/otf",owl:"application/rdf+xml",oxps:"application/oxps",p10:"application/pkcs10",p7c:"application/pkcs7-mime",p7m:"application/pkcs7-mime",p7s:"application/pkcs7-signature",p8:"application/pkcs8",pdf:"application/pdf",pfr:"application/font-tdpfr",pgp:"application/pgp-encrypted",pkg:"application/octet-stream",pki:"application/pkixcmp",pkipath:"application/pkix-pkipath",pls:"application/pls+xml",png:"image/png",prc:"model/prc",prf:"application/pics-rules",provx:"application/provenance+xml",ps:"application/postscript",pskcxml:"application/pskc+xml",pti:"image/prs.pti",qt:"video/quicktime",raml:"application/raml+yaml",rapd:"application/route-apd+xml",rdf:"application/rdf+xml",relo:"application/p2p-overlay+xml",rif:"application/reginfo+xml",rl:"application/resource-lists+xml",rld:"application/resource-lists-diff+xml",rmi:"audio/midi",rnc:"application/relax-ng-compact-syntax",rng:"application/xml",roa:"application/rpki-roa",roff:"text/troff",rq:"application/sparql-query",rs:"application/rls-services+xml",rsat:"application/atsc-rsat+xml",rsd:"application/rsd+xml",rsheet:"application/urc-ressheet+xml",rss:"application/rss+xml",rtf:"text/rtf",rtx:"text/richtext",rusd:"application/route-usd+xml",s3m:"audio/s3m",sbml:"application/sbml+xml",scq:"application/scvp-cv-request",scs:"application/scvp-cv-response",sdp:"application/sdp",senmlx:"application/senml+xml",sensmlx:"application/sensml+xml",ser:"application/java-serialized-object",setpay:"application/set-payment-initiation",setreg:"application/set-registration-initiation",sgi:"image/sgi",sgm:"text/sgml",sgml:"text/sgml",shex:"text/shex",shf:"application/shf+xml",shtml:"text/html",sieve:"application/sieve",sig:"application/pgp-signature",sil:"audio/silk",silo:"model/mesh",siv:"application/sieve",slim:"text/slim",slm:"text/slim",sls:"application/route-s-tsid+xml",smi:"application/smil+xml",smil:"application/smil+xml",snd:"audio/basic",so:"application/octet-stream",spdx:"text/spdx",spp:"application/scvp-vp-response",spq:"application/scvp-vp-request",spx:"audio/ogg",sql:"application/sql",sru:"application/sru+xml",srx:"application/sparql-results+xml",ssdl:"application/ssdl+xml",ssml:"application/ssml+xml",stk:"application/hyperstudio",stl:"model/stl",stpx:"model/step+xml",stpxz:"model/step-xml+zip",stpz:"model/step+zip",styl:"text/stylus",stylus:"text/stylus",svg:"image/svg+xml",svgz:"image/svg+xml",swidtag:"application/swid+xml",t:"text/troff",t38:"image/t38",td:"application/urc-targetdesc+xml",tei:"application/tei+xml",teicorpus:"application/tei+xml",text:"text/plain",tfi:"application/thraud+xml",tfx:"image/tiff-fx",tif:"image/tiff",tiff:"image/tiff",toml:"application/toml",tr:"text/troff",trig:"application/trig",ts:"video/mp2t",tsd:"application/timestamped-data",tsv:"text/tab-separated-values",ttc:"font/collection",ttf:"font/ttf",ttl:"text/turtle",ttml:"application/ttml+xml",txt:"text/plain",u3d:"model/u3d",u8dsn:"message/global-delivery-status",u8hdr:"message/global-headers",u8mdn:"message/global-disposition-notification",u8msg:"message/global",ubj:"application/ubjson",uri:"text/uri-list",uris:"text/uri-list",urls:"text/uri-list",vcard:"text/vcard",vrml:"model/vrml",vtt:"text/vtt",vxml:"application/voicexml+xml",war:"application/java-archive",wasm:"application/wasm",wav:"audio/wav",weba:"audio/webm",webm:"video/webm",webmanifest:"application/manifest+json",webp:"image/webp",wgsl:"text/wgsl",wgt:"application/widget",wif:"application/watcherinfo+xml",wmf:"image/wmf",woff:"font/woff",woff2:"font/woff2",wrl:"model/vrml",wsdl:"application/wsdl+xml",wspolicy:"application/wspolicy+xml",x3d:"model/x3d+xml",x3db:"model/x3d+fastinfoset",x3dbz:"model/x3d+binary",x3dv:"model/x3d-vrml",x3dvz:"model/x3d+vrml",x3dz:"model/x3d+xml",xaml:"application/xaml+xml",xav:"application/xcap-att+xml",xca:"application/xcap-caps+xml",xcs:"application/calendar+xml",xdf:"application/xcap-diff+xml",xdssc:"application/dssc+xml",xel:"application/xcap-el+xml",xenc:"application/xenc+xml",xer:"application/patch-ops-error+xml",xfdf:"application/xfdf",xht:"application/xhtml+xml",xhtml:"application/xhtml+xml",xhvml:"application/xv+xml",xlf:"application/xliff+xml",xm:"audio/xm",xml:"text/xml",xns:"application/xcap-ns+xml",xop:"application/xop+xml",xpl:"application/xproc+xml",xsd:"application/xml",xsf:"application/prs.xsf+xml",xsl:"application/xml",xslt:"application/xml",xspf:"application/xspf+xml",xvm:"application/xv+xml",xvml:"application/xv+xml",yaml:"text/yaml",yang:"application/yang",yin:"application/yin+xml",yml:"text/yaml",zip:"application/zip"};function Xs(e){let t=(""+e).trim().toLowerCase(),o=t.lastIndexOf(".");return Ep[~o?t.substring(++o):t]}var _s=dt(kc(),1);var Ie=dt(Gr(),1);async function Ks(e,t,o=1/0,r){r??=new et(e,{silent:!0});let n=[],i=[],a=[];for(let l of t){if(a.length>=o){i.push(l);continue}if(!Jt.includes(l.type)){n.push(l);continue}let c=r.add(l);a.push(c)}return n.length>0&&Ce({type:"add",key:"importUploadImagesUnsupported",variant:"warning",primaryText:(0,Ie.jsxs)("span",{className:xt,children:["Skipped ",n.length]}),secondaryText:"unsupported images.",duration:1e4}),i.length>0&&Ce({type:"add",key:"importUploadImagesSkipped",variant:"warning",primaryText:(0,Ie.jsxs)("span",{className:xt,children:["Skipped ",i.length]}),secondaryText:"images over field limit.",duration:1e4}),vr(r,a).catch(()=>{}),(await Promise.all(a)).filter(vt)}async function vr(e,t){let o="uploadEmbeddedImagesByUrl",r={type:"add",key:o,variant:"progress",icon:"image",duration:1/0,showCloseButton:"never"};for await(let{completed:i,started:a}of e.statusUpdates())Ce({...r,text:(0,Ie.jsxs)("span",{className:"toast-progress-row",children:[(0,Ie.jsx)("span",{className:"toast-progress-label toast-emphasis",children:"Adding images\u2026"}),(0,Ie.jsxs)("span",{className:`toast-progress-value ${xt}`,children:[i,"/",a]})]})});await Promise.allSettled(t);let{failed:n}=e.status;n>0&&Ce({type:"add",key:"importUploadImagesFailed",variant:"warning",primaryText:"Failed to upload",secondaryText:(0,Ie.jsxs)("span",{className:xt,children:[n," ",(0,_s.default)("image",n),"."]}),duration:5e3}),Ce({type:"remove",key:o})}var cl=dt(sl(),1);var ll=pe("ChooseFileService"),Cr=class{constructor(t,o,r){this.engine=t;this.assetService=o;this.filePickerRef=r;N(this,"assetUploader");this.assetUploader=new et(this.engine)}async pickFile({allowedFileTypes:t,multiple:o}={}){let r=this.filePickerRef.current;if(!r)return null;let i=!t||t.includes("*")||t.includes("*/*")?void 0:t?.flatMap(s=>{let l=cl.default.parse(s)?.essence,c=Xs(s),d=s.startsWith(".")?s:`.${s}`;return l?[l]:c?[c,d]:[d]}),a=await r.show(i,o);return a.isFiles()?a.value:null}async pickImage({allowedFileTypes:t=Qt,multiple:o}={}){return this.pickFile({allowedFileTypes:t,multiple:o})}async pickAndUploadImage(t={}){try{let o=await this.pickImage(t);if(!o)return[];if(o.length===1){let r=await this.assetUploader.add(o[0]);if(!r)return[];if(await this.assetService.refresh().catch(E),vt(r))return[r]}else return await Ks(this.engine,o,t.maxUploads)}catch(o){ll.warn("Failed to upload file:",o)}return[]}async pickAndUploadFile(t){try{let o=await this.pickFile(t);if(!o)return;let r=o[0];return r?await this.assetUploader.add(r):void 0}catch(o){ll.warn("Failed to upload file:",o)}}async addImages(t){if(!t?.length)return[];let r=(await Promise.all(Array.from(t,n=>this.assetUploader.add(n)))).filter(vt);return r.length===0||await this.engine.stores.assetStore.assetService?.refresh().catch(E),r}},{service:dl,resolve:Xp}=Ki();function Ax(e,t,o){Xp(new Cr(e,t,o))}var pl=class{constructor(){N(this,"nodeIdToRenderIdToRect",new Map);N(this,"nodeIdToLayoutTemplateSelectorToRect",new Map);N(this,"nodeIdToRenderIdToChildrenRects",new Map)}processLayoutMeasurements(t){let o=new Set,r=new Set;for(let{nodeId:n,renderId:i,layoutMetrics:a,layoutTemplateSelector:s}of t){let{childrenRects:l,...c}=a;r.has(n)||this.nodeIdToLayoutTemplateSelectorToRect.delete(n),r.add(n);let d=s?this.nodeIdToLayoutTemplateSelectorToRect.get(n)?.get(s):this.nodeIdToRenderIdToRect.get(n)?.get(i),u=this.nodeIdToRenderIdToChildrenRects.get(n)?.get(i);if(!(se(d,c,!0)&&_p(u,l))){if(s){let p=this.nodeIdToLayoutTemplateSelectorToRect.get(n)??new Map,m=c.matrix?DOMMatrixReadOnly.fromMatrix(c.matrix):void 0;p.set(s,{...c,matrix:m}),this.nodeIdToLayoutTemplateSelectorToRect.set(n,p)}else{let p=this.nodeIdToRenderIdToRect.get(n)??new Map;p.set(i,T.from(c)),this.nodeIdToRenderIdToRect.set(n,p)}if(l){let p=this.nodeIdToRenderIdToChildrenRects.get(n)??new Map;p.set(i,l),this.nodeIdToRenderIdToChildrenRects.set(n,p)}o.add(n)}}return o}getContentSize(t){let o=this.getRect(t),r=this.getChildrenRects(t);if(!o||!r)return;let{width:n,height:i}=T.merge(...r);return{width:n,height:i}}getRect(t){let o=or(t);return this.nodeIdToRenderIdToRect.get(o)?.get(t)}getRects(t){return this.nodeIdToRenderIdToRect.get(t)}getLayoutTemplateRects(t){return this.nodeIdToLayoutTemplateSelectorToRect.get(t)}getChildrenRects(t){let o=or(t);return this.nodeIdToRenderIdToChildrenRects.get(o)?.get(t)}pruneAfterTreeChanges(t){for(let o of t){let r=o.to.parentid&&o.from?.parentid&&o.to.parentid!==o.from.parentid;o.removed?(this.nodeIdToRenderIdToRect.delete(o.id),this.nodeIdToRenderIdToChildrenRects.delete(o.id),this.nodeIdToLayoutTemplateSelectorToRect.delete(o.id)):r&&this.nodeIdToRenderIdToRect.delete(o.id)}}};function _p(e,t){return e===t?!0:e===void 0||t===void 0||e.length!==t.length?!1:t.every((o,r)=>T.equals(o,e[r]??null))}async function ul(e,t){await t.updateComponent(e.id,1)}async function ml(e,{codeGenerationStore:t,modulesStore:o,treeStore:r},n,i={}){let{waitForAll:a=!0,persist:s=!0}=i,l=no(r.tree,n,e),c=[],d=[];for(let p of l)d.push(Ue("screen",p.id,"default").value),p!==e&&c.push(ul(p,t));let u=ul(e,t);return c.push(u),await Promise.all(a?c:[u]),s&&await t.persistence.process(),Wi(n,d,o)}function fl(e,t){if(fe(e)&&Oi(t,e)){let o=Gi(t,e);return I(X(o),"PreviewRenderer: WebPage Scope node must exist and be a WebPageNode"),I(o.isLoaded(),"PreviewRenderer: WebPage Scope node must fully loaded"),{entryNode:o.getPrimaryVariant(),entryScopeNode:o}}if(X(e)&&e.isLoaded())return{entryNode:e.getPrimaryVariant(),entryScopeNode:e};if(Lt(e)){let o=t.getGroundNodeFor(e),r=t.getScopeNodeFor(o);if(_e(r))return{entryNode:o,entryScopeNode:r}}if(Lo(e)){let o=t.getScopeNodeFor(e);return I(vn(o),"PreviewRenderer: Scope node must exist and be a node supports breakpoint variants"),I(o.isLoaded(),"PreviewRenderer: Scope node with breakpoint variants must be fully loaded"),{entryNode:o.getPrimaryVariant(),entryScopeNode:o}}if(rn(e)&&!Lo(e)){let o=t.getScopeNodeFor(e);return I(Xe(o),"PreviewRenderer: Smart Component Scope node must exist and be a SmartComponentNode"),{entryNode:e,entryScopeNode:o}}if(ei(e)&&e.isVectorSetItem){let o=t.getScopeNodeFor(e);return I(Vt(o),"PreviewRenderer: Scope node must exist and be a VectorSetNode"),{entryNode:e,entryScopeNode:o}}return{entryNode:e}}function hl(e,t){let o=e.getGroundNodeFor(t),r=e.getScopeNodeFor(o);return Ke(r)&&!fe(o)}var gl=pe("renderInfoForPreviewItem");function rt(e){let t=e.root.getDefaultLocale(),o=e.root.locales,r=[t];return o&&r.push(...o),r}function yl(e,t,o,r,n,i,a){let s=[],l=[],c={global:i.root.globalPageEffect,routes:{}},d=new Set,u=rt(i),m=Dn.vekterLocalesToRouterLocales(u,{includeDrafts:!0}).find(f=>f.id===n);for(let f of i.root.children){if(!Et(f)&&!X(f))continue;if(Et(f)&&s.push({id:f.id,moduleIdentifier:Na(),layoutTemplate:{moduleIdentifier:f.instanceIdentifier}}),X(f)){let b=f.isLoaded()?sr(Fn(f)):[],C=bi(i,f),w=xa(e,f);w&&l.push(w),va(e,f,R=>{l.push(R)}),s.push({id:f.id,moduleIdentifier:f.instanceIdentifier,collectionId:w?.collectionId,path:C,elements:b,layoutTemplate:Zp(a,f,m)}),f.isLoaded()&&Sa(c,f)}let x=a.componentForIdentifier(f.instanceIdentifier)?.fonts;if(!x){gl.debug("Did not find fonts for component:",f.instanceIdentifier);continue}for(let b of ba(x))d.add(b)}let g=r?t.getPathSlugs(o.id,r,m):void 0,v=[],S=g?.unresolvedSlugs;for(let f in S){let y=S[f];I(y),v.push({variableId:f,collectionId:y.collectionId,collectionItemId:y.collectionItemId})}let h=g?.pathVariables?sr(g.pathVariables):[];return gl.debug("renderInfoFor",{webPageNode:o,collectionItemNodeId:r,initialUnresolvedPathSlugs:v}),{kind:"webpage",routes:s,collectionUtils:l,locales:u,initialPathVariables:h,pageEffects:c,preloadFonts:Array.from(d),initialRoute:o.id,initialUnresolvedPathSlugs:v,initialLocaleId:n,adaptLayoutToTextDirection:i.root.adaptLayoutToTextDirection}}function Zp(e,t,o){if(!Sn(t))return;let r=t.getResolvedControlPropValues(e,Ta(),void 0,o);return{moduleIdentifier:t.layoutTemplateIdentifier,props:Dr(r)?void 0:r,richTextControlKeys:t.getRichTextControlKeys(e),vectorSetItemControls:t.getComponentVectorSetChildren(e)}}function vl(e,{treeStore:t,chromeStore:o,previewStore:r,modulesStore:n},i){if(!i)return{kind:"empty"};switch(i.type){case"component":return I(wt(i.componentId),"Previewing component should provide module identifier",i.componentId),{kind:"module",layout:"component",moduleIdentifier:i.componentId,locales:rt(t.tree),initialLocaleId:o.canvasLocaleId,adaptLayoutToTextDirection:t.tree.root.adaptLayoutToTextDirection};case"node":{let a=t.tree.get(i.nodeId);I(a,"Previewing node should provide correct node id",i.nodeId);let s=fl(a,t.tree),l=s.entryScopeNode;if(Et(l))return yl(n,r,l,i.collectionItemNodeId,o.canvasLocaleId,t.tree,e);if(_e(l))return{kind:"module",moduleIdentifier:Ue("design",a.id,"default").value,layout:"design-screen",locales:rt(t.tree),initialLocaleId:o.canvasLocaleId,adaptLayoutToTextDirection:t.tree.root.adaptLayoutToTextDirection};if(X(s.entryScopeNode))return yl(n,r,s.entryScopeNode,i.collectionItemNodeId,o.canvasLocaleId,t.tree,e);if(Xe(s.entryScopeNode)){let c={variant:{type:"enum",value:s.entryNode.id}};return{kind:"module",moduleIdentifier:s.entryScopeNode.instanceIdentifier,controlProps:c,layout:"component",locales:rt(t.tree),initialLocaleId:o.canvasLocaleId,adaptLayoutToTextDirection:t.tree.root.adaptLayoutToTextDirection}}if(Vt(s.entryScopeNode))return{kind:"module",moduleIdentifier:Ue("vector",s.entryNode.id,"default").value,layout:"component",locales:rt(t.tree),initialLocaleId:o.canvasLocaleId,adaptLayoutToTextDirection:t.tree.root.adaptLayoutToTextDirection};if(fe(s.entryNode)){let c=e.reactComponentForIdentifier(s.entryNode.codeComponentIdentifier),d=c?s.entryNode.getControlProps(c.properties):{};return{kind:"module",moduleIdentifier:s.entryNode.codeComponentIdentifier,controlProps:d,layout:"component",locales:rt(t.tree),initialLocaleId:o.canvasLocaleId,adaptLayoutToTextDirection:t.tree.root.adaptLayoutToTextDirection}}if(hl(t.tree,s.entryNode)){let c=t.tree.getGroundNodeFor(s.entryNode),d=no(t.tree,e,s.entryNode),u=[];for(let p of d){let m=t.tree.getGroundNodeFor(p),g=Ue("screen",m.id,"default").value;u.push({id:m.id,moduleIdentifier:g})}return{kind:"prototype",routeId:c.id,routes:u}}throw new Error(`Unsupported node for preview: ${a.id}`)}default:we(i)}}var Qp="getVectorSetItems";function Sl(e){return Qp in e}function bl(e,t){return e.getNodesWithTrait(t,r=>oi(r,e)).flatMap(r=>{if(r.moduleSourceRevision===void 0)return[];let n=la(r,e).filter(a=>!a.includes("draftCollection")),i=r.moduleSourceRevision;return n.map(a=>({moduleIdentifier:Ar(a,"default").value,moduleRevision:i}))})}function Jp(e){return e.mainView===1?e.codeEditorPreviewVisible:e.mainView===3}function Bv(e,t={}){let{previewStore:o,fullsizePreviewStore:r,loadingStore:n,chromeStore:i,treeStore:a,modulesStore:s}=e.stores;if(!n.hasMinimalEditableData)return;let{visible:l,shownOnLaunch:c,source:d="unknown"}=t,u=Jp(i),p=typeof l=="boolean"?l:!u;if(i.setPreviewVisible(p),!u&&p){o.addActiveSession();let m=o.computePreviewItem();if(!eu(e.componentLoader,{treeStore:a,previewStore:o,chromeStore:i,modulesStore:s},m))o.item=m;else if(m?.type==="node"){let g=a.tree.get(m.nodeId);I(g,"Did not find previewNode",m.nodeId),r.updatePreviewSize(g)}tu(e,m).then(g=>{o.targetModuleRevisions=bl(a.tree,g)}).catch(E).finally(()=>{o.item=m}),Aa({shown_on_launch:c,source:d})}else u&&!p&&(o.removeActiveSession(),o.stickyPreviewItem=!1,o.item=void 0)}function eu(e,t,o){if(!o||o.type!=="node")return!1;let{modulesStore:r}=t,n=vl(e,t,o);switch(n.kind){case"module":{let i=me(n.moduleIdentifier);return ue(i)?!r.getModuleEntryByLocalId(i.localId):!1}case"webpage":{let i=Co("screen",n.initialRoute);return!r.getModuleEntryByLocalId(i)}case"prototype":{let i=Co("prototype",n.routeId);return!r.getModuleEntryByLocalId(i)}case"empty":return!1;default:we(n)}}async function tu(e,t){if(!t)return[];let o=await ou(e,t),{codeGenerationStore:r}=e.stores,n=await r.generateAndUpdateQueuedComponents();return await r.serialization.idle(),[o,...n]}async function ou(e,t){let{componentLoader:o,stores:r}=e,{codeGenerationStore:n,treeStore:i,modulesStore:a}=r;if(t.type==="component"){if(!n.canSerialize(t.componentId))return;await n.updateComponent(t.componentId,1);return}else if(t.collectionItemNodeId){let s=i.tree.getParent(t.collectionItemNodeId);return!s||!n.canSerialize(s.id)?void 0:(await n.updateComponent(s.id,1),s.id)}else{let s=i.tree,l=s.get(t.nodeId);I(l,"Did not find previewNode",t.nodeId);let c=s.getCanvasScopeNodeFor(l);if(I(c,"Tried triggering code generation for non canvas scope node:",l.id),Sl(c))return!ti(l)||!n.canSerialize(l.id)?void 0:(await n.updateComponent(l.id,1),l.id);if(Vn(c))return n.canSerialize(c.id)?(await n.updateComponent(c.id,1),c.id):void 0;if(Ke(c))return n.canSerialize(l.id)?(await ml(l,{codeGenerationStore:n,treeStore:i,modulesStore:a},o),l.id):void 0;if(_e(c))return n.canSerialize(l.id)?(await n.updateComponent(l.id,1),l.id):void 0;we(c)}}function Gv(e){let{newContentAsDraft:t}=e.stores.persistedUserDefaults;return!(!t||e.stores.publishStore.publishStatus===1)}var Cl=class extends Kt{constructor(){super(...arguments);N(this,"menu",null);N(this,"isOpen",!1)}show(o,r,n="validate"){let i=Ra(o,n==="validate"?{validateAction:Ca,appAccelerators:tt,appAcceleratorsWindows:Ia}:null);this.menu={items:i,config:r,startTime:performance.now()},this.isOpen=!0}close(){this.scheduler.processWhenReady(()=>{this.menu&&(this.menu.config.onDone?.(),this.menu.config.onCancel?.(),this.menu=null,this.isOpen=!1)})}};var nt,Te,Il=class extends Kt{constructor(o){super();this.modulesStore=o;So(this,nt,new Map);So(this,Te,new Map);N(this,"_forceUpdate",0)}rerender(){this._forceUpdate++}queue(o){if(ae(this,Te).has(o))return;let r=new Lr;ae(this,Te).set(o,r),this.rerender()}cache(o,r){let n=ae(this,Te).get(o);n&&n.resolve(r),ae(this,Te).delete(o),ae(this,nt).set(o,r),this.rerender()}getByGlobalId(o){let r=this.modulesStore.getPersistedModuleByGlobalId(o);if(!r)return;let n=xi(r.localId)[1],i=ae(this,Te).get(n);if(i)return i;let a=ae(this,nt).get(n);if(a)return a;let s=this.modulesStore.forType("vector").getByStableName(n)?.transientSVGIcon;if(s)return{svg:s}}delete(o){ae(this,nt).delete(o),this.rerender()}};nt=new WeakMap,Te=new WeakMap;function iS(e,t){if(!Bi(e)){t.onlyNodesWithFormInputFontStyles=!1;return}ee("formInputFontFamily",t,e),ru(t,e),ee("formInputFontColor",t,e),ee("formInputFontWeight",t,e),ee("formInputFontStyle",t,e),ee("formInputFontLineHeight",t,e),ee("formInputFontLineHeightUnit",t,e),ee("formInputFontTextAlignment",t,e),ee("formInputFontLetterSpacing",t,e),ee("formInputFontLetterSpacingUnit",t,e),O(t.formInputFontSelector)&&(t.formInputFontSelector=new Set),ko(e.formInputFontSelector)&&t.formInputFontSelector.add(e.formInputFontSelector),t.formInputOpenTypeFontFeatures=Ir(t.formInputOpenTypeFontFeatures,e.formInputOpenTypeFontFeatures),t.formInputVariationAxes=Nr(t.formInputVariationAxes,e.formInputVariationAxes)}function ru(e,t){let o=e.formInputFontSize,r=e.formInputFontSizeUnit;if(V(o)&&V(r)||J(t.formInputFontSize))return;let[n,i]=j(t.formInputFontSize)?[t.formInputFontSize,"px"]:ft(t.formInputFontSize);if(O(r))e.formInputFontSizeUnit=i;else if(ge(i,r)){e.formInputFontSizeUnit=M,e.formInputFontSize=M;return}O(o)?e.formInputFontSize=n:ge(n,o)&&(e.formInputFontSize=M)}function Ir(e,t){let o=new Set(De(e)?Object.keys(e):void 0),r=t??[],n=De(e)?e:{};for(let i of r){if(!ht(i))continue;let a=n[i];J(a)&&(n[i]=De(e)?M:!0),o.delete(i)}for(let i of o)ht(i)&&(n[i]=M);return n}function Nr(e,t){let o=De(e)?e:{},r=new Set(Object.keys(o));if(ko(t))for(let n in t){let i=o[n];r.delete(n),!V(i)&&(J(i)?o[n]=t[n]:i!==t[n]&&(o[n]=M))}for(let n of r)o[n]=M;return o}var iu={borderBottom:M,borderLeft:M,borderRight:M,borderTop:M,borderWidth:M,borderColor:M,borderStyle:M,borderPerSide:M};function D(e,t){return V(t)?M:O(t)?e:ge(e,t)?M:e}function au(e,t){return V(t)?M:O(t)||se(e,t)?e:M}function su(e,t,o){return I(De(e)),V(e)?M:e.length!==t.length?M:(e.forEach((r,n)=>{let i=t[n];I(i);let a=r.type;switch(a){case"boolean":case"color":case"date":case"enum":case"file":case"link":case"number":case"object":case"richtext":case"string":case"transition":case"image":case"responsiveimage":case"scrollsectionref":case"customcursor":case"border":case"cursor":It(r,i,o);break;default:we(a)}}),e)}function It(e,t,o){switch(e.type){case"array":{if(I(t.type==="array"),I(o.type==="array"),V(e.value))break;if(O(e.value)){if(At(t.value)){e.value=t.value;break}e.value=t.value.map(r=>uu(o.control,r.id))}if(At(t.value)){e.value=D(t.value,e.value);break}if(At(e.value)){e.value=M;break}e.value=su(e.value,t.value,o.control);break}case"slot":{if(I(t.type===e.type),V(e.value))break;I(o.type==="slot"),I(!Y(t.value),"Slots don't support dynamic values"),O(e.value)?e.value=t.value:e.value=M;break}case"object":if(I(t.type===e.type),V(e.value))break;if(I(o.type==="object"),O(e.value))if(t.value===null)e.value=null;else{e.value={};for(let r in o.controls){let n=o.controls[r];I(n);let i=pu(n);i&&(e.value[r]=i)}}if(e.value===null||t.value===null){e.value!==t.value&&(e.value=M);break}for(let r in e.value){let n=o.controls[r];I(n);let i=e.value[r];I(i);let a=t.value[r];I(a,"getControlProps(), should have added these if they were missing from the document data"),It(i,a,n)}break;case"transition":if(I(t.type===e.type),V(e.value))break;if(O(e.value)){e.value=t.value;break}if(Y(e.value)||Y(t.value)||!e.value||!t.value){e.value=D(t.value,e.value);break}se(e.value,t.value)||(e.value=M);break;case"responsiveimage":if(I(t.type==="image"),e.value=D(t.value,e.value),e.type==="responsiveimage"){let r=ut(t.alt)?t.alt:"";e.alt=D(r,e.alt);let{positionX:n,positionY:i}=t;e.positionX=D(n,e.positionX),e.positionY=D(i,e.positionY)}break;case"fusednumber":I(t.type===e.type),e.single=D(t.value.single,e.single),e.isFused=D(t.isFused,e.isFused),e.fused[0]=D(t.value.fused[0],e.fused[0]),e.fused[1]=D(t.value.fused[1],e.fused[1]),e.fused[2]=D(t.value.fused[2],e.fused[2]),e.fused[3]=D(t.value.fused[3],e.fused[3]);break;case"link":{if(I(t.type===e.type),V(e.value))break;if(O(e.value)){e.value=t.value;break}if(Y(e.value)||Y(t.value)||!e.value||!t.value){e.value=D(t.value,e.value);break}if(!Bo(e.value,t.value)){e.value=M;break}break}case"linkrelvalues":{if(I(t.type===e.type),V(e.value))break;if(O(e.value)){e.value=t.value;break}if(Y(e.value)||Y(t.value)||!e.value||!t.value){e.value=D(t.value,e.value);break}se(e.value,t.value)||(e.value=M);break}case"pagescope":if(I(t.type===e.type),V(e.value))break;if(O(e.value)){e.value=t.value;break}if(!e.value||!t.value){e.value=D(t.value,e.value);break}if(!Bo(e.value,t.value)){e.value=M;break}break;case"font":{if(I(o.type==="font"),I(t.type===e.type),V(e.value))break;if(O(e.value)){if(J(t.value)){e.value=t.value;break}let v=new Set([t.value.fontSelector]),S=L,h=new Set,f=new Set,y=L,x=L,b=L,C=new Set,w={};if(o.displayFontSize){let[k,F]=Do(t.value.fontSize)?ft(t.value.fontSize):[];S=k,F&&h.add(F)}if(o.displayTextAlignment&&(x=t.value.textAlignment),o.controls==="extended"){let[k,F]=t.value.lineHeight??[];y=k,F&&f.add(F);let[z,B]=t.value.letterSpacing??[];b=z,B&&C.add(B)}t.value.openTypeFontFeatures&&(w=(t.value.openTypeFontFeatures??[]).reduce((k,F)=>(ht(F)&&(k[F]=!0),k),{}));let R=t.value.variationAxes??{};e.value={fontSelector:v,lineHeightValue:y,lineHeightUnits:f,fontSizeValue:S,fontSizeUnits:h,textAlignment:x,letterSpacingValue:b,letterSpacingUnits:C,openTypeFontFeatures:w,variationAxes:R};break}if(J(e.value)){J(t.value)||(e.value=M);break}if(J(t.value)){e.value=M;break}let{fontSelector:r,lineHeight:[n,i]=[],fontSize:a,textAlignment:s,letterSpacing:[l,c]=[],openTypeFontFeatures:d,variationAxes:u}=t.value;e.value.fontSelector.add(r);let[p,m]=Do(a)?ft(a):[],g=e.value.fontSizeValue!==p||!J(m)&&!e.value.fontSizeUnits.has(m);o.displayFontSize&&g&&(e.value.fontSizeValue=M,m&&e.value.fontSizeUnits.add(m)),o.displayTextAlignment&&e.value.textAlignment!==s&&(e.value.textAlignment=M),o.controls==="extended"&&(e.value.lineHeightValue!==n&&(e.value.lineHeightValue=M),i&&e.value.lineHeightUnits.add(i),e.value.letterSpacingValue!==l&&(e.value.letterSpacingValue=M),c&&e.value.letterSpacingUnits.add(c)),e.value.openTypeFontFeatures=Ir(e.value.openTypeFontFeatures,d),e.value.variationAxes=Nr(e.value.variationAxes,u);break}case"customcursor":case"scrollsectionref":{I(t.type===e.type);let r=se(t.value,e.value)?e.value:t.value;e.value=D(r,e.value);break}case"border":{if(I(t.type===e.type),O(e.value)){Y(t.value)?e.value=t.value:Fe(t.value)?e.value=null:e.value={...t.value};break}if(Y(t.value)||Y(e.value)||Fe(t.value)||Fe(e.value)){ge(t.value,e.value)&&(e.value=iu);break}let r=e.value;r.borderTop=D(t.value.borderTop,r.borderTop),r.borderRight=D(t.value.borderRight,r.borderRight),r.borderBottom=D(t.value.borderBottom,r.borderBottom),r.borderLeft=D(t.value.borderLeft,r.borderLeft),r.borderWidth=D(t.value.borderWidth,r.borderWidth),r.borderColor=D(t.value.borderColor,r.borderColor),r.borderStyle=D(t.value.borderStyle,r.borderStyle);break}case"boxshadow":I(t.type===e.type),e.value=xn(t.value,e.value);break;case"multicollectionreference":I(t.type===e.type),e.value=au(t.value,e.value);break;case"gap":{if(I(t.type===e.type),e.value=D(t.value,e.value),!V(e.columnGap)){let r=Y(t.value)?M:Ri(t.value);O(e.columnGap)?e.columnGap=r:ge(r,e.columnGap)&&(e.columnGap=M)}if(!V(e.rowGap)){let r=Y(t.value)?M:Mi(t.value);O(e.rowGap)?e.rowGap=r:ge(r,e.rowGap)&&(e.rowGap=M)}break}case"boolean":case"color":case"date":case"enum":case"file":case"number":case"richtext":case"string":case"image":case"cursor":case"padding":case"borderradius":case"collectionreference":case"trackingid":case"vectorsetitem":I(t.type===e.type),e.value=D(t.value,e.value);break;default:}}function Nt(e){switch(e.type){case"boolean":case"color":case"date":case"enum":case"file":case"link":case"linkrelvalues":case"number":case"richtext":case"string":case"transition":case"boxshadow":case"image":case"object":return{type:e.type,value:L};case"array":case"slot":case"font":case"pagescope":case"scrollsectionref":case"customcursor":case"border":case"cursor":case"padding":case"borderradius":case"collectionreference":case"multicollectionreference":case"vectorsetitem":return{type:e.type,value:L};case"gap":return{type:e.type,value:L,columnGap:L,rowGap:L};case"trackingid":return{type:e.type,value:L,trackingIdAIPrompt:L};case"fusednumber":return{type:"fusednumber",isFused:L,single:L,fused:[L,L,L,L]};case"responsiveimage":return{type:"responsiveimage",value:L,alt:L,positionX:L,positionY:L};case"eventhandler":case"changehandler":return null;default:return null}}var lu={number:!0,enum:!0,boolean:!0,string:!0,richtext:!0,color:!0,image:!0,responsiveimage:!0,file:!0,transition:!0,link:!0,date:!0,object:!0,array:!0,fusednumber:!0,font:!0,pagescope:!0,scrollsectionref:!0,customcursor:!0,border:!0,cursor:!0,boxshadow:!0,gap:!0,padding:!0,borderradius:!0,collectionreference:!0,multicollectionreference:!0,trackingid:!0};function cu(e){return Object.hasOwn(lu,e)}function du(e){return cu(e.type)}function pu(e){let t=Nt(e);return t?(I(du(t)),t):null}function uu(e,t){let o=Nt(e);I(o);let r=o;return r.id=t,r}function CS(e,t){let o={};for(let r in e){let n=e[r];if(!n)continue;let i=Nt(n);i&&(o[r]=i)}for(let r of t)for(let n in r){let i=e[n];if(I(i),i.type==="eventhandler")continue;let a=o[n];I(a,"Each control prop should have a corresponding reduced control prop");let s=r[n];I(s),It(a,s,i)}return o}function AS(e,t,o,r,n,i){let a=r.id;if(!a)return;let s=e.getNodeWithTrait(r.providerId,$e);if(!s)return;let l=s.dataIdentifier;if(!ue(l))return;let c=Le(e,l);if(!c)return;i??=Be(s,o);let d=e.getNodeWithTrait(i,he);if(!d)return;let u=Xt(e,o,a,d,c);u&&(d=u.collectionItemNode,c=u.collectionNode,a=u.variableId);let m=c.getPropertyControls(e,t)[a];if(!m)return;let g=c.getVariable(a);if(!g)return;let v=d.getControlProp(a),{controlProp:S,reducedControlProp:h}=mu(m,v);if(ia(S)&&(I(h,"Reduced control prop should not be null when a collection control prop is present"),c.id===d.parentid&&!(c.managedByPlugin&&!g.userEditable)&&g.type===n&&S.type===n))return{collectionNode:c,collectionItemNode:d,variableDefinition:g,controlDescription:m,rawControlProp:v,controlProp:S,reducedControlProp:h,variableId:a}}var Nl=new WeakMap;function mu(e,t){let o=Nl.get(e);if(o&&o.rawControlProp===t){let{controlProp:i,reducedControlProp:a}=o;return{controlProp:i,reducedControlProp:a}}let r=Cn(e,t),n=Nt(e);return n&&r&&It(n,r,e),Nl.set(e,{rawControlProp:t,controlProp:r,reducedControlProp:n}),{controlProp:r,reducedControlProp:n}}var po=dt(Mc(),1);function Tl(e){return e!=null&&typeof e=="object"&&e.nodeType===1}function Rl(e,t){return t&&e==="hidden"?!1:e!=="visible"&&e!=="clip"}function Tr(e,t){if(e.clientHeight<e.scrollHeight||e.clientWidth<e.scrollWidth){let o=getComputedStyle(e,null);return Rl(o.overflowY,t)||Rl(o.overflowX,t)}return!1}function co(e,t,o,r,n,i,a,s){return i<e&&a>t||i>e&&a<t?0:i<=e&&s<=o||a>=t&&s>=o?i-e-r:a>t&&s<o||i<e&&s>o?a-t+n:0}function Rr(e,t){let{scrollMode:o,block:r,inline:n,boundary:i,skipOverflowHiddenElements:a}=t,s=typeof i=="function"?i:k=>k!==i;if(!Tl(e))throw new TypeError("Invalid target");let l=document.scrollingElement||document.documentElement,c=[],d=e;for(;Tl(d)&&s(d);){if(d=d.parentNode,d===l){c.push(d);break}d===document.body&&Tr(d)&&!Tr(document.documentElement)||Tr(d,a)&&c.push(d)}let u=window.visualViewport,p=u?.width??innerWidth,m=u?.height??innerHeight,g=window.scrollX||pageXOffset,v=window.scrollY||pageYOffset,{height:S,width:h,top:f,right:y,bottom:x,left:b}=e.getBoundingClientRect(),C=r==="start"||r==="nearest"?f:r==="end"?x:f+S/2,w=n==="center"?b+h/2:n==="end"?y:b,R=[];for(let k of c){let{height:F,width:z,top:B,right:K,bottom:ne,left:ie}=k.getBoundingClientRect();if(o==="if-needed"&&f>=0&&b>=0&&x<=m&&y<=p&&f>=B&&x<=ne&&b>=ie&&y<=K)return R;let Ve=getComputedStyle(k),Oe=parseInt(Ve.borderLeftWidth,10),ce=parseInt(Ve.borderTopWidth,10),Ge=parseInt(Ve.borderRightWidth,10),Re=parseInt(Ve.borderBottomWidth,10),H=0,W=0,ze="offsetWidth"in k?k.offsetWidth-k.clientWidth-Oe-Ge:0,He="offsetHeight"in k?k.offsetHeight-k.clientHeight-ce-Re:0;if(l===k)r==="start"?H=C:r==="end"?H=C-m:r==="nearest"?H=co(v,v+m,m,ce,Re,v+C,v+C+S,S):H=C-m/2,n==="start"?W=w:n==="center"?W=w-p/2:n==="end"?W=w-p:W=co(g,g+p,p,Oe,Ge,g+w,g+w+h,h),H=Math.max(0,H+v),W=Math.max(0,W+g);else{r==="start"?H=C-B-ce:r==="end"?H=C-ne+Re+He:r==="nearest"?H=co(B,ne,F,ce,Re+He,C,C+S,S):H=C-(B+F/2)+He/2,n==="start"?W=w-ie-Oe:n==="center"?W=w-(ie+z/2)+ze/2:n==="end"?W=w-K+Ge+ze:W=co(ie,K,z,Oe,Ge+ze,w,w+h,h);let{scrollLeft:it,scrollTop:Me}=k;H=Math.max(0,Math.min(Me+H,k.scrollHeight-F+He)),W=Math.max(0,Math.min(it+W,k.scrollWidth-z+ze)),C+=Me-H,w+=it-W}R.push({el:k,top:H,left:W})}return R}function Ml(e){return e===Object(e)&&Object.keys(e).length!==0}function fu(e,t="auto"){let o="scrollBehavior"in document.body.style;e.forEach(({el:r,top:n,left:i})=>{r!==document.body&&(r.scroll&&o?r.scroll({top:n,left:i,behavior:t}):(r.scrollTop=n,r.scrollLeft=i))})}function hu(e){return e===!1?{block:"end",inline:"nearest"}:Ml(e)?e:{block:"start",inline:"nearest"}}function Mr(e,t){let o=!e.ownerDocument.documentElement.contains(e);if(Ml(t)&&typeof t.behavior=="function")return t.behavior(o?[]:Rr(e,t));if(o)return;let r=hu(t);return fu(Rr(e,r),r.behavior)}function VS(e,t){let o=(0,po.useRef)(null),r=typeof e=="function";if((0,po.useLayoutEffect)(()=>{t&&requestAnimationFrame(()=>{let n=r?o.current:e&&"current"in e?e.current:null;n&&Mr(n,{scrollMode:"if-needed",block:"center"})})},[t,r,e]),r)return n=>{o.current=n,e(n)}}var gu="codemark",Tt=100,kl=new Mn(gu);function oe(e,t){var o,r;return"schema"in e?(o=t?.markType)!==null&&o!==void 0?o:e.schema.marks.code:(r=t?.markType)!==null&&r!==void 0?r:e.state.schema.marks.code}function le(e,t){return e.resolve(Math.min(Math.max(1,t),e.nodeSize-2))}function Fl(e,t,o,r){var n;let i=e.isInSet((n=t.state.storedMarks)!==null&&n!==void 0?n:t.state.doc.resolve(o).marks()),a=t.state.doc.rangeHasMark(o,r,e);return!!(i||a)}var Pl={match:/`((?:[^`\w]|[\w])+)`$/,handler:(e,t,o,r,n,i,a,s)=>{if(Fl(e,t,n,i))return!1;let l=r[1],c=e.create(s),d=n+l.length,u=t.state.tr.delete(n,i).insertText(l).addMark(n,d,c),p=u.setSelection(Q.create(u.doc,d)).removeStoredMark(e),m=p.setMeta(a.input,{transform:p,from:n,to:i,text:`\`${l}${o}`});return t.dispatch(m),!0}},wl={match:/^`((?:[^`\w]|[\w])+)`/,handler:(e,t,o,r,n,i,a,s)=>{if(Fl(e,t,n,i))return!1;let l=e.create(s),c=r[1],d=n,u=t.state.tr.delete(n,i).insertText(c).addMark(n,n+c.length,l),p=u.setSelection(Q.create(u.doc,d)).addStoredMark(l),m=p.setMeta(a.input,{transform:p,from:n,to:i,text:`\`${c}${o}`});return t.dispatch(m),!0}};function yu(e,t,o,r,n,i,a){if(t.composing)return!1;let{state:s}=t,l=s.doc.resolve(o);if(l.parent.type.spec.code)return!1;let c="\uFFFC",d=l.parent.textBetween(Math.max(0,l.parentOffset-Tt),l.parentOffset,void 0,c)+n,u=n+l.parent.textBetween(l.parentOffset,Math.min(l.parent.nodeSize-2,l.parentOffset+Tt),void 0,c),p=Pl.match.exec(d),m=wl.match.exec(u);if(p){let g=Pl.handler(e,t,n,p,o-p[0].length+n.length,r,i,a);if(g)return g}return m?wl.handler(e,t,n,m,o,r+m[0].length-n.length,i,a):!1}function Dl(e,t){t||(t={});let o=new ve({isInputRules:!0,state:{init:()=>null,apply(r,n){let i=r.getMeta(o);return i||(r.selectionSet||r.docChanged?null:n)}},props:{handleTextInput(r,n,i,a){let s=oe(r,t);return yu(s,r,n,i,a,{input:o,cursor:e},t.attrs)}}});return o}function re(e,t,o="next"){let r={action:o};return e.dispatch(e.state.tr.setMeta(t,r)),!1}function Al(e,t,o,r,n){if(e.state.selection.empty||o.metaKey||o.shiftKey||o.altKey||o.ctrlKey)return!1;let{from:i,to:a}=e.state.selection;if(a-i>=Tt||e.state.doc.rangeHasMark(i,a,r))return!1;let s=e.state.tr.addMark(i,a,r.create(n)),l=s.setSelection(Q.create(s.doc,a)).removeStoredMark(r);return e.dispatch(l),!0}function xu(e,t,o,r,n){var i;if(o.metaKey)return re(e,t);if(o.shiftKey||o.altKey||o.ctrlKey)return!1;let{selection:a,doc:s}=e.state;if(!a.empty)return!1;let l=t.getState(e.state),c=a.$from,d=!!r.isInSet(c.marks()),u=!!r.isInSet((i=c.marksAcross(le(s,a.from+1)))!==null&&i!==void 0?i:[]);return c.pos===e.state.doc.nodeSize-3&&c.parentOffset===c.parent.nodeSize-2&&l?.active?(e.dispatch(e.state.tr.removeStoredMark(r)),!0):d===u&&c.parentOffset!==0?!1:d&&(!l?.active||l.side===-1)&&c.parentOffset!==0?(e.dispatch(e.state.tr.removeStoredMark(r)),!0):u&&l?.side===-1?(e.dispatch(e.state.tr.addStoredMark(r.create(n))),!0):!1}function Ll(e,t,o,r,n){if(xu(e,t,o,r,n))return!0;let{selection:a}=e.state,s=a.$from;return a.empty&&s.parentOffset===s.parent.nodeSize-2?re(e,t):!1}function vu(e,t,o,r,n){var i;if(o.metaKey)return re(e,t);if(o.shiftKey||o.altKey||o.ctrlKey)return!1;let{selection:a,doc:s}=e.state,l=t.getState(e.state),c=!!r.isInSet(a.$from.marks()),d=!!r.isInSet((i=le(s,a.empty?a.from-1:a.from+1).marks())!==null&&i!==void 0?i:[]);if(c&&l?.side===-1&&a.$from.parentOffset===0)return!1;if(l?.side===0&&a.$from.parentOffset===0)return e.dispatch(e.state.tr.removeStoredMark(r)),!0;if(c&&d&&l?.side===0)return e.dispatch(e.state.tr.addStoredMark(r.create(n))),!0;if(c&&!d&&l?.active&&a.$from.parentOffset===0||!c&&l?.active&&l?.side===0)return e.dispatch(e.state.tr.removeStoredMark(r)),!0;if(c===d)return!1;if(d||!a.empty&&c){let u=a.empty?a.from-1:a.from,p=e.state.tr.setSelection(Q.create(s,u));return!a.empty&&d?e.dispatch(p.addStoredMark(r.create(n))):e.dispatch(p.removeStoredMark(r)),!0}if((d||!a.empty&&c)&&!l?.active){let u=a.empty?a.from-1:a.from;return e.dispatch(e.state.tr.setSelection(Q.create(s,u)).removeStoredMark(r)),!0}if(c&&!l?.active&&a.$from.parentOffset>0)return e.dispatch(e.state.tr.setSelection(Q.create(s,a.from-1)).addStoredMark(r.create(n))),!0;if(c&&!d&&l?.active&&l.side!==-1)return e.dispatch(e.state.tr.addStoredMark(r.create(n))),!0;if(c&&!d&&l?.active){let u=a.from-1;return e.dispatch(e.state.tr.setSelection(Q.create(s,u)).addStoredMark(r.create(n))),!0}return!1}function Bl(e,t,o,r,n){if(vu(e,t,o,r,n))return!0;let{selection:a}=e.state,s=a.$from,l=t.getState(e.state);return s.pos===1&&s.parentOffset===0&&l?.side===-1?!0:a.empty&&s.parentOffset===0?re(e,t):!1}function El(e,t,o,r){if(o.metaKey||o.shiftKey||o.altKey||o.ctrlKey)return!1;let{selection:n,doc:i}=e.state,a=le(i,n.from-1),s=!!r.isInSet(a.marks()),l=a.parentOffset===0,c=!!r.isInSet(le(i,n.to+1).marks());if((!s||l)&&!c)return re(e,t);let d=t.getState(e.state);if(n.empty&&d?.side===-1){let u=e.state.tr.delete(n.from-1,n.from);return e.dispatch(u),!0}return!1}function Vl(e,t,o,r){if(o.metaKey||o.shiftKey||o.altKey||o.ctrlKey)return!1;let{selection:n,doc:i}=e.state,a=!!r.isInSet(n.$from.marks()),s=n.$from.parentOffset===0,l=!!r.isInSet(le(i,n.to+2).marks());return(!a||s)&&!l?re(e,t):!1}function Ol(e,t){var o,r;if(!e)return null;let{selection:n,doc:i}=e;if(!n.empty)return null;let a=!!t.isInSet((o=e.storedMarks)!==null&&o!==void 0?o:[]),s=!!t.isInSet(n.$from.marks()),l=!!t.isInSet((r=le(i,n.from+1).marks())!==null&&r!==void 0?r:[]),c=n.$from.parentOffset===0;return s!==l||!s&&a!==s||s&&c?e.tr.removeStoredMark(t):null}function Su(){let e=document.createElement("span");return e.classList.add("fake-cursor"),e}function bu(e){e||(e={});let t=new ve({key:kl,appendTransaction:(o,r,n)=>{var i;let a=t.getState(r),s=(i=o[0])===null||i===void 0?void 0:i.getMeta(t);return a?.next||s?.action==="click"?Ol(n,oe(n,e)):null},state:{init:()=>null,apply(o,r,n,i){var a;let s=o.getMeta(t);if(s?.action==="next")return{next:!0};let l=oe(i,e),c=l.isInSet((a=i.storedMarks)!==null&&a!==void 0?a:i.doc.resolve(o.selection.from).marks()),d=l.isInSet(i.doc.resolve(o.selection.from).marks()),u=l.isInSet(le(i.doc,o.selection.from+1).marks()),p=o.selection.$from.parentOffset===0;return o.selection.empty?!c&&u&&(!d||p)?{active:!0,side:-1}:c&&(!d||p)?{active:!0,side:0}:!c&&d&&!u?{active:!0,side:0}:c&&d&&!u?{active:!0,side:-1}:null:null}},props:{attributes:o=>{var r;let{active:n=!1}=(r=t.getState(o))!==null&&r!==void 0?r:{};return Object.assign({},n?{class:"no-cursor"}:{})},decorations:o=>{var r;let{active:n,side:i}=(r=t.getState(o))!==null&&r!==void 0?r:{};if(!n)return Go.empty;let a=Ln.widget(o.selection.from,Su,{side:i});return Go.create(o.doc,[a])},handleKeyDown(o,r){switch(r.key){case"`":return Al(o,t,r,oe(o,e),e.attrs);case"ArrowRight":return Ll(o,t,r,oe(o,e),e.attrs);case"ArrowLeft":return Bl(o,t,r,oe(o,e),e.attrs);case"Backspace":return El(o,t,r,oe(o,e));case"Delete":return Vl(o,t,r,oe(o,e));case"ArrowUp":case"ArrowDown":case"Home":case"End":return re(o,t);case"e":case"a":return r.ctrlKey?re(o,t):!1;default:return!1}},handleClick(o){return re(o,t,"click")}}});return t}function Gl(e){let t=bu(e),o=Dl(t,e);return[t,o]}var eb=Gl;var lb=e=>(t,o)=>{if(!o)return!1;let r=t.selection,n=r.$from.node(1);if(!_(n)||!gt(n)||r.$to.parentOffset===r.$to.parent.content.size)return!1;let a=n.attrs.tag;return a==="p"||a==="div"?!1:zl(e)(t,o)},cb=e=>(t,o)=>{if(!o)return!1;let n=t.selection.$from.node(1);if(!_(n)||gt(n))return!1;let i=n.attrs.tag;return i==="p"||i==="div"?!1:zl(e)(t,o)},zl=e=>(t,o)=>{if(!o)return!1;let r=e.nodes.lineBreak.create(),n=t.tr.replaceSelectionWith(r).scrollIntoView();return o(n),!0},db=e=>(t,o)=>{let r=t.selection;if(r.from!==r.to)return!1;let n=r.$from.node(-1);return!kn(n)||wn(r.$from.node(-3))||r.$from.parentOffset!==0||r.$from.index(-1)!==0||r.$from.index(-2)!==0?!1:aa(e.nodes.listItem)(t,o&&(i=>{if(r.$from.depth>3){let a=r.$from.before(-1);i.join(a)}o(i)}))};function mb(e){return ar(/^([ai]|\d+)\.\s$/iu,e.nodes.numberedList,t=>{let o=t[1];switch(o){case"a":return{listStyleType:"lower-alpha"};case"A":return{listStyleType:"upper-alpha"};case"i":return{listStyleType:"lower-roman"};case"I":return{listStyleType:"upper-roman"};default:return{start:Number(o)}}},(t,o)=>o.childCount+o.attrs.start===Number(t[1]))}function fb(e){return ar(/^\s*([-+*])\s$/u,e.nodes.bulletedList)}function Cb(){return new ve({appendTransaction(e,t,o){let r,n=o.selection.$from.parent;if(t.selection instanceof Ae&&e.find(a=>a.steps.find(s=>s instanceof Nn))){let a=t.doc.firstChild,s=_(n)&&!gt(n);if(a&&_(a)&&s){let l=Cu(a);if(r??=o.tr,l){let c=l.marks.find(Ut);r.setNodeMarkup(0,a.type,{...a.attrs,inlineStyles:c?.attrs.inlineStyles??{}});for(let d of l.marks)r.addMark(0,o.doc.content.size,d),r.addStoredMark(d)}else{let c=a.attrs.inlineStyles;r.setNodeMarkup(0,a.type,{...a.attrs,inlineStyles:c})}}}return r}})}function Cu(e){for(let t=0;t<e.childCount;t++){let o=e.child(t);if(Pn(o))return o}}function Mb(e,t){let o=t.getFontsForLoading().filter(i=>!To.isSelectorLoaded(i)),r=t.getTextStylePresets(!1).filter(cn),n=e.getNodesWithTrait(r,Qr).filter(i=>!To.isSelectorLoaded(i.font)).map(i=>i.font);return o.push(...n),o}var Hl=[te.youtube,te.vimeo,te.codeblock,te.twitter];async function Wl(e,t){let o=me(t);je(o)&&await e.stores.modulesStore.addExternalModulesToProject([o],{onTreeUpdate(){}})}var jl=new WeakMap;async function Lb(e){let{modules:t}=await e.stores.modulesStore.lookUpModules(Hl.map(An)),o=[];for(let r=0;r<t.length;r++){let n=t[r];I(n,"Module must exist");let i=Hl[r];I(i,"Module component must exist"),jl.set(i,n),I(n.files.module,"Module must have a module file"),o.push(bo(n.id,n.saveId,n.files.module,i.exportSpecifier??"default"))}await e.stores.modulesStore.preloadExternalModules(o)}function Rt(e,t){let o=jl.get(t);I(o,"Preloaded module must exist");let r=e.getNodeWithTrait(o.id,Fo);return r?r.codeComponentIdentifier:(I(o.files.module,"Module must have a module file"),bo(o.id,o.saveId,o.files.module,t.exportSpecifier??"default").value)}async function Ul(e,t){let{moduleIdentifier:o}=await ha(e,t);if(o.kind==="externalModuleExport"){let r=e.tree.getNodeWithTrait(o.moduleId,Fo);if(r)return r.codeComponentIdentifier}return o.value}async function Ee(e,t,o,r,n={}){await Wl(e,r);let i=o.state,a=i.tr;a.replaceRangeWith(i.selection.from,i.selection.to,t.nodes.module.create({identifier:r,props:n}));let s=i.selection.from===0?0:i.selection.from-1;a.setSelection(Rn.create(a.doc,s)),o.dispatch(a)}async function $l(e,t,o,r,n){let i=await Ul(e,r);await Ee(e,t,o,i,n)}async function Yl(e,t,o,r,n){be("collection_record_youtube_add",{source:"cms"});let i=n?{url:{type:"string",value:n}}:void 0;try{let a=Rt(e.tree,te.youtube);await Ee(e,t,o,a,i),r?.()}catch(a){E(a)}}async function Ub(e,t,o,r,n){let i=n?{url:{type:"string",value:n}}:void 0;try{let a=Rt(e.tree,te.twitter);await Ee(e,t,o,a,i),r?.()}catch(a){E(a)}}async function ql(e,t,o,r,n){be("collection_record_vimeo_add",{source:"cms"});let i=n?{video:{type:"string",value:n}}:void 0;try{let a=Rt(e.tree,te.vimeo);await Ee(e,t,o,a,i),r?.()}catch(a){E(a)}}async function $b(e,t,o,r="",n){let i={code:{type:"string",value:r}};be("collection_record_codeblock_add",{source:"cms"});try{let a=Rt(e.tree,te.codeblock);await Ee(e,t,o,a,i),n?.()}catch(a){E(a)}}function Xl(e,t,o,r,n){return r.content.size===0?!1:(e.scheduler.processWhenReady(()=>{let i=t.state,a=i.tr,s=n(r),l=Iu(s),c=i.selection.$from.node(1),d=i.selection.$from.before(1),u=!s.content.child(0).isInline,p=i.selection instanceof Ae||c?.content.size===0;if(l)a.replaceSelectionWith(l,!0);else if(u&&p){let m=c?d+c.nodeSize:i.selection.to;a.replaceRange(d,m,s)}else a.replaceSelection(s);a.scrollIntoView(),a.setMeta("paste",!0),a.setMeta("uiEvent","paste"),t.dispatch(a)}),!0)}function Iu(e){return e.openStart===0&&e.openEnd===0&&e.content.childCount===1?e.content.firstChild:null}var Nu=pe("prosemirror:addMedia"),Kl=[{extension:"mp4",mimeType:"video/mp4"}];function _l(e){return e=e.toLowerCase(),Kl.some(({extension:t})=>e.endsWith(`.${t}`))}function Tu(e){return e.startsWith("video/")}var Zl=[...Qt],Ql=new Set(Jt);for(let{extension:e,mimeType:t}of Kl)Zl.push(e),Ql.add(t);var Ru="failed-asset-upload-placeholder",Jl="updateAssetReferences";function oC(e){return e.getMeta(Jl)}function Mu(e){return e.setMeta(Jl,!0)}async function uo(e,t,o,r,{type:n,insertPosition:i,mediaExtractedFromHTML:a}){let s=o.state,l=s.tr,c=new et(e,{silent:a}),d=[],u=[],p=[];for(let f of r)if(f instanceof File){let y=Tu(f.type);if(I(!a,"we should not receive files if the media is already in a document"),!Ql.has(f.type))continue;let x=URL.createObjectURL(f);d.push({uploadResultTask:c.createTask(f,b=>b),temporaryURL:x,type:y?"video":"image"}),u.push({src:x,isVideo:y}),p.push(x)}else{let y=yn(f.src);if(y){u.push({src:f.src,isVideo:_l(y.originalFilename??y.identifier)});continue}u.push({src:f.src,isVideo:_l(f.src)}),d.push({uploadResultTask:c.createTask(f.src,x=>x),temporaryURL:f.src,type:f.type})}if(!d.length)return Promise.resolve();if(!a)for(let{src:f,isVideo:y}of u){let x=t.nodes.image.create({src:f,type:y?"video":"image"});i?l.insert(i,x):s.selection.replaceWith(l,x)}l.scrollIntoView(),(n==="drop"||n==="paste")&&(l.setMeta(n,!0),l.setMeta("uiEvent",n)),o.dispatch(l);let m=d.map(f=>f.uploadResultTask());a&&vr(c,m).catch(()=>{});let v=(await Promise.allSettled(m)).map((f,y)=>ku(f,y,d)),S=[];v.forEach(f=>{if(f.type==="asset")return S.push(f.asset)});let h=new Map;d.forEach((f,y)=>{let x=v[y];I(x,"Asset upload result must be defined"),h.set(f.temporaryURL,x)}),Pu(o,h),p.forEach(f=>URL.revokeObjectURL(f))}function ku(e,t,o){switch(e.status){case"fulfilled":{let{value:r}=e,{asset:n}=r;return r.type==="image"?{type:"asset",asset:n,imageSize:r.imageSize}:{type:"asset",asset:n}}case"rejected":{let r=o[t];return I(r,"Upload must be defined"),Nu.reportError(new Error(e.reason)),{type:"failed upload"}}}}async function rC(e,t,o,r){let n=await dl.pickFile({allowedFileTypes:Zl});if(!n)return;let i=n[0];return uo(e,t,o,[i],r)}function Pu(e,t){let o=e.state,r=o.tr;o.doc.descendants((n,i)=>{if(!$t(n))return;let a=t.get(n.attrs.src);if(a===void 0)return;let s={...n.attrs};if(a.type==="failed upload")s.src=Ru;else if(a.imageSize){s.src=gn({identifier:No(a.asset),intrinsicSize:{width:a.imageSize.naturalWidth,height:a.imageSize.naturalHeight}});let l=_i(a.imageSize);s.pixelWidth=l.nonZeroNaturalWidth,s.pixelHeight=l.nonZeroNaturalHeight}else s.src=hn(No(a.asset));r.setNodeMarkup(i,n.type,s),Mu(r)}),e.dispatch(r)}function tc(e){let t=e.querySelector("b[id^='docs-internal-guid']")??e.querySelector("*[id^='docs-internal-guid']")?.parentElement;if(t)for(let o=t.children.length-1;o>=0;o--){let r=t.children[o];if(r){for(r instanceof HTMLDivElement&&wu(r);ec(r.firstChild);)r.removeChild(r.firstChild);for(;ec(r.lastChild);)r.removeChild(r.lastChild);(r.tagName==="BR"||r.childNodes.length===0)&&r.remove()}}}function ec(e){return e instanceof Element&&e.textContent===""&&e.querySelectorAll("img").length===0}function wu(e){let t=e.querySelector("table");t===null||t.querySelectorAll("tr").length===0||t.querySelectorAll("th, td").length===0||e.replaceWith(t)}var mo=class extends jt{constructor(o,r,n){let i=jt.nodesFromSchema(r),a=jt.marksFromSchema(r),s={},l={};for(let[c,d]of Object.entries(i))s[c]=(...u)=>d(...u,o);for(let[c,d]of Object.entries(a))l[c]=(...u)=>d(...u,o);super(s,l);this.onAfterSerializeFragment=n}serializeFragment(o,r,n=document.createDocumentFragment()){return super.serializeFragment(o,r,n),this.onAfterSerializeFragment?.(n),n}};var Fu=/^https?:\/\/(?:www\.)?vimeo\.com\/\d+/u,Du=/^https?:\/\/(?:www\.)?youtu(?:\.be|be\.com)/u;function oc({engine:e,schema:t,stylePresetGetters:o,supportedTags:r,saveChanges:n}){return new ve({props:{clipboardSerializer:new mo(e,t,o?Bu:void 0),transformPastedHTML(i){let a=Ci(i);return tc(a),a.innerHTML},handlePaste(i,a,s){let l=a.clipboardData?.getData("text/plain"),c=a.clipboardData?.getData("text/html");if(zo(t)){let{clipboardData:d}=a;if(d&&d.files.length>0)return uo(e,t,i,d.files,{type:"paste"}).finally(n),!0}if(ut(l)){let u=["http:","https:","mailto:","www."].some(m=>l.startsWith(m)),p=i.state.selection;if(u&&p.from!==p.to&&Bn(t)){let m=Vo(l,e)??ln({url:l}),g=i.state.tr;return g.addMark(p.from,p.to,t.marks.link.create({link:m,openInNewTab:hi(m),smoothScroll:!1,clickTrackingId:void 0,linkStylePreset:void 0,relValues:void 0,preserveParams:!1})),i.dispatch(g),!0}if(Ho(t)&&Z.isOn("cmsPasteModules")){let m=me(l);if(wt(m))return Ee(e,t,i,m.value).catch(E),!0;if(yi(l))return $l(e,t,i,l).catch(E),!0}if(Ho(t)){if(Du.test(l))return Yl(e,t,i,n,l).catch(E),!0;if(Fu.test(l))return ql(e,t,i,n,l).catch(E),!0}}return Xl(e,i,a,s,d=>{if(o&&c&&Lu(c))return d;let u=ga(l);l&&u&&!c&&(d=ya(l,t));let p=t.nodes.document.create(void 0),m=new Tn(p);m.insert(0,d.content);let g=new Map,v=[];if(m.doc.descendants((h,f)=>{if(_(h)){let y=h.attrs.tag,x=r?.has(y)??!0,b=qo(y)&&x?y:"p";m.setNodeMarkup(f,t.nodes.textBlock,{...h.attrs,blockStyles:{},inlineStyles:{},textStylePreset:void 0,tag:b})}$t(h)&&v.push({src:h.attrs.src,type:h.attrs.type});for(let y of h.marks){if(!Oo(y)||!sn(y.attrs.link))continue;let x=y.attrs.link.url,b;g.has(x)?b=g.get(x):(b=Vo(x,e),g.set(x,b)),b&&m.addMark(f,f+h.nodeSize,y.type.create({...y.attrs,link:b}))}}),v.length&&zo(t)&&uo(e,t,i,v,{type:"paste",mediaExtractedFromHTML:!0}).finally(n),En(t)&&o){let f=i.state.selection,x=f.$from.parent,b=x.textContent,C=_(x)&&b.length>0,w=f instanceof Ae,k=!c&&l&&l.length>0&&!u;!C&&!k&&!w?Eu(e,t,o.getStylePresetForTag,o.getStylePresetForLink,m):Vu(i,t,m)}let S=d.content.child(0).isInline?m.doc.content.child(0).content:m.doc.content;return new In(S,d.openStart,d.openEnd)})}}})}var rc="framer-match-formatting",Au=document.createComment(rc);function Lu(e){return e.endsWith(`<!--${rc}-->`)}function Bu(e){e.appendChild(Au)}function Eu(e,t,o,r,n){n.doc.descendants((i,a)=>{if(_(i)){let s=i.attrs,l=ut(s.textStylePreset)?e.tree.getNodeWithTrait(s.textStylePreset,zt):void 0,c=qo(s.tag)?s.tag:"p",d=l??o(c)??Ai(e.tree,c)??si.createDefault(c);Li(e,d),n.setNodeMarkup(a,t.nodes.textBlock,{...i.attrs,blockStyles:l?i.attrs.blockStyles:{},inlineStyles:l?i.attrs.inlineStyles:{},textStylePreset:d.id}),l||n.removeMark(a,i.nodeSize,t.marks.inlineStyles)}if(i.type===t.nodes.text){let s=i.marks.find(Oo);if(s){let l=r()??Fi(e.tree)??wi.createDefault();Di(e,l),n.addMark(a,a+i.nodeSize,s.type.create({...s.attrs,linkStylePreset:l.id}))}}})}function Vu(e,t,o){let r=e.state,n=r.selection;if(n instanceof Ae){let c=r.doc.resolve(1);n=new Q(c)}let i=n.$from.parent,a=_(i),l=n.$from.marks().find(Ut);if(l)o.addMark(0,o.doc.content.size,l);else if(a){let c=t.marks.inlineStyles.create({inlineStyles:i.attrs.inlineStyles});o.addMark(0,o.doc.content.size,c)}else o.removeMark(0,o.doc.content.size,t.marks.inlineStyles);o.doc.descendants((c,d)=>{if(!_(c))return;let u=a?i.attrs:c.attrs;o.setNodeMarkup(d,t.nodes.textBlock,u)})}function GC({engine:e,schema:t,nodeId:o,getRichTextNode:r}){return oc({engine:e,schema:t,stylePresetGetters:{getStylePresetForTag:n=>{let i=r();if(i)return Ou(e.tree,i,n)??i.getNodeTextStylePreset(e.tree,n)??void 0},getStylePresetForLink:()=>r()?.getNodeLinkStylePreset(e.tree)??void 0}})}function Ou(e,t,o){for(let r of t.getTextStylePresets(!1)){let n=e.getNodeWithTrait(r,zt);if(n&&n.tag===o)return n}}var nc={floatingWindowRadius:18,panelPadding:10,panelTitleIndentation:5,sitesPanelHeaderHeight:50,webBarHeight:50,popoverRadius:18,popoverGap:10,popoverHeaderHeight:30,popoverWidth:300,saveButtonWidth:53,modalPadding:10,modalVerticalGap:10,modalElementGap:10,modalRadius:18,modalInnerRadius:8,modalHeaderHeight:50,modalWidth:260,largeModalWidth:320};var Gu=["RGB","HSL","HEX","P3"];function WC(e){return Gu.some(t=>t===e)}function $C(e,t){let o=new Set,r=new Set;for(let n of t){if(r.has(n))continue;let i=e.get(n);if(i){if(Uo(i)){o.add(n);continue}for(let a of i.ancestors())if(!r.has(a.id)&&(r.add(a.id),a.cache.reset(),!!Uo(a))){o.add(a.id);break}}}return o}function zu(e){let t=Mo.isP3String(e)?zr.fromString(e):Mo(e);if(t)return t.r*.299+t.g*.587+t.b*.114+(1-t.a)*255}function _C(e){let t=zu(e);if(j(t))return t>128?"light":"dark"}function eI(e,t,o,r="default"){if(!t.fallback)return;let n=new Set;n.add(t.id);let i=t.fallback;for(;i;){if(n.has(i))return;n.add(i);let a=o.find(({id:c})=>c===i);if(!a)return;let s=e.localizedValues;r==="imageSrc"&&(I(ra(e)),s=e.imageLocalizedValues);let l=s?.[i];if(l&&an(l))return l;i=a.fallback}}var lm={};Rc(lm,{amethyst:()=>Wu,aquaBlue:()=>ju,atomDark:()=>Uu,atomLight:()=>$u,ayuDark:()=>Yu,ayuLight:()=>qu,cmsTheme:()=>Hu,cobalt2:()=>Xu,cyberpunk:()=>_u,dracula:()=>Ku,framerDark:()=>Mt,framerLight:()=>Zu,freeCodeCamp:()=>Qu,githubDark:()=>Ju,githubLight:()=>em,levelUp:()=>tm,magic:()=>rm,monokaiPro:()=>om,neoCyan:()=>nm,nightOwl:()=>im,sandpackDark:()=>am,sandpackLight:()=>sm});var Hu={colors:{surface1:U.cmsCodeBlockSurface1,surface3:U.cmsCodeBlockSurface3,disabled:U.cmsCodeBlockDisabled,accent:U.cmsCodeBlockAccent,errorSurface:U.cmsCodeBlockErrorSurface},syntax:{plain:U.cmsCodeBlockPlain,comment:U.cmsCodeBlockComment,keyword:U.cmsCodeBlockKeyword,tag:U.cmsCodeBlockTag,punctuation:U.cmsCodeBlockPunctuation,definition:U.cmsCodeBlockDefinition,property:U.cmsCodeBlockProperty,static:U.cmsCodeBlockStatic,string:U.cmsCodeBlockString},font:{mono:qn.family.monospace,lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Wu={colors:{surface1:"#000000",surface3:"#3b3b4f",disabled:"#858591",accent:"#a26cd6",errorSurface:"#3b3b4f"},syntax:{plain:"#ffffff",comment:"#858591",keyword:"#a26cdd",tag:"#f07178",punctuation:"#99c9ff",definition:"#ffffff",property:"#99c9ff",static:"#f78c6c",string:"#57d1b7"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"18px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},ju={colors:{surface1:"#f8f9fb",surface3:"#e4e7eb",disabled:"#C5C5C5",accent:"#2e7692"},syntax:{plain:"#1F2933",comment:"#A7B6C2",keyword:"#1A56DB",tag:"#1A56DB",punctuation:"#394b59",definition:"#A23DAD",property:"#2e7692",static:"#1A56DB",string:"#1992D4"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Uu={colors:{surface1:"#282c34",surface3:"#2c313c",disabled:"#4d4d4d",accent:"#c678dd",errorSurface:"#ffeceb"},syntax:{plain:"#a8b1c2",comment:"#757575",keyword:"#c678dd",tag:"#e06c75",punctuation:"#a8b1c2",definition:"#62aeef",property:"#d19a66",static:"#a8b1c2",string:"#98c379"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},$u={colors:{surface1:"#fafafa"},syntax:{plain:"#383a42",comment:"#a0a1a7",keyword:"#a626a4",tag:"#e45649",punctuation:"#383a42",definition:"#c18401",property:"#4078f2",static:"#986801",string:"#50a14f"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Yu={colors:{surface1:"#0c1017"},syntax:{comment:"#646a72",definition:"#5ac2ff",keyword:"#ff9040",plain:"#bfbdb6",property:"#ffb454",punctuation:"#bfbdb6",static:"#d2a6ff",string:"#80d962",tag:"#3bbae7"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},qu={colors:{surface1:"#fafafa"},syntax:{comment:"#aaaeb1",definition:"#3b9ee6",keyword:"#fa8e3e",plain:"#5c6166",property:"#f2ae49",punctuation:"#5c6167",static:"#a37acc",string:"#87b300",tag:"#56b4d5"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Xu={colors:{surface1:"#193549",surface3:"#1f4662",disabled:"#C5C5C5",accent:"#ffc600",errorSurface:"#0d3a58"},syntax:{plain:"#ffffff",comment:"#0088ff",keyword:"#ff9d00",tag:"#9effff",punctuation:"#e1efff",definition:"#ffc600",property:"#ffc600",static:"#ffee80",string:"#a5ff90"},font:{mono:'"Operator Mono", "Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},_u={colors:{surface1:"#051c30",surface3:"#042f40",disabled:"#C5C5C5",accent:"#fdf500",errorSurface:"#051c30"},syntax:{plain:"#ffffff",comment:"#1ac5b0",keyword:"#fdf500",tag:"#ffc600",punctuation:"#afd7fa",definition:"#ffc600",property:"#fdf500",static:"#e455ae",string:"#37ebf3"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Ku={colors:{surface1:"#282a36",surface3:"#44475a",disabled:"#6272a4",accent:"#bd93f9",errorSurface:"#44475a"},syntax:{plain:"#f8f8f2",comment:"#6272a4",keyword:"#ff79c6",tag:"#ff79c6",punctuation:"#ff79c6",definition:"#f8f8f2",property:"#50fa7b",static:"#bd93f9",string:"#f1fa8c"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Mt={colors:{surface1:"#161820",surface3:"#2f2f2f",disabled:"#4d4d4d",accent:"#0099ff",errorSurface:"#ffe0e8"},syntax:{plain:"#eeeeee",comment:"#666666",keyword:"#00BBFF",tag:"#00BBFF",punctuation:"#999999",definition:"#ffcc66",property:"#77dddd",static:"#ff8866",string:"#bb88ff"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Zu={colors:{surface1:"#fafafa",surface3:"#f3f3f3",disabled:"#c5c5c5",accent:"#0099ff",errorSurface:"#ffe0e8"},syntax:{plain:"#666666",comment:"#bbbbbb",keyword:"#0099ff",tag:"#0099ff",punctuation:"#bbbbbb",definition:"#FFAA00",property:"#33cccc",static:"#ff8866",string:"#8855ff"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Qu={colors:{surface1:"#2a2a40",surface3:"#3b3b4f",disabled:"#858591",accent:"#dbb8ff",errorSurface:"#3b3b4f"},syntax:{plain:"#ffffff",comment:"#858591",keyword:"#dbb8ff",tag:"#f07178",punctuation:"#99c9ff",definition:"#ffffff",property:"#99c9ff",static:"#f78c6c",string:"#acd157"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},Ju={colors:{surface1:"#0d1117",surface3:Mt.colors?.surface3,disabled:Mt.colors?.disabled,accent:Mt.colors?.accent,errorSurface:Mt.colors?.errorSurface},syntax:{comment:"#8b949e",definition:"#d2a8ff",keyword:"#ff7b72",plain:"#e6edf3",property:"#79c0ff",punctuation:"#e6edf3",static:"#7ee787",string:"#a5d6ff",tag:"#7ee787"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},em={colors:{surface1:"#ffffff",surface3:"#f5f5f5",disabled:"#d1d4d8",accent:"#24292e"},syntax:{keyword:"#d73a49",property:"#005cc5",plain:"#24292e",static:"#032f62",string:"#032f62",definition:"#6f42c1",punctuation:"#24292e",tag:"#22863a",comment:"#6a737d"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"normal",property:"normal",keyword:"normal"}},tm={colors:{surface1:"#191324",surface3:"#524763",disabled:"#aaaaaa",accent:"#82d8d8",errorSurface:"#191324"},syntax:{plain:"#ffffff",comment:"#82d8d8",keyword:"#e54b4b",tag:"#ff26be",punctuation:"#9588aa",definition:"#82d8d8",property:"#82d8d8",static:"#82d8d8",string:"#a8fe39"},font:{mono:'"MonoLisa", "Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},om={colors:{surface1:"#2D2A2E",surface3:"#484747",disabled:"#444344",accent:"#FFD866",errorSurface:"#c24038"},syntax:{plain:"rgb(252, 252, 250)",comment:"#757575",keyword:"rgb(255, 97, 136)",tag:"rgb(120, 220, 232)",punctuation:"rgb(147, 146, 147)",definition:"rgb(169, 220, 118)",property:"rgb(120, 220, 232)",static:"rgb(171, 157, 242)",string:"rgb(255, 216, 102)"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"italic",keyword:"normal"}},rm={colors:{surface1:"#f6f6f8",surface3:"#f6f6f8",disabled:"#C5C5C5",accent:"#ffa600",errorSurface:"#ffeceb"},syntax:{plain:"#151515",comment:"#cacacd",keyword:"#ffa600",tag:"#ff9a4d",punctuation:"#ffb3b3",definition:"#ff6f00",property:"#9900ff",static:"#FF453A",string:"#f53524"},font:{mono:'"Roboto Mono", monospace',lineHeight:"24px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},nm={colors:{surface1:"#2b3935",surface3:"#524763",disabled:"#aaaaaa",accent:"#82d8d8",errorSurface:"#191324"},syntax:{plain:"#ffffff",comment:"#82d8d8",keyword:"#e54b4b",tag:"#ff26be",punctuation:"#9588aa",definition:"#82d8d8",property:"#82d8d8",static:"#82d8d8",string:"#a8fe39"},font:{mono:'"MonoLisa", "Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"18px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},im={colors:{surface1:"#011627",surface3:"#112331",disabled:"#4D4D4D",accent:"#c5e4fd",errorSurface:"#811e18"},syntax:{plain:"#d6deeb",comment:"#999999",keyword:"#c792ea",tag:"#7fdbca",punctuation:"#7fdbca",definition:"#82aaff",property:"#addb67",static:"#f78c6c",string:"#ecc48d"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"italic",keyword:"italic"}},am={colors:{surface1:"#151515",surface3:"#2F2F2F",disabled:"#4D4D4D",accent:"#90e86f",errorSurface:"#b08df8"},syntax:{plain:"#f0fdaf",comment:"#757575",keyword:"#e5fd78",tag:"#f0fdaf",punctuation:"#ffffff",definition:"#eeeeee",property:"#90e86f",static:"#ffffff",string:"#dafecf"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}},sm={colors:{surface1:"#ffffff",surface3:"#F3F3F3",disabled:"#C5C5C5",accent:"#3973E0",errorSurface:"#FCF1F0"},syntax:{plain:"#151515",comment:"#999",keyword:"#7C5AE3",tag:"#0971F1",punctuation:"#3B3B3B",definition:"#85A600",property:"#3B3B3B",static:"#3B3B3B",string:"#2E6BD0"},font:{mono:'"Fira Mono", "DejaVu Sans Mono", Menlo, Consolas, "Liberation Mono", Monaco, "Lucida Console", monospace',lineHeight:"20px"},fontStyle:{comment:"italic",property:"normal",keyword:"normal"}};function uI(e,t){let{scopeStore:o,treeStore:r}=t.stores,n=[],i=r.tree.root.locales;if(!i||i.length===0)return n;let a=o.active,s=oa(a),l=!1;if(s){let d=n.length;rr(r.tree,t.componentLoader,a,e,i,n,"canvasHtmlAsTextContentIfPossible"),l=n.length>d}if(he(e)){let d=r.tree.getNodeWithTrait(e.parentid,_r);if(!d)return n;let u=ir(i,d);nr(r.tree,d,e,i,n,u)}let c=new Set;if(Pi(r.tree,e,"excludeInherited","readsRawNodeData",void 0,d=>{if(!d.providerId)return;let u=r.tree.get(d.providerId);if(!$e(u)||!Wt(u))return;let p=Le(r.tree,u.dataIdentifier);if(!p)return;let m=Be(u,r.sandboxRepeaterData),g=r.tree.get(m);if(!he(g))return;let v=na(g.id,d.id);if(c.has(v))return;let S=ir(i,p),h=[];nr(r.tree,p,g,i,h,S);let f=h.find(({keyPath:y})=>y===v);f&&n.push(f)}),!l&&s&&qe(e)){let d=r.tree.getNode(e.getPrimaryId());d&&rr(r.tree,t.componentLoader,a,d,i,n,"canvasHtmlAsTextContentIfPossible")}return n}async function gI(e){let t=dr.on(Br).expect();return new Promise(o=>{Eo(e)&&e.stores.canvasStore.setColorSamplerActive(!0),e.scheduler.runBeforeNextFrame(async()=>{let{color:r}=await t.sampleColor();e.scheduler.process(()=>{Eo(e)&&e.stores.canvasStore.setColorSamplerActive(!1),o(r)})})})}function PI(e,t,o){return ii(o)?um(e,t,o):ai(o)?pm(e,t,o):ni(o)?mm(e,t,o):null}function cm(e,t){return P(t*Math.sin(Ro(e)),t*Math.cos(Ro(e))*-1)}function dm(e,t){if(e.type==="conic"){let{angle:o,radius:r}=e;return t.map(n=>{let i=o+n.position*360;return cm(i,r)})}return t.map(o=>A.pointAtPercentDistance(e.axis,o.position))}function pm(e,t,o){let r=e.getRect(t),n=o.centerAnchorX*r.width,i=o.centerAnchorY*r.height,a=o.widthFactor*r.width,s=o.heightFactor*r.height,l=a*2,c=s*2,d=a+n,u=i-s,p={width:l,height:c},m=e.convertPointToCanvas(t,{x:n,y:i}),g=e.convertPointToCanvas(t,{x:d,y:i}),v=e.convertPointToCanvas(t,{x:n,y:u}),{rotation:S}=e.convertRectToCanvasWithRotation(t),h=A(m,g);return{type:"radial",start:m,end:g,center:A.pointAtPercentDistance(h,0),axis:h,rotation:S,size:p,topCenter:v}}function um(e,t,o){let r=e.getRect(t),n={x:r.width/2,y:r.height/2},i=e.convertPointToCanvas(t,n),a=o.angle*Math.PI/180,s={x:-Math.sin(a)*100,y:Math.cos(a)*100},l=e.convertPointToCanvas(t,P.add(n,s)),c=A(i,l),d=fo(o.angle),u=T.pointsAtOrigin(r),p=Math.floor(d/90)+3,m=u[p%4],g=e.convertPointToCanvas(t,m),v=u[(p+2)%4],S=e.convertPointToCanvas(t,v),h=A.perpendicular(c,g),f=A.intersection(h,c);if(!f)return null;let y=P.subtract(i,f),x=P.add(f,y,y),b=u[(p+1)%4],C=e.convertPointToCanvas(t,b),w=A.perpendicular(h,C),R=A.perpendicular(c,i),k=A.intersection(w,R);if(!k)return null;let F={width:P.distance(k,i)*2,height:P.distance(f,x)};return{type:"linear",start:f,end:x,center:i,axis:A(f,x),startCorner:g,endCorner:S,size:F}}function mm(e,t,o){let r=e.getRect(t),n=e.convertPointToCanvas(t,{x:r.width/2*o.centerAnchorX/.5,y:r.height/2*o.centerAnchorY/.5}),[i,a]=T.midPoints(r),s=T.center(r),l=P.distance(s,i),c=P.distance(s,a),d=Math.min(l,c),u=e.totalAncestorRotation(t),p=fo(u+o.angle);return{type:"conic",start:P(s.x,s.y-d),center:n,rotation:0,radius:d,angle:p}}var wI=(e,t,o,r)=>{let n=dm(e,t),i=n[0],a=n[n.length-1];if(i.x===a.x&&i.y===a.y&&P.distance(o,i)<r)return!0;let s=A(i,a),l=A.perpendicular(s,o),c=A.intersection(s,l);if(e.type==="radial"&&P.distance(o,e.topCenter)<r)return!0;if(e.type==="conic")return P.distance(o,e.center)<=e.radius+40;if(!c)return!1;let d=P.distance(o,c),u=P.distance(o,i),p=P.distance(o,a),m=P.distance(i,a);return u>m&&p<u?Math.max(p,d)<r:p>m&&u<p?Math.max(u,d)<r:d<r};function fm(e,t){let o=e.reduce((a,s)=>Math.abs(a.position-t)<Math.abs(s.position-t)?a:s),r=e.findIndex(a=>a===o),n=o.position-t>0?r-1:r+1,i=e[n]??o;return[o,i]}function FI(e,t,o,r){let[n,i]=fm(t,o),a=Ft([n.position,i.position],[0,1])(o),s=kr(e,n,r),l=kr(e,i,r);return Ft([0,1],[s,l])(a)}function kr(e,t,o){let r=t.value;if(!mn(r))return r;let n=pn(r),i=n?Vi(n,e):null;return i&&Zr(i)?i.colorForMode(o):un(r)||"transparent"}function DI(e,t,o){return t.map(r=>r.merge({value:kr(e,r,o)}))}function AI(e,t){let o=A(t,e.center),r=e.center.x,n=e.center.y-e.radius,i=A(P(r,n),e.center),a=A.intersectionAngle(i,o),l=fo(a)-e.angle,c=fo(l);return Math.abs(c/360)}function fo(e){if(e===360)return e;let t=e%360;return t<0?360+t:t}function LI(e){return e.sort((t,o)=>t.position-o.position)}function BI(e){let t=!1,o=Ft([e.stops[0]?.position??0,e.stops[e.stops.length-1]?.position??1],[0,1]),r=e.stops.map(n=>((n.position<0||n.position>1)&&(t=!0),n.merge({position:o(n.position)})));return t?r:void 0}var ic="--top-flash-inset",ac="--right-flash-inset",sc="--bottom-flash-inset",lc="--left-flash-inset",cc="--flash-radius",Pr="fh6lfgu",wr="d8eehx6",dc="wdvaq7i",pc="ghqxg7a";var Pt=2;function uc(e="default"){switch(e){case"glow":return[pc];case"default":return[wr];case"warning":return[wr,dc]}}function kt(e,t,o){e.style.setProperty(t,`${o??0}px`)}function mc(e,t){kt(e,ic,t?.inset?.top),kt(e,ac,t?.inset?.right),kt(e,sc,t?.inset?.bottom),kt(e,lc,t?.inset?.left),t?.radius&&kt(e,cc,t.radius),e.addEventListener("animationend",function o(){e.classList.remove(Pr),e.classList.remove(...uc(t?.style)),e.removeEventListener("animationend",o)}),e.classList.add(Pr),e.classList.add(...uc(t?.style))}function fc(e){let t=Z.isOn("agent")?nc.panelPadding:Yn.values.panelPadding;mc(e,{style:"default",inset:{top:Pt,right:-(t-Pt),left:-(t-Pt),bottom:Pt}})}function hc({id:e,flash:t}){let o=document.getElementById(e);o instanceof HTMLDivElement&&(Mr(o,{scrollMode:"if-needed",block:"start"}),t&&fc(o))}function gc(e){let t=new MouseEvent("mousedown",{bubbles:!0,cancelable:!0,view:document.defaultView,detail:1,screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null});e.dispatchEvent(t)}var yc="breadcrumb-collection";function ym(e,t,o){let r=e.tree.getNode(o);if(!r)return null;if(!Ti(r))return{variableProvider:r,variableId:t};let n=e.tree.getNodeWithTrait(r.dataRepeaterArray.providerId,Wt);return n?{variableProvider:n,variableId:r.dataRepeaterArray.id}:null}function vN(e,t,o){let{chromeStore:r,modalStore:n,variablesStore:i,contentManagementStore:a,scopeStore:s,codeEditorStore:l,selectionStore:c}=e.stores;if(o===Kn){r.setLocalizationsVisible(!0);return}let d=ym(e,t,o);if(!d)return;let{variableProvider:u,variableId:p}=d;if(fn(u)&&u.hasVariable(p))i.selectedVariablePath=[p],n.set({type:"Variables",source:"variableReference"});else if(X(u)||qr(u)){let{dataIdentifier:g}=u;if(!g)return;if(je(g)){if(r.isViewOnly)return;n.set({type:"Confirmation",title:"External Collection",description:`This is an external ${"Collection".toLowerCase()} preview. To edit, choose a collection to swap in or create a local copy of this collection.`,confirmLabel:"View Options",source:"edit_action",onConfirm:()=>{r.chromeIsVisible=!0,$e(u)?(c.set(u.id),e.scheduler.runAtEndOfFrame(()=>hc({id:"data-repeater-panel",flash:!0}))):X(u)?e.scheduler.runAtEndOfFrame(()=>{let h=document.getElementById(yc);h&&gc(h)}):void 0}});return}let v=Le(e.tree,g);if(v){X(u)&&I(u.isLoaded(),"Web page node should be loaded");let h=xm({collectionNode:v,engine:e,variableId:p,variableProvider:u});h?(a.pushExistingItemToOverlayStack(h.collectionItemNode.id),a.setCollectionItemControlToHighlight(h.variableId)):(s.select(Zn,{keepHistory:!1}),c.set(v),a.setCollectionItemControlToHighlight(p));return}let S=ro(e.componentLoader,g);S&&l.editFile(S.file)}}function xm({collectionNode:e,engine:t,variableId:o,variableProvider:r}){let n=xc({engine:t,variableProvider:r});if(n)return n;let i=o.split(".");I(i.length>=0,"VariableID must not be empty");let a=Be(r,t.stores.treeStore.sandboxRepeaterData),s=t.tree.getNodeWithTrait(a,he);if(s)return Xt(t.tree,t.stores.treeStore.sandboxRepeaterData,o,s,e)}function xc({engine:e,variableProvider:t}){if(!vi(t))return;let[o,...r]=t.collectionFilters?.filters.flatMap(l=>l?.itemKey!=="id"?[]:l.transforms).flatMap(l=>vm(l)??[])??[];if(!o?.providerId||r.length>0)return;let n=e.tree.getNode(o.providerId);if(!n||!(Bt(n)||X(n))||!n.dataIdentifier)return;let i=Le(e.tree,n.dataIdentifier);if(!i)return;let a=Be(n,e.stores.treeStore.sandboxRepeaterData),s=e.tree.get(a);if(he(s))return s?{collectionItemNode:s,collectionNode:i,variableId:o.id}:xc({engine:e,variableProvider:n})}function vm(e){if(!(e.name!=="equals"&&e.name!=="isIncludedIn"||!Hr(e.value)||!e.value.providerId))return e.value}function vc(e,t,o,r){t.stores.canvasStore.invalidateTransformUntilRendered(()=>{try{t.stores.scopeStore.select(e,r),t.stores.codeEditorStore.closeEditor()}catch{be("open_primary_component_fail",{}),Ce({type:"add",variant:"error",key:"invalid-deep-link",primaryText:"Primary component",secondaryText:"has been deleted.",icon:"error",duration:1e4});return}if(!o)return;let n=t.tree.getNode(o);n&&t.tree.getScopeNodeFor(n)?.id===e&&(t.stores.selectionStore.set(n.id),t.stores.canvasStore.zoomToCenter(t.tree.convertFrameToCanvas(n),{animated:!1,maxZoom:1}))})}function Sc(e,t,o,r){let n=me(e),i=eo(t,"canDesign");if(ue(n)&&(n.type==="canvasComponent"||n.type==="screen"||n.type==="vector"))return[{label:i?"Open":"Edit",accelerator:tt.fakeSelectChildren,click:()=>{if(n.type==="vector"){let u=t.stores.modulesStore.forType("vector").getByStableName(n.localIdName)?.annotations(null,"default")?.framerVector;if(!di(u))return;let{set:p}=u;vc(p.id,t,n.localIdName,r);return}let[,d]=n.localId.split("/");d&&vc(d,t,o,r)}}];if(je(n)&&n.kind==="externalModuleExport"){if(r.node?.isVectorInstance)return Ui(t,e)?pt():[{label:"Edit",accelerator:tt.fakeSelectChildren,click:()=>fa(t,n.moduleId,r.node?.id),enabled:!i}];let d=t.stores.insertSidebarStore.getEditBehavior(n.moduleId),u=t.componentLoader.componentForIdentifier(n.value)?.annotations,p=t.stores.treeStore.tree.getNode(n.moduleId),g=r.externalModuleType==="canvasComponent"&&p&&p.ownerId==="1h0OTH9KlHTd4pyc9CLt";if(sa(t.stores.treeStore.tree,n)&&d==="block"||Or(u,"framerDisableUnlink"))return pt();if(!da(r.externalModuleType))return pt();let{node:v,withUnlinkModal:S,externalModuleType:h}=r;return v&&d==="autoDetach"?[{label:"Detach Instance",enabled:!i,click:async()=>{t.beginUndoGroup(),zi({key:"auto-detach",progress:{variant:"progress",primaryText:"Detaching component",secondaryText:"instance\u2026"},error:{variant:"error",primaryText:"Failed to detach",secondaryText:"component instance."}},async()=>{await Sm(v,t,n,h)}).catch(E),t.endUndoGroup()}}]:g?[{label:"Edit",accelerator:tt.fakeSelectChildren,click:()=>{ma(t,{identifier:n,moduleType:h,instance:v,enterIsolation:!0}).catch(E)},enabled:!i}]:[{label:"Unlink",click:()=>{ua(t,{identifier:n,moduleType:h,instance:v,withUnlinkModal:S,enterIsolation:!0}).catch(E)},enabled:!i}]}let a=ro(t.componentLoader,e);if(!a||a.type!=="component"||a.depth!==0)return pt();let s=r.keepHistory?void 0:()=>{t.stores.scopeStore.goBack()},l=$i(t.stores.treeStore,t.stores.modulesStore,t.stores.pluginStore,n);return[...l&&qi(t.stores.modulesStore,n)&&!i&&ue(e)?[{label:Yi(l),click:()=>{s?.(),ca(t,e,l)}}]:[],{label:i?"View Code":"Edit Code",click:()=>{s?.(),t.stores.codeEditorStore.editFile(a.file)},enabled:ue(e)}]}async function Sm(e,t,o,r){let n=new Map,i=await pa(t,{identifier:o,moduleType:r,instance:e,renamedIds:n,isAutoDetach:!0,enterIsolation:!1});if(!i)return null;let{node:a}=i;return Xe(a)?t.scheduler.processWhenReadyAsync(()=>{let s=Xi.detachSmartComponentOrWebPageInstance(t,e.draftOrCurrent(),a,n);return s&&t.stores.selectionStore.set(s.id),s}):null}function bc(e){return e?.find(o=>o.enabled!==!1)?.click}function bm(e,t,o){return Sc(e,t,null,o)}function HN(e,t,o){return bc(bm(e,t,o))}function Cm(e,t,{withUnlinkModal:o=!0,externalModuleType:r,activateContentPanel:n}={}){let i=_n(t.tree,e);return Sc(e.codeComponentIdentifier,t,i,{keepHistory:!0,node:e,withUnlinkModal:o,externalModuleType:r,activateContentPanel:n})}function WN(e,t,o={}){return bc(Cm(e,t,o))}var UN="My website";var $N="My description",YN="yoursite.url";export{dr as a,ka as b,St as c,wc as d,Dc as e,Da as f,io as g,q as h,vg as i,Sg as j,bg as k,Cg as l,Ig as m,Ng as n,Tg as o,Rg as p,Mg as q,kg as r,Pg as s,wg as t,Os as u,Fg as v,$d as w,Dg as x,mr as y,fr as z,Us as A,$s as B,so as C,qs as D,uI as E,La as F,Jy as G,hr as H,bp as I,kp as J,dx as K,px as L,gI as M,iS as N,It as O,Nt as P,CS as Q,AS as R,Mr as S,VS as T,eb as U,lb as V,cb as W,zl as X,db as Y,mb as Z,fb as _,rx as $,nx as aa,ix as ba,Cb as ca,Mb as da,Wl as ea,Lb as fa,Rt as ga,Ee as ha,Yl as ia,Ub as ja,$b as ka,Ks as la,Xs as ma,sl as na,dl as oa,Ax as pa,Ru as qa,oC as ra,Mu as sa,uo as ta,rC as ua,oc as va,GC as wa,PI as xa,cm as ya,dm as za,wI as Aa,FI as Ba,kr as Ca,DI as Da,AI as Ea,LI as Fa,BI as Ga,pl as Ha,nc as Ia,Pt as Ja,mc as Ka,hc as La,yc as Ma,vN as Na,vc as Oa,Sm as Pa,bm as Qa,HN as Ra,Cm as Sa,WN as Ta,Gu as Ua,WC as Va,$C as Wa,ml as Xa,fl as Ya,hl as Za,rt as _a,vl as $a,Sl as ab,bl as bb,Jp as cb,Bv as db,Gv as eb,UN as fb,$N as gb,YN as hb,_C as ib,Cl as jb,eI as kb,Il as lb,Hu as mb,Ju as nb,em as ob,lm as pb};
//# sourceMappingURL=chunk-W7PFF3PB.mjs.map
