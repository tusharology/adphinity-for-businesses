import{a as k}from"chunk-ULG3WRAD.mjs";import{a as Ot,b as Dt,c as Ut,d as At,e as Bt,f as Ht,g as Gt}from"chunk-OKG5TFIV.mjs";import{a as Wt,b as zt}from"chunk-QD2PLNA7.mjs";import{a as wt,h as kt}from"chunk-BYPJTLXA.mjs";import{a as Et}from"chunk-IM24HCZX.mjs";import"chunk-FDX2C2EY.mjs";import{a as vt,b as It,c as gt,e as Oe,f as Rt,g as Pt,i as yt,o as bt,p as Mt,q as Nt,r as ie,s as xt,t as Lt,u as St,v as De,w as we,x as Vt,y as Tt,z as Ft}from"chunk-DSNNB3NW.mjs";import{a as ht,b as Ct}from"chunk-JODNW4KQ.mjs";import"chunk-SPWSWTND.mjs";import"chunk-I3B5LRNC.mjs";import{c as lt,d as pt,f as ae}from"chunk-QWJMCMVC.mjs";import{a as st}from"chunk-SY7THV6P.mjs";import{a as dt}from"chunk-RAZ5STN2.mjs";import{b as ne,c as Ee,d as ot,g as tt,p as nt}from"chunk-E6Y5T3PM.mjs";import{$h as Xo,Sa as qo,_a as jo,ai as Yo,gc as Zo,lg as Ko,mc as Ve,mg as $o,nc as Te,ng as _o,td as Fe}from"chunk-Y4KFFISW.mjs";import"chunk-KYQ6X7UF.mjs";import"chunk-Y4KSD2WZ.mjs";import{a as ct}from"chunk-Y5OPUDMF.mjs";import{a as at}from"chunk-YEI67D6W.mjs";import"chunk-75ILXMIH.mjs";import"chunk-2M6CHUK6.mjs";import{a as mt,b as ut,c as ft}from"chunk-SDISSWE6.mjs";import{i as rt}from"chunk-TKAEQUPC.mjs";import{Jd as Ao,Tl as Qo,wl as zo,yl as Go}from"chunk-ZXJMCM2S.mjs";import"chunk-6C6VSETA.mjs";import"chunk-FYUJQV6J.mjs";import"chunk-KYPY4QS7.mjs";import"chunk-SOM3QFWS.mjs";import"chunk-XFC6OVIX.mjs";import{e as et}from"chunk-R32HLP7P.mjs";import{b as it}from"chunk-7GSEC7H4.mjs";import"chunk-N42NUTZC.mjs";import{i as Bo,v as ur}from"chunk-26DHASNB.mjs";import"chunk-67IDBBKJ.mjs";import"chunk-GZI43NW3.mjs";import{$f as xe,Ad as po,Ae as Co,Ar as Uo,Bd as co,Bo as ko,Cc as Me,Cg as Lo,Dg as So,G as $e,Ga as Ye,I as _e,Ia as J,Ir as te,Jj as To,Ke as ee,Kt as Jo,Ma as eo,Qf as Ro,Sd as mo,Se as oe,Sg as Vo,T as Je,Td as uo,Te as vo,Tf as Po,Ud as fo,Uf as yo,Vm as Fo,Zf as bo,cf as Io,cn as Eo,db as oo,ed as ro,gb as to,gs as Ho,he as ho,id as no,if as go,jd as ao,kg as Mo,ks as re,mc as X,od as K,pg as No,pp as Le,qs as Se,td as io,ud as Ne,vd as Y,wb as be,xd as so,xg as xo,yd as lo,zo as wo,zr as Wo}from"chunk-SF5446RK.mjs";import"chunk-AYYBTPZU.mjs";import{V as z,aa as Oo,fa as Do,g as ge}from"chunk-RT6MD2HE.mjs";import"chunk-XFC6OVIX.mjs";import"chunk-REJ2XCEK.mjs";import"chunk-BUC334RG.mjs";import"chunk-B7SOVHNX.mjs";import"chunk-POQKH4YA.mjs";import{p as ye}from"chunk-OBUCKN56.mjs";import{b as W,f as Re,g as Pe,j as w}from"chunk-CMAEAGWD.mjs";import"chunk-AUNF3KWQ.mjs";import{Xe,bg as mr}from"chunk-NNG7ZAML.mjs";import{a as A,b as T}from"chunk-JB2N3EQZ.mjs";import{j as Ke}from"chunk-4X7KIAE7.mjs";import"chunk-6E4TUQ3S.mjs";import{Na as Ze,Ra as _,W as Z,la as ze,qa as Ge,ua as Qe,ya as qe,za as je}from"chunk-EEV263O3.mjs";import{a as C}from"chunk-YOOGIIWU.mjs";import{a as He}from"chunk-HMF7T2NG.mjs";import{e as b,j as m}from"chunk-AHQIRSXG.mjs";var Qt=new WeakMap;function ke(r){let e=Qt.get(r);if(e)return e;let o=new Set;if((zo(r)||Go(r))&&o.add(r),r.children)for(let t of r.children){let n=ke(t);for(let a of n)o.add(a)}return Qt.set(r,o),o}var E=b(A(),1),pr=b(ur(),1);var B=b(A(),1),Kt=b(T(),1),de=(0,B.createContext)({nodeInTextEditorId:void 0,clipPath:void 0});de.displayName="NodeInTextEditorContext";function qt({children:r,nodeInTextEditorId:e,clipPath:o}){let t=(0,B.useMemo)(()=>({nodeInTextEditorId:e,clipPath:o??void 0}),[e,o]);return(0,Kt.jsx)(de.Provider,{value:t,children:r})}function jt(){let{nodeInTextEditorId:r}=(0,B.useContext)(de);return r}function Zt(){let{clipPath:r}=(0,B.useContext)(de);return r}var v=b(A(),1),Yt=b(mr(),1);var se=b(A(),1),Jt=b(T(),1),$t=(0,se.createContext)(void 0);function _t({children:r,update:e}){return(0,Jt.jsx)($t.Provider,{value:e,children:r})}function We(){return(0,se.useContext)($t)}var le=b(A(),1),G=b(T(),1);function pe({context:r,children:e,fallback:o}){return(0,G.jsx)(le.Suspense,{fallback:(0,G.jsx)(fr,{context:r,children:o}),children:e})}function fr({context:r,children:e}){return(0,le.useLayoutEffect)(()=>r.loadingStateTracker.trackSuspense(),[r]),(0,G.jsx)(G.Fragment,{children:e})}function $(r,e){let o=new Set;o.add(e);let t=te(r,e);if(t){let n=St(t,{includeLocalizedValues:!0});for(let a of n)o.add(a)}return o}var p=b(T(),1);$e({target:_e.canvas});function er({context:r,webPageNode:e,collectionItemNode:o,breakpointNode:t,temporaryCollectionItemNodeId:n}){let a=(0,v.useContext)(oe).activeLocale??void 0,i=(0,v.useMemo)(()=>{if(e&&t)return Ct(e,t,r.componentLoader)},[e,t,r.componentLoader]);if(e&&t)return(0,p.jsx)(pe,{context:r,children:(0,p.jsx)(Io.Provider,{value:i,children:(0,p.jsx)(hr,{context:r,webPageNode:e,collectionItemNode:o,breakpointNode:t,activeLocale:a,temporaryCollectionItemNodeId:n})})})}function hr({context:r,webPageNode:e,collectionItemNode:o,breakpointNode:t,activeLocale:n,temporaryCollectionItemNodeId:a}){let i=e.tree();C(i,"Must have a tree");let[s,d]=r.modulesRuntime.useComponentLoader(),l=e.getProvidedControlMap(i,void 0,s,d);C(l,"Control map must exist");let u=e.getProvidedValueMap(i,void 0,s,r.sandboxRepeaterData,d),c=(0,v.useMemo)(()=>{if(!l)return;let h=new Map;return h.set(e.id,l),h},[l,e.id]),f=(0,v.useMemo)(()=>{if(!u)return;let h=new Map;return h.set(e.id,u),h},[u,e.id]);return X(e)&&o?(0,p.jsx)(Cr,{context:r,webPageNode:e,collectionItemNode:o,breakpointNode:t,activeLocale:n,temporaryCollectionItemNodeId:a,combinedControlMap:c}):(0,p.jsx)(or,{context:r,webPageNode:e,breakpointNode:t,combinedControlMap:c,combinedValueMap:f,placeholderVariableIds:void 0,activeLocale:n})}function Cr({context:r,webPageNode:e,collectionItemNode:o,breakpointNode:t,activeLocale:n,temporaryCollectionItemNodeId:a,combinedControlMap:i}){let s=e.tree();C(s,"Must have a tree");let d=i?.get(e.id);C(d,"Control map must exist");let l=e.dataIdentifier,u=$(s,l);r.modulesRuntime.usePreloadedModules(...u);let[c,f]=r.modulesRuntime.useComponentLoader(),h=c.dataForIdentifier(l);C(h,"Data definition must exist after preloading module");let y=Lt(s,c,d,e,t,n,o.id,"public-and-private"),P=xe(y);r.sandboxRepeaterData.set(e.id,P,d);let I=e.getProvidedValueMap(s,void 0,c,r.sandboxRepeaterData,f);C(I,"Value map must exist");let M=te(s,l),{patchedValueMap:N,placeholderVariableIds:R}=(0,v.useMemo)(()=>!!M&&o.id===a?vr(M,I):{patchedValueMap:I,placeholderVariableIds:new Set},[M,I,o.id,a]),g=(0,v.useMemo)(()=>{let x=new Map;return x.set(e.id,N),x},[N,e.id]);return(0,p.jsx)(or,{context:r,webPageNode:e,breakpointNode:t,combinedControlMap:i,combinedValueMap:g,placeholderVariableIds:R,activeLocale:n})}function vr(r,e){let o=new Map(e),t=new Set;for(let[n,a]of e){let i=r.getVariable(n);if(i){if(i.type==="string"){if(!(!a||W(a)&&a.trim()===""))continue;let d=i.options?.placeholder||i.description||i.name;o.set(n,d),t.add(n)}if(i.type==="richtext"){if(!(!a||W(a)&&dt(a)))continue;o.set(n,`<p>${i.description||i.name}</p>`),t.add(n)}}}return{patchedValueMap:o,placeholderVariableIds:t}}function or({context:r,webPageNode:e,breakpointNode:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i}){return Le(e)?(0,p.jsx)(pe,{context:r,children:(0,p.jsx)(gr,{context:r,webPageNode:e,breakpointNode:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i})}):(0,p.jsx)(Q,{context:r,parentRenderId:e.id,node:o,parent:e,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i,nodePropOverrides:void 0})}var tr={minHeight:"100vh",width:"auto"},Ir=Rt();function gr({context:r,webPageNode:e,breakpointNode:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i}){let s=(0,v.useRef)(null),d=(0,v.useRef)(null);r.modulesRuntime.usePreloadedModules(e.layoutTemplateIdentifier);let[l]=r.modulesRuntime.useComponentLoader(),u=ae(),c=ce(r.fetchClient,e),f=e.getResolvedControlPropValues(l,u,n,i,c),h=l.reactComponentForIdentifier(e.layoutTemplateIdentifier);C(h,"Component definition not found");let y=h.class,P=To(o)&&Co(o)?o.width:void 0,{activeVariant:I,className:M,selectors:N}=Pt(l,e.layoutTemplateIdentifier,P,Ir)??{};(0,v.useLayoutEffect)(()=>{if(!s.current||!d.current)return;let g=Oe(d.current);if(r.layoutMeasureQueue.add(o.id,s.current,g),!!N)for(let x of N){let V=s.current.querySelector(x);V&&r.layoutMeasureQueue.add(o.id,V,[],x)}},[r.layoutMeasureQueue,o.id,N]);let R=(0,v.useMemo)(()=>({ref:d}),[]);return(0,p.jsx)("div",{ref:s,className:M,children:(0,p.jsx)(y,{...f,style:tr,variant:I,children:(0,p.jsx)(Q,{context:r,parentRenderId:e.id,node:o,parent:e,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i,nodePropOverrides:R})})})}var Q=(0,v.memo)(function({context:e,parentRenderId:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodePropOverrides:l,skipNodeLevelRepeat:u}){let c=ne(o,t.id),f=t.tree();return t.cache.resetForRendering(),t.cache.setVariableValueAndControlMap(i,i,a,d,t,f,void 0),tt(n,t),Ao(t)||t.resolveValue("visible",i)===!1?(e.sandboxVisibility.setVisible(c,!1),null):(e.sandboxVisibility.setVisible(c,!0),(0,p.jsx)(pe,{context:e,children:(0,p.jsx)(yr,{context:e,renderId:c,tree:f,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodePropOverrides:l,skipNodeLevelRepeat:u})}))});function Rr(r,e,o,t,n,a,i){let s=ce(r.fetchClient,o),d=o.getProps(r.componentLoader,n,a,s);if(K(t)&&(d.style??={},d.style.position="relative",d.style.width="100%",Le(t)?(d.style.display="contents",d.style.position="relative",d._needsMeasure=!1,d["data-layout-template-root"]=!0):Object.assign(d.style,tr)),Ne(o)){let l=Ft(o,a);l&&(d.viewBox=l);let u=Tt(o,n,s);u&&(d.text=u)}if(d.id=e,i)for(let l in i){let u=i[l];l==="style"&&d.style?Object.assign(d.style,u):d[l]=u}return d}var Pr=No(J);function yr({context:r,renderId:e,tree:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodePropOverrides:l,skipNodeLevelRepeat:u}){let c=Rr(r,e,t,n,i,d,l);if(!u&&re(t))return(0,p.jsx)(Lr,{context:r,renderId:e,tree:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodeProps:c,nodePropOverrides:l});if(lo(t))return(0,p.jsx)(Lo,{...c});if(co(t))return we(t),(0,p.jsx)(J,{...c,as:"svg",children:t.children.map(f=>{let h=ne(e,f.id);return De(f,r.componentLoader,i,r.sandboxVisibility,h,!1,void 0)})});if(Fo(t))return we(t),De(t,r.componentLoader,i,r.sandboxVisibility,e,!0,c);if(io(t))return(0,p.jsx)(So,{...c});if(Ne(t))return(0,p.jsx)(br,{context:r,node:t,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodeProps:c,renderId:e});if(ro(t))return no(t)?(0,p.jsx)(Or,{context:r,renderId:e,tree:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodeProps:c}):ao(t)?(0,p.jsx)(Dr,{context:r,renderId:e,tree:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodeProps:c}):(0,p.jsx)(xr,{context:r,renderId:e,tree:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodeProps:c});if(mo(t))return(0,p.jsx)(Ko,{...c});if(fo(t))return(0,p.jsx)(_o,{...c,node:t,tree:o,componentLoader:r.componentLoader,combinedValueMap:i,activeLocale:d});if(uo(t)){let f=o.getGroundNodeFor(t).id;return(0,p.jsx)($o,{...c,groundNodeId:f})}return so(t)?null:Y(t)?t.isVectorInstance?(0,p.jsx)(Tr,{node:t,context:r,nodeProps:c,combinedValueMap:i,activeLocale:d}):(0,p.jsx)(Vr,{context:r,renderId:e,node:t,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodeProps:c}):(ho(t),null)}var br=(0,v.memo)(function({context:e,node:o,combinedValueMap:t,placeholderVariableIds:n,activeLocale:a,nodeProps:i,renderId:s}){let d=o.getFontsForLoading();e.fontLoader.usePreloadedFonts(...d),i={...i};let l=jt(),u=Zt();if(l===s)if(u){let f=i.style??{};i.style={...f,clipPath:u}}else i.isEditable=!0;Sr(o,n)&&(i.opacity=.3);let c=(0,v.useMemo)(()=>Vt(o,t,a),[o,t,a]);if(be(o.htmlContent)&&o.getComponentPresets().size>0){let f=o.tree();return C(f,"Must have a tree"),(0,p.jsx)(vt,{tree:f,componentLoader:e.componentLoader,node:o,richTextProps:i,children:c})}return(0,p.jsx)(xo,{...i,children:c})});function Ue({node:r,nodeProps:e,children:o}){let t=(0,v.useRef)(null),n=e.ref??t,a=Mr(r);Ye(e,n,a);let i=Nr(r);return(0,p.jsx)(i,{...e,ref:n,children:o})}function Mr(r){return Me(r)?It:Oe}function Nr(r){return Me(r)?Pr:J}function rr({moveState:r,...e}){let{parentRenderId:o,node:t}=e,n=ne(o,t.id),a;r&&n===r.renderId&&(a={style:{left:r.rect.left,top:r.rect.top,alignSelf:"unset",justifySelf:"unset",placeSelf:"unset",zIndex:999999,width:r.rect.width,height:r.rect.height,position:"absolute",outline:`1px solid ${Bo.onPageHighlightBorderDragging}`}});let i=(0,p.jsx)(Q,{...e,nodePropOverrides:a});return r&&n===r.renderId?(0,p.jsxs)(v.Fragment,{children:[(0,p.jsx)(gt,{width:r.placeholder.attributes.width,height:r.placeholder.attributes.height}),(0,Yt.createPortal)(i,document.body)]}):i}function nr(r,e){let o=r.getChildrenInVisualOrder();if(e&&e.placeholder.nodeId===r.id){let t=o.findIndex(n=>n.id===e.nodeId);return Ze.move([...o],t,e.placeholder.index)}return o}function xr({context:r,renderId:e,node:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i,nodeProps:s}){let d=We(),l=nr(o,d);return(0,p.jsx)(Ue,{node:o,nodeProps:s,children:l.map(u=>(0,p.jsx)(rr,{context:r,parentRenderId:e,node:u,parent:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i,moveState:d},u.id))})}function Lr({context:r,renderId:e,tree:o,node:t,parent:n,combinedControlMap:a,combinedValueMap:i,placeholderVariableIds:s,activeLocale:d,nodePropOverrides:l}){let[u,c]=r.modulesRuntime.useComponentLoader(),f=t.repeatArray,h=f.providerId;C(h,"Variable must have providerId");let y=Zo(t,h),P=y?.getProvidedControlMap(o,t,u,c),I=y?a?.get(h)?.get(f.id):void 0,M=P?.get(f.id),{controlMap:N}=Te(I),R=y?y.getProvidedValueMap(o,t,u,r.sandboxRepeaterData,c):void 0,g=y?i?.get(h)?.get(f.id)??R?.get(f.id):void 0,x=Pe(g)&&g.every(Re),V=x?g:[],F=I!==void 0?N:Te(M).controlMap,S=t.getPrimaryId(),O=(0,v.useMemo)(()=>{let D=new Map(a);return D.set(S,F),D},[F,a,S]),U=V.length,H=(0,v.useMemo)(()=>V.map((D,q)=>{let j=new Map(i),Ie=ie(o,F,D,q,U);return j.set(S,Ie),j}),[o,F,i,S,V,U]);return!y||!x?(r.sandboxRepeaterData.set(e,void 0,F),null):(r.sandboxRepeaterData.set(e,V,F),(0,p.jsx)(p.Fragment,{children:V.map((D,q)=>{let j=W(D.id)?D.id:q,Ie=Ee(e,t.id,j,q);return(0,p.jsx)(Q,{context:r,parentRenderId:Ie,node:t,parent:n,combinedControlMap:O,combinedValueMap:H[q],placeholderVariableIds:s,activeLocale:d,nodePropOverrides:l,skipNodeLevelRepeat:!0},j)})}))}function Sr(r,e){return e?Xt(r.htmlContent,e)||Xt(r.textContent,e):!1}function Xt(r,e){return be(r)?e.has(r.id):!1}function Vr({context:r,renderId:e,node:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i,nodeProps:s}){let d=o.tree();C(d,"Must have a tree"),r.modulesRuntime.usePreloadedModules(o.codeComponentIdentifier);let[l]=r.modulesRuntime.useComponentLoader(),u=l.reactComponentForIdentifier(o.codeComponentIdentifier);C(u,"Component definition not found");let c=ae(),f=ce(r.fetchClient,o),h=o.getCodeComponentProps(l,c,n,i,f),y=Xo(d,o,l);y.children=Yo(d,o,l);for(let R in y){let g=y[R];g&&(h[R]=g.map(x=>{let V=ot(e,o.id,R,x.key);return(0,p.jsx)(Q,{context:r,parentRenderId:V,node:x.node,parent:o,combinedControlMap:t,combinedValueMap:n,placeholderVariableIds:a,activeLocale:i,nodePropOverrides:Er},x.key)}))}let P=o.getRichTextControlKeys(l);for(let R of P){let g=h[R];W(g)&&(h[R]=rt(g))}let I=o.getComponentVectorSetChildren(l,n),M=new Set;for(let R in I){let g=I[R];w(g)||(M.add(g),r.modulesRuntime.preloadModule(g))}r.modulesRuntime.usePreloadedModules(...M);for(let R in I){let g=I[R];if(w(g))continue;let x=l.reactComponentForIdentifier(g);C(x,"Vector definition not found"),h[R]=x.class}let N=u.class;return(0,p.jsx)(yt,{componentLoader:l,...s,children:(0,p.jsx)(N,{...h})})}function Tr({context:r,node:e,nodeProps:o,combinedValueMap:t,activeLocale:n}){let[a]=r.modulesRuntime.useComponentLoader(),i=ae(),s=ce(r.fetchClient,e);return bt({node:e,frameProps:o,getCodeComponentProps(){return e.getCodeComponentProps(a,i,t,n,s)},combinedValueMap:t,renderVectorWithIdentifier(d,l){return(0,p.jsx)(Fr,{context:r,identifier:d,getProps:l})}})}function Fr({context:r,identifier:e,getProps:o}){r.modulesRuntime.preloadModule(e),r.modulesRuntime.usePreloadedModules(e);let[t]=r.modulesRuntime.useComponentLoader(),n=t.reactComponentForIdentifier(e);C(n,"Component definition not found");let a=o(),i=n.class;return(0,p.jsx)(i,{...a})}var Er={position:"relative"};function Or({context:r,renderId:e,tree:o,node:t,combinedControlMap:n,combinedValueMap:a,placeholderVariableIds:i,activeLocale:s,nodeProps:d}){let l=$(o,t.dataIdentifier);r.modulesRuntime.usePreloadedModules(...l);let[u,c]=r.modulesRuntime.useComponentLoader(),f=t.getProvidedControlMap(o,void 0,u,c);C(f,"Control map must exist");let h=Se(o,t),y=!!h&&!re(h),P=t.getPrimaryId(),I=(0,v.useMemo)(()=>{let S=new Map(n);return S.set(P,f),S},[f,n,P]),M=nt(t,I,Mt(o,t),S=>h?{type:"LiteralValue",value:h.cache.getVariableReferenceValue(S,a)}:{type:"LiteralValue",value:void 0},S=>xt(o,u,t,S,s));Qo(t)&&Nt(M,t);let N=xe(M);r.sandboxRepeaterData.set(e,N,f);let R=N.length,g=(0,v.useMemo)(()=>N.map((S,O)=>{let U=new Map(a),H=ie(o,f,S,O,R);return U.set(P,H),U}),[o,f,a,P,N,R]),{nonRepeatedChildCombinedControlMap:x,nonRepeatedChildCombinedValueMap:V}=Ve(n,a,P,R),F=ar({context:r,renderId:e,node:t,repeatedChild:y?h:void 0,items:N,repeatedChildCombinedValueMapPerItem:g,repeatedChildCombinedControlMap:I,nonRepeatedChildCombinedControlMap:x,nonRepeatedChildCombinedValueMap:V,placeholderVariableIds:i,activeLocale:s});return(0,p.jsx)(Ue,{node:t,nodeProps:d,children:F})}function Dr({context:r,renderId:e,tree:o,node:t,combinedControlMap:n,combinedValueMap:a,placeholderVariableIds:i,activeLocale:s,nodeProps:d}){C(a,"Combined value map must exist");let[l,u]=r.modulesRuntime.useComponentLoader(),c=t.getProvidedControlMap(o,void 0,l,u);C(c,"Control map must exist");let f=t.dataRepeaterArray,h=f.providerId;C(h,"Variable must have providerId");let y=a.get(h);C(y,"Provider value map must exist");let P=y.get(f.id);C(Pe(P)&&P.every(Re),"Invalid array value");let I=t.getPrimaryId(),M=Se(o,t),N=!!M&&!re(M),R=(0,v.useMemo)(()=>{let O=new Map(n);return O.set(I,c),O},[c,n,I]),g=P.length,x=(0,v.useMemo)(()=>P.map((O,U)=>{let H=new Map(a),D=ie(o,c,O,U,g);return H.set(I,D),H}),[o,c,a,I,P,g]),{nonRepeatedChildCombinedControlMap:V,nonRepeatedChildCombinedValueMap:F}=Ve(n,a,I,g),S=ar({context:r,renderId:e,node:t,repeatedChild:N?M:void 0,items:P,repeatedChildCombinedValueMapPerItem:x,repeatedChildCombinedControlMap:R,nonRepeatedChildCombinedControlMap:V,nonRepeatedChildCombinedValueMap:F,placeholderVariableIds:i,activeLocale:s});return(0,p.jsx)(Ue,{node:t,nodeProps:d,children:S})}function ar({context:r,renderId:e,node:o,repeatedChild:t,items:n,repeatedChildCombinedValueMapPerItem:a,repeatedChildCombinedControlMap:i,nonRepeatedChildCombinedValueMap:s,nonRepeatedChildCombinedControlMap:d,placeholderVariableIds:l,activeLocale:u}){let c=We();return nr(o,c).map(h=>h.id===t?.id?n.map((y,P)=>{let I=y.id,M=W(I)?I:P,N=a[P],R=Ee(e,o.id,M,P);return(0,p.jsx)(Q,{context:r,parentRenderId:R,node:h,parent:o,combinedControlMap:i,combinedValueMap:N,placeholderVariableIds:l,activeLocale:u,nodePropOverrides:void 0},M)}):(0,p.jsx)(rr,{context:r,parentRenderId:e,node:h,parent:o,combinedControlMap:d,combinedValueMap:s,placeholderVariableIds:l,activeLocale:u,moveState:c},h.id))}function ce(r,e){return o=>{let t=oo(o);if(!At(t))return Bt(e,t.controlProp);let n=to(t,s=>e.cache.getVariableReferenceValue(s)),a=Ro({url:n,credentials:t.credentials}),i=r.getValue(a);if(i)return Ht(e,t,i);throw r.fetchWithCache({url:n,cacheDuration:t.cacheDuration,credentials:t.credentials})}}var me=b(A(),1);var dr=b(T(),1);function ir({tree:r,children:e}){let o=Et();(0,me.useLayoutEffect)(()=>{let n=o?"dark":"light";document.body.setAttribute("data-framer-theme",n)},[o]);let t=(0,me.useMemo)(()=>Eo(qo.getTokenNodes(r),o),[r,o]);return(0,dr.jsx)(Mo,{customProperties:t,children:e})}var ue=class{constructor(){m(this,"loaders",new Map)}preloadFonts(...e){for(let o of e){if(this.loaders.has(o))continue;let t=new ee(async()=>{await z.loadFonts([o])});t.preload(),this.loaders.set(o,t)}}usePreloadedFonts(...e){for(let o of e){let t=this.loaders.get(o);t&&t.use()}}};var fe=class{constructor(){m(this,"promises",new Set)}trackSuspense(){let e=new _;return this.promises.add(e),()=>{e.resolve(),this.promises.delete(e)}}async waitForSuspense(){this.promises.size!==0&&(await Promise.all(this.promises),await this.waitForSuspense())}};var lr=b(A(),1);var Be=class{constructor(e,o){this.modulesRuntime=e;this.identifier=o;m(this,"loaderPromise",new _);m(this,"loader",new ee(()=>this.loaderPromise))}async evaluate(e){let o=await kt(e),t=[];await wt(this.modulesRuntime.queryEngine,this.identifier,o,t,void 0,0),await this.modulesRuntime.updateComponentLoader(t),this.loaderPromise.resolve(),this.modulesRuntime.notifyReactComponents()}},he=class{constructor(e){this.sandbox=e;m(this,"componentLoaderHash",0);m(this,"reactComponentListeners",new Set);m(this,"localModules",new Map);m(this,"loadedModules",new Map);m(this,"queryEngine",new bo);m(this,"reactExternalStore",{subscribe:e=>(this.reactComponentListeners.add(e),()=>{this.reactComponentListeners.delete(e)}),getSnapshot:()=>this.componentLoaderHash})}useComponentLoader(){let e=(0,lr.useSyncExternalStore)(this.reactExternalStore.subscribe,this.reactExternalStore.getSnapshot);return[this.sandbox.componentLoader,String(e)]}async updateComponentLoader(e){this.sandbox.componentLoader.updateModuleEntities(e),await this.sandbox.remoteComponentsStore.updateComponentLoader(Wt(e),this.componentLoaderHash++)}notifyReactComponents(){for(let e of this.reactComponentListeners)e()}getLocalModuleURL(e){let o=this.localModules.get(e.localId);if(o)return o.moduleURL}getExternalModuleURL(e){return`${He().modulesCDN}/${e.moduleId}/${e.saveId}/${e.file}`}getModuleURL(e){return ze(e)?this.getExternalModuleURL(e):this.getLocalModuleURL(e)}async loadModule(e){return this.preloadModule(e),this.getPreloadedModule(e).loader.readMaybeAsync()}preloadModule(e){let o=sr(e);if(this.loadedModules.get(o.value))return;let n=new Be(this,o);this.loadedModules.set(o.value,n);let a=this.getModuleURL(o);a&&n.evaluate(a).catch(Z)}getPreloadedModule(e){let o=sr(e),t=this.loadedModules.get(o.value);return C(t,"Module not preloaded"),t}usePreloadedModules(...e){let o=[];for(let t of e){let a=this.getPreloadedModule(t).loader.preload();a&&o.push(a)}if(o.length>0)throw Promise.all(o)}updateDependenciesModule(e){let o=JSON.parse(e.importMapContent);Ae(o,"framer-user-importmap")}updateLocalModules(e){let o=new Map,t=new Set;for(let[,n]of e){C(n.kind!=="fast-refresh","Fast-refresh is not supported");let a=n.localId;o.set(a,n),this.localModules.get(a)?.moduleURL!==n.moduleURL&&t.add(a)}this.localModules=o,this.updateLocalModulesImportMap();for(let n of t){let a=Ge(n),i=this.loadedModules.get(a.value);if(i){let s=this.getLocalModuleURL(a);s&&i.evaluate(s).catch(Z)}}}updateLocalModulesImportMap(){let e={imports:{}};for(let[o,t]of this.localModules){let n=t.files.module;if(!n)continue;let a=je(o,n);e.imports[a]=t.moduleURL}Ae(e,"framer-local-modules")}insertTemporaryImportMap(e){let o=crypto.randomUUID();Ae(e,o)}};function sr(r){let e=Qe(r);return C(e,"Invalid module identifier"),qe(e)}function Ae(r,e){let o=document.createElement("script");o.type="importmap-shim",o.id=e,o.innerHTML=JSON.stringify(r);let t=document.getElementById(e);t?t.replaceWith(o):document.body.appendChild(o)}var L=b(T(),1),Ce=class{constructor(e){this.container=e;m(this,"reactRoot");m(this,"needsRender",!1);m(this,"assetMap",new Oo);m(this,"fontLoader",new ue);m(this,"componentLoader",new wo);m(this,"modulesRuntime",new he(this));m(this,"fetchClient",new Po);m(this,"loadingStateTracker",new fe);m(this,"sandboxRepeaterData",new st("sandbox"));m(this,"sandboxVisibility",new lt("sandbox"));m(this,"optimizedCanvasImageRenderer",new Ut);m(this,"partialTreeReceiver",new Ot(this.componentLoader));m(this,"controlsVisibility",new zt(this.componentLoader,this.partialTreeReceiver));m(this,"presetsListNode");m(this,"activeLocaleId");m(this,"webPageNodeId");m(this,"webPageNode");m(this,"collectionItemNodeId");m(this,"collectionItemNode");m(this,"breakpointNodeId");m(this,"breakpointNode");m(this,"nodeInTextEditorId");m(this,"nodeInTextEditorClipPath",null);m(this,"temporaryCollectionItemNodeId");m(this,"remoteComponentsStore");m(this,"remoteSandboxStore");m(this,"remoteTreeStore");m(this,"moveToolState");m(this,"layoutMeasureQueue",new Gt({shouldMeasureCallback:()=>{let e=this.measureLayout();e&&this.remoteTreeStore.onLayoutMeasure(e)},shouldMeasureCallbackDelayMs:0}));this.reactRoot=(0,pr.createRoot)(this.container);let o=new ct(k);o.setLocal(k.channels.sandbox,this),o.setLocal(k.channels.controlsVisibility,this.controlsVisibility),o.setLocal(k.channels.modulesRuntime,this.modulesRuntime),o.setLocal(k.channels.flags,this),this.remoteComponentsStore=o.getRemote(k.channels.componentsStore),this.remoteSandboxStore=o.getRemote(k.channels.sandboxStore),this.remoteTreeStore=o.getRemote(k.channels.treeStore),this.connectRpc(o).catch(Z)}get tree(){return this.partialTreeReceiver.tree}async connectRpc(e){await e.connect({target:window.parent,url:et(document.referrer).origin}),new ResizeObserver(t=>{C(t.length===1,"Invalid length");let n=t[0];C(n,"Invalid entry"),C(n.target===this.container,"Invalid target"),this.breakpointNode&&this.layoutMeasureQueue.remeasureNode(this.breakpointNode),this.remoteSandboxStore.oneway.onHeightChange(n.contentRect.height)}).observe(this.container)}measureLayout(){if(!this.webPageNode||!this.breakpointNode)return;let e=new Set;e.add(this.breakpointNode.id);let o=this.layoutMeasureQueue.process({groundNodesInViewport:e,offsetX:0,offsetY:0,scopeId:this.webPageNode.id,tree:this.tree,zoom:1});if(o.length!==0)return o}scrollTo(e){if(window.scrollTo(e),this.breakpointNode){for(let o of ke(this.breakpointNode))this.layoutMeasureQueue.remeasureNode(o);this.layoutMeasureQueue.remeasureNode(this.breakpointNode)}}update(e){let o=e.partialTreeUpdate;o&&(this.partialTreeReceiver.update(o),this.preloadTree());let t=e.webPageNodeId;t&&(this.webPageNodeId=t);let n=e.collectionItemNodeId;n&&(this.collectionItemNodeId=n);let a=e.breakpointNodeId;a&&(this.breakpointNodeId=a);let i=e.stylePresetBreakpointClassNames;W(i)&&(this.container.className=i);let s=e.dependenciesModule;s&&this.modulesRuntime.updateDependenciesModule(s);let d=e.localModules;d&&this.modulesRuntime.updateLocalModules(d);let l=e.assets;l&&(this.assetMap.set(l),z.importCustomFonts(this.assetMap.items(),ye.isOn("customFontGrouping"))),this.nodeInTextEditorId!==e.nodeInTextEditorId&&!w(e.nodeInTextEditorId)&&(this.nodeInTextEditorId=e.nodeInTextEditorId,this.needsRender=!0),!w(e.nodeInTextEditorClipPath)&&this.nodeInTextEditorClipPath!==e.nodeInTextEditorClipPath&&(this.nodeInTextEditorClipPath=e.nodeInTextEditorClipPath,this.needsRender=!0),this.temporaryCollectionItemNodeId!==e.temporaryCollectionItemNodeId&&!w(e.temporaryCollectionItemNodeId)&&(this.temporaryCollectionItemNodeId=e.temporaryCollectionItemNodeId,this.needsRender=!0),w(e.moveToolState)||(this.moveToolState=e.moveToolState,this.needsRender=!0),w(e.activeLocaleId)||(this.activeLocaleId=e.activeLocaleId,this.needsRender=!0),this.updateWebPageNode(),this.updateCollectionItemNode(),this.updateBreakpointNode(),this.updatePresetsListNode(),this.render()}preloadWebPage(){if(this.webPageNode){for(let e of this.webPageNode.walk())if(Y(e)&&this.modulesRuntime.preloadModule(e.codeComponentIdentifier),K(e)&&e.layoutTemplateIdentifier&&this.modulesRuntime.preloadModule(e.layoutTemplateIdentifier),X(e)&&this.modulesRuntime.preloadModule(e.dataIdentifier),Dt(e)){let o=e.getFontsForLoading();this.fontLoader.preloadFonts(...o)}}}preloadTree(){let e=Ho(this.tree)?.loaded;if(e)for(let t of e.children){let n=$(this.tree,t.instanceIdentifier);for(let a of n)this.modulesRuntime.preloadModule(a)}let o=Fe.get(this.tree);if(o){for(let t of o.children)if(jo(t)){let n=t.getFontsForCodeGeneration();this.fontLoader.preloadFonts(...n)}}}updateWebPageNode(){let e=this.tree.getNodeWithTrait(this.webPageNodeId,K)?.loaded;this.webPageNode!==e&&(this.needsRender=!0,this.webPageNode=e,this.preloadWebPage())}updateCollectionItemNode(){let e=this.tree.getNodeWithTrait(this.collectionItemNodeId,po)??void 0;this.collectionItemNode!==e&&(this.needsRender=!0,this.collectionItemNode=e)}updateBreakpointNode(){let e=this.tree.get(this.breakpointNodeId)??void 0;this.breakpointNode!==e&&(this.needsRender=!0,this.breakpointNode=e)}updatePresetsListNode(){let e=Fe.get(this.tree)??void 0;this.presetsListNode!==e&&(this.needsRender=!0,this.presetsListNode=e)}async onRendered(e){await this.loadingStateTracker.waitForSuspense(),this.breakpointNode&&e&&this.remoteSandboxStore.onInitialLoadComplete(e),this.remoteTreeStore.onSandboxRendered({layoutMeasurements:this.measureLayout(),repeaterUpdates:this.sandboxRepeaterData.export(),visibilityUpdates:this.sandboxVisibility.export()})}render(){this.needsRender&&((0,E.startTransition)(()=>{this.reactRoot.render((0,L.jsx)(E.StrictMode,{children:(0,L.jsxs)(wr,{webPageNodeId:this.webPageNodeId,onRendered:this.onRendered.bind(this),children:[(0,L.jsx)(ir,{tree:this.tree,children:(0,L.jsx)(go,{children:(0,L.jsx)(Xe,{isStatic:!0,children:(0,L.jsx)(kr,{tree:this.tree,activeLocaleId:this.activeLocaleId,children:(0,L.jsx)(yo,{client:this.fetchClient,children:(0,L.jsx)(Je,{parentSize:1,children:(0,L.jsx)(qt,{nodeInTextEditorId:this.nodeInTextEditorId,clipPath:this.nodeInTextEditorClipPath,children:(0,L.jsx)(_t,{update:this.moveToolState,children:(0,L.jsx)(er,{context:this,webPageNode:this.webPageNode,collectionItemNode:this.collectionItemNode,breakpointNode:this.breakpointNode,temporaryCollectionItemNodeId:this.temporaryCollectionItemNodeId})})})})})})})})}),(0,L.jsx)(ht,{componentLoader:this.componentLoader,presetsListNode:this.presetsListNode})]})}))}),this.needsRender=!1)}updateExperiments(e){ye.update(e)}updateProjectFeatures(e){Jo.update(e)}updateEmployeesOnlySettings(e){at.update(e)}};function wr({children:r,webPageNodeId:e,onRendered:o}){return(0,E.useEffect)(()=>{o(e)}),(0,L.jsx)(L.Fragment,{children:r})}function kr({tree:r,activeLocaleId:e,children:o}){let t=Wo(r,"excludeDrafts"),n=Uo(r,e,"excludeDrafts"),a=(0,E.useMemo)(()=>({activeLocale:n,locales:t,setLocale:it}),[n,t]),i=r.root.adaptLayoutToTextDirection,s=a.activeLocale?.textDirection??"ltr",d=i?s:"ltr";return(0,E.useLayoutEffect)(()=>{i?document.documentElement.setAttribute("dir",s):document.documentElement.removeAttribute("dir")},[i,s]),(0,L.jsx)(oe.Provider,{value:a,children:(0,L.jsx)(vo.Provider,{value:d,children:o})})}Object.assign(window,{Framer:Vo});Ke({name:"canvas",security:{}});var cr=document.querySelector("main");C(cr,"Container element not found");var ve=new Ce(cr),Wr=pt(ve.assetMap);z.importFramerFonts(ko);eo({isOnPageCanvas:!0,assetResolver:Wr,queueMeasureRequest(...r){ve.layoutMeasureQueue.add(...r)},enableFontStore:!0,fetchGoogleFontsList:ft,fetchFontshareFontsList:ut,fetchBuiltInFontsList:mt,imagePlaceholderSvg:'<svg width="64" height="64" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h64v64H0V0Z" fill="#222" fill-opacity=".8"/><path d="M64 12.4 12.4 64H11l53-53v1.4ZM64 33.7 33.7 64h-1.4L64 32.3v1.4ZM64 55l-9 9h-1.4L64 53.6v1.5ZM12.4 0 0 12.4V11L11 0h1.4ZM33.7 0 0 33.7v-1.4L32.3 0h1.4ZM55 0 0 55v-1.4L53.6 0h1.5Z" fill="#888" fill-opacity=".2"/></svg>',useImageSource(r){if(!r.src)return"";let e=Do(r.src);return e?ge(e.identifier):ge(r.src)},canRenderOptimizedCanvasImage:ve.optimizedCanvasImageRenderer.canRenderCanvasImage,renderOptimizedCanvasImage:ve.optimizedCanvasImageRenderer.renderCanvasImage});
//# sourceMappingURL=canvas-sandbox-on-page.PH7SLG3E.mjs.map
